Return-Path: <linux-kernel-owner@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 7436F13073C
	for <lists+linux-kernel@lfdr.de>; Sun,  5 Jan 2020 11:47:08 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1726863AbgAEKrB (ORCPT <rfc822;lists+linux-kernel@lfdr.de>);
        Sun, 5 Jan 2020 05:47:01 -0500
Received: from mailgw01.mediatek.com ([210.61.82.183]:45267 "EHLO
        mailgw01.mediatek.com" rhost-flags-OK-FAIL-OK-FAIL) by vger.kernel.org
        with ESMTP id S1726702AbgAEKrA (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Sun, 5 Jan 2020 05:47:00 -0500
X-UUID: 6eaec5b78ff743c7a5739bf46bdbf14d-20200105
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; d=mediatek.com; s=dk;
        h=Content-Transfer-Encoding:Content-Type:MIME-Version:References:In-Reply-To:Message-ID:Date:Subject:CC:To:From; bh=i7uLllswA+30E+RlRxklVQ9qjW8u1U7i80NDkyo2BmA=;
        b=TApoU0iCwDPxxO2bBTwOI46pa/3ERznmGwWAXFONM8AR1U4R3mFh0OX4JHiWguVH8LfO1NA1sF3Bi9HFVa6n9ANHVJcZiKewPhVQv1B8KrjMvh+zBwXsAnf4mL7OwHfQBHS+MVNnByPV6wSfQfKvMmBOt1uta7Fgterx2AF31tk=;
X-UUID: 6eaec5b78ff743c7a5739bf46bdbf14d-20200105
Received: from mtkexhb01.mediatek.inc [(172.21.101.102)] by mailgw01.mediatek.com
        (envelope-from <chao.hao@mediatek.com>)
        (Cellopoint E-mail Firewall v4.1.10 Build 0809 with TLS)
        with ESMTP id 508016898; Sun, 05 Jan 2020 18:46:55 +0800
Received: from MTKCAS06.mediatek.inc (172.21.101.30) by
 mtkmbs07n2.mediatek.inc (172.21.101.141) with Microsoft SMTP Server (TLS) id
 15.0.1395.4; Sun, 5 Jan 2020 18:46:28 +0800
Received: from localhost.localdomain (10.15.20.246) by MTKCAS06.mediatek.inc
 (172.21.101.73) with Microsoft SMTP Server id 15.0.1395.4 via Frontend
 Transport; Sun, 5 Jan 2020 18:45:20 +0800
From:   Chao Hao <chao.hao@mediatek.com>
To:     Joerg Roedel <joro@8bytes.org>, Rob Herring <robh+dt@kernel.org>,
        Matthias Brugger <matthias.bgg@gmail.com>
CC:     <iommu@lists.linux-foundation.org>, <devicetree@vger.kernel.org>,
        <linux-kernel@vger.kernel.org>,
        <linux-arm-kernel@lists.infradead.org>,
        <linux-mediatek@lists.infradead.org>, <wsd_upstream@mediatek.com>,
        Chao Hao <chao.hao@mediatek.com>,
        Jun Yan <jun.yan@mediatek.com>,
        Cui Zhang <zhang.cui@mediatek.com>,
        Yong Wu <yong.wu@mediatek.com>,
        Anan Sun <anan.sun@mediatek.com>
Subject: [PATCH v2 08/19] iommu/mediatek: Add mt6779 basic support
Date:   Sun, 5 Jan 2020 18:45:12 +0800
Message-ID: <20200105104523.31006-9-chao.hao@mediatek.com>
X-Mailer: git-send-email 2.18.0
In-Reply-To: <20200105104523.31006-1-chao.hao@mediatek.com>
References: <20200105104523.31006-1-chao.hao@mediatek.com>
MIME-Version: 1.0
Content-Type: text/plain
X-MTK:  N
Content-Transfer-Encoding: base64
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

MS4gQWRkIG10Njc3OV9kYXRhIGRlZmluZSB0byBzdXBwb3J0IG10Njc3OSBJT01NVSBIVyBpbml0
Lg0KMi4gRm9yIG10Njc3OSwgdGhlcmUgYXJlIHR3byBJT01NVXMsIG9uZSBpcyBNTV9JT01NVSwg
dGhlDQpvdGhlciBpcyBWUFVfSU9NTVUuIE1NX0lPTU1VIGlzIGNvbm5lY3RlZCBzbWlfbGFyYiB0
byBzdXBwb3J0DQptdWx0aW1lZGlhIGVuZ2luZSB0byBhY2Nlc3MgRFJBTSwgYW5kIFZQVV9JT01N
VSBpcyBjb25uZWN0ZWQgdG8NCkFQVV9idXMgdG8gc3VwcG9ydCBWUFUsTURMQSxFRE1BIHRvIGFj
Y2VzcyBEUkFNLiBNTV9JT01NVSBhbmQNClZQVV9JT01NVSB1c2UgdGhlIHNhbWUgcGFnZSB0YWJs
ZSB0byBzaW1wbGlmeSBkZXNpZ24gYnkNCiJtdGtfaW9tbXVfZ2V0X200dV9kYXRhIi4NCjMuIEZv
ciBzbWlfbGFyYjYsIGl0IGRvZXNuJ3QgdXNlIE1NX0lPTU1VLCBzbyB3ZSBjYW4gZGlzdGluZ3Vp
c2gNClZQVV9JT01NVSBieSBpdCB3aGVuIGV4Y3V0ZXMgaW9tbXVfcHJvYmUuDQo0LiBGb3IgbXQ2
Nzc5IEFQVV9JT01NVSBmYXVsdCBpZCBpcyBpcnJlZ3VsYXIsIHNvIGl0IHdhcyB0cmVhdGVkIHNw
ZWNpYWxseS4NCg0KU2lnbmVkLW9mZi1ieTogQ2hhbyBIYW8gPGNoYW8uaGFvQG1lZGlhdGVrLmNv
bT4NCi0tLQ0KIGRyaXZlcnMvaW9tbXUvbXRrX2lvbW11LmMgfCA0NiArKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrLS0tLS0NCiBkcml2ZXJzL2lvbW11L210a19pb21tdS5oIHwgIDIg
KysNCiAyIGZpbGVzIGNoYW5nZWQsIDQyIGluc2VydGlvbnMoKyksIDYgZGVsZXRpb25zKC0pDQoN
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2lvbW11L210a19pb21tdS5jIGIvZHJpdmVycy9pb21tdS9t
dGtfaW9tbXUuYw0KaW5kZXggYWQ1NjkwMzUwZDZhLi43ODI5ZDFmZDA4ZGQgMTAwNjQ0DQotLS0g
YS9kcml2ZXJzL2lvbW11L210a19pb21tdS5jDQorKysgYi9kcml2ZXJzL2lvbW11L210a19pb21t
dS5jDQpAQCAtNDMsNyArNDMsMTAgQEANCiAjZGVmaW5lIEZfSU5WTERfRU4xCQkJCUJJVCgxKQ0K
IA0KICNkZWZpbmUgUkVHX01NVV9NSVNDX0NUUkwJCQkweDA0OA0KKyNkZWZpbmUgUkVHX01NVV9T
VEFOREFSRF9BWElfTU9ERV9NVDY3NzkJKEJJVCgzKSB8IEJJVCgxOSkpDQorDQogI2RlZmluZSBS
RUdfTU1VX0RDTV9ESVMJCQkJMHgwNTANCisNCiAjZGVmaW5lIFJFR19NTVVfV1JfTEVOCQkJCTB4
MDU0DQogI2RlZmluZSBGX01NVV9XUl9USFJPVF9ESVMJCQkoQklUKDUpIHwgIEJJVCgyMSkpDQog
DQpAQCAtOTUsOCArOTgsMTAgQEANCiAjZGVmaW5lIEZfTU1VX0lOVF9JRF9TVUJfQ09NTV9JRChh
KQkJKCgoYSkgPj4gNykgJiAweDMpDQogI2RlZmluZSBGX01NVV9JTlRfSURfTEFSQl9JRChhKQkJ
CSgoKGEpID4+IDcpICYgMHg3KQ0KICNkZWZpbmUgRl9NTVVfSU5UX0lEX1BPUlRfSUQoYSkJCQko
KChhKSA+PiAyKSAmIDB4MWYpDQorI2RlZmluZSBGX01NVV9JTlRfSURfQ09NTV9BUFVfSUQoYSkJ
CSgoYSkgJiAweDMpDQorI2RlZmluZSBGX01NVV9JTlRfSURfU1VCX0FQVV9JRChhKQkJKCgoYSkg
Pj4gMikgJiAweDMpDQogDQotI2RlZmluZSBNVEtfUFJPVEVDVF9QQV9BTElHTgkJCTEyOA0KKyNk
ZWZpbmUgTVRLX1BST1RFQ1RfUEFfQUxJR04JCQkyNTYNCiANCiAvKg0KICAqIEdldCB0aGUgbG9j
YWwgYXJiaXRlciBJRCBhbmQgdGhlIHBvcnRpZCB3aXRoaW4gdGhlIGxhcmIgYXJiaXRlcg0KQEAg
LTI0OSw4ICsyNTQsMTUgQEAgc3RhdGljIGlycXJldHVybl90IG10a19pb21tdV9pc3IoaW50IGly
cSwgdm9pZCAqZGV2X2lkKQ0KIAl3cml0ZSA9IGZhdWx0X2lvdmEgJiBGX01NVV9GQVVMVF9WQV9X
UklURV9CSVQ7DQogCWZhdWx0X3BvcnQgPSBGX01NVV9JTlRfSURfUE9SVF9JRChyZWd2YWwpOw0K
IAlpZiAoZGF0YS0+cGxhdF9kYXRhLT5oYXNfc3ViX2NvbW1bZGF0YS0+bTR1X2lkXSkgew0KLQkJ
ZmF1bHRfbGFyYiA9IEZfTU1VX0lOVF9JRF9DT01NX0lEKHJlZ3ZhbCk7DQotCQlzdWJfY29tbSA9
IEZfTU1VX0lOVF9JRF9TVUJfQ09NTV9JRChyZWd2YWwpOw0KKwkJLyogbTR1MSBpcyBWUFUgaW4g
bXQ2Nzc5LiovDQorCQlpZiAoZGF0YS0+bTR1X2lkICYmIGRhdGEtPnBsYXRfZGF0YS0+bTR1X3Bs
YXQgPT0gTTRVX01UNjc3OSkgew0KKwkJCWZhdWx0X2xhcmIgPSBGX01NVV9JTlRfSURfQ09NTV9B
UFVfSUQocmVndmFsKTsNCisJCQlzdWJfY29tbSA9IEZfTU1VX0lOVF9JRF9TVUJfQVBVX0lEKHJl
Z3ZhbCk7DQorCQkJZmF1bHRfcG9ydCA9IDA7IC8qIGZvciBtdDY3NzkgQVBVIElEIGlzIGlycmVn
dWxhciAqLw0KKwkJfSBlbHNlIHsNCisJCQlmYXVsdF9sYXJiID0gRl9NTVVfSU5UX0lEX0NPTU1f
SUQocmVndmFsKTsNCisJCQlzdWJfY29tbSA9IEZfTU1VX0lOVF9JRF9TVUJfQ09NTV9JRChyZWd2
YWwpOw0KKwkJfQ0KIAl9IGVsc2Ugew0KIAkJZmF1bHRfbGFyYiA9IEZfTU1VX0lOVF9JRF9MQVJC
X0lEKHJlZ3ZhbCk7DQogCX0NCkBAIC01NTYsMTEgKzU2OCwxMiBAQCBzdGF0aWMgaW50IG10a19p
b21tdV9od19pbml0KGNvbnN0IHN0cnVjdCBtdGtfaW9tbXVfZGF0YSAqZGF0YSkNCiAJCXJldHVy
biByZXQ7DQogCX0NCiANCisJcmVndmFsID0gcmVhZGxfcmVsYXhlZChkYXRhLT5iYXNlICsgUkVH
X01NVV9DVFJMX1JFRyk7DQogCWlmIChkYXRhLT5wbGF0X2RhdGEtPm00dV9wbGF0ID09IE00VV9N
VDgxNzMpDQotCQlyZWd2YWwgPSBGX01NVV9QUkVGRVRDSF9SVF9SRVBMQUNFX01PRCB8DQorCQly
ZWd2YWwgfD0gRl9NTVVfUFJFRkVUQ0hfUlRfUkVQTEFDRV9NT0QgfA0KIAkJCSBGX01NVV9URl9Q
Uk9UX1RPX1BST0dSQU1fQUREUl9NVDgxNzM7DQogCWVsc2UNCi0JCXJlZ3ZhbCA9IEZfTU1VX1RG
X1BST1RfVE9fUFJPR1JBTV9BRERSOw0KKwkJcmVndmFsIHw9IEZfTU1VX1RGX1BST1RfVE9fUFJP
R1JBTV9BRERSOw0KIAl3cml0ZWxfcmVsYXhlZChyZWd2YWwsIGRhdGEtPmJhc2UgKyBSRUdfTU1V
X0NUUkxfUkVHKTsNCiANCiAJcmVndmFsID0gRl9MMl9NVUxJVF9ISVRfRU4gfA0KQEAgLTYwNCw4
ICs2MTcsMTYgQEAgc3RhdGljIGludCBtdGtfaW9tbXVfaHdfaW5pdChjb25zdCBzdHJ1Y3QgbXRr
X2lvbW11X2RhdGEgKmRhdGEpDQogCQl3cml0ZWxfcmVsYXhlZChyZWd2YWwsIGRhdGEtPmJhc2Ug
KyBSRUdfTU1VX1dSX0xFTik7DQogCX0NCiANCi0JaWYgKGRhdGEtPnBsYXRfZGF0YS0+cmVzZXRf
YXhpKQ0KKwlpZiAoZGF0YS0+cGxhdF9kYXRhLT5oYXNfbWlzY19jdHJsW2RhdGEtPm00dV9pZF0p
IHsNCisJCS8qIHNwZWNpYWwgc2V0dGluZ3MgZm9yIG1tdTAgKG11bHRpbWVkaWEgaW9tbXUpICov
DQorCQlyZWd2YWwgPSByZWFkbF9yZWxheGVkKGRhdGEtPmJhc2UgKyBSRUdfTU1VX01JU0NfQ1RS
TCk7DQorCQkvKiBub24tc3RhbmRhcmQgQVhJIG1vZGUgKi8NCisJCXJlZ3ZhbCAmPSB+UkVHX01N
VV9TVEFOREFSRF9BWElfTU9ERV9NVDY3Nzk7DQorCQl3cml0ZWxfcmVsYXhlZChyZWd2YWwsIGRh
dGEtPmJhc2UgKyBSRUdfTU1VX01JU0NfQ1RSTCk7DQorCX0gZWxzZSBpZiAoZGF0YS0+cGxhdF9k
YXRhLT5yZXNldF9heGkpIHsNCisJCS8qZGlzYWJsZSBzdGFuZGFyZCBheGkgd2hlbiBpdCBpcyBS
RUdfTU1VX1NUQU5EQVJEX0FYSV9NT0RFICovDQogCQl3cml0ZWxfcmVsYXhlZCgwLCBkYXRhLT5i
YXNlICsgUkVHX01NVV9NSVNDX0NUUkwpOw0KKwl9DQogDQogCWlmIChkZXZtX3JlcXVlc3RfaXJx
KGRhdGEtPmRldiwgZGF0YS0+aXJxLCBtdGtfaW9tbXVfaXNyLCAwLA0KIAkJCSAgICAgZGV2X25h
bWUoZGF0YS0+ZGV2KSwgKHZvaWQgKilkYXRhKSkgew0KQEAgLTgwNiw2ICs4MjcsMTggQEAgc3Rh
dGljIGNvbnN0IHN0cnVjdCBtdGtfaW9tbXVfcGxhdF9kYXRhIG10MjcxMl9kYXRhID0gew0KIAku
aW52X3NlbF9yZWcgPSBSRUdfTU1VX0lOVl9TRUwsDQogfTsNCiANCitzdGF0aWMgY29uc3Qgc3Ry
dWN0IG10a19pb21tdV9wbGF0X2RhdGEgbXQ2Nzc5X2RhdGEgPSB7DQorCS5tNHVfcGxhdCA9IE00
VV9NVDY3NzksDQorCS5sYXJiaWRfcmVtYXBbMF0gPSB7MCwgMSwgMiwgMywgNSwgNywgMTAsIDl9
LA0KKwkvKiB2cDZhLCB2cDZiLCBtZGxhL2NvcmUyLCBtZGxhL2VkbWMqLw0KKwkubGFyYmlkX3Jl
bWFwWzFdID0gezIsIDAsIDMsIDF9LA0KKwkuaGFzX3N1Yl9jb21tID0ge3RydWUsIHRydWV9LA0K
KwkuaGFzX3dyX2xlbiA9IHRydWUsDQorCS5oYXNfbWlzY19jdHJsID0ge3RydWUsIGZhbHNlfSwN
CisJLmludl9zZWxfcmVnID0gUkVHX01NVV9JTlZfU0VMX01UNjc3OSwNCisJLm00dTFfbWFzayA9
ICBCSVQoNiksDQorfTsNCisNCiBzdGF0aWMgY29uc3Qgc3RydWN0IG10a19pb21tdV9wbGF0X2Rh
dGEgbXQ4MTczX2RhdGEgPSB7DQogCS5tNHVfcGxhdCAgICAgPSBNNFVfTVQ4MTczLA0KIAkuaGFz
XzRnYl9tb2RlID0gdHJ1ZSwNCkBAIC04MjQsNiArODU3LDcgQEAgc3RhdGljIGNvbnN0IHN0cnVj
dCBtdGtfaW9tbXVfcGxhdF9kYXRhIG10ODE4M19kYXRhID0gew0KIA0KIHN0YXRpYyBjb25zdCBz
dHJ1Y3Qgb2ZfZGV2aWNlX2lkIG10a19pb21tdV9vZl9pZHNbXSA9IHsNCiAJeyAuY29tcGF0aWJs
ZSA9ICJtZWRpYXRlayxtdDI3MTItbTR1IiwgLmRhdGEgPSAmbXQyNzEyX2RhdGF9LA0KKwl7IC5j
b21wYXRpYmxlID0gIm1lZGlhdGVrLG10Njc3OS1tNHUiLCAuZGF0YSA9ICZtdDY3NzlfZGF0YX0s
DQogCXsgLmNvbXBhdGlibGUgPSAibWVkaWF0ZWssbXQ4MTczLW00dSIsIC5kYXRhID0gJm10ODE3
M19kYXRhfSwNCiAJeyAuY29tcGF0aWJsZSA9ICJtZWRpYXRlayxtdDgxODMtbTR1IiwgLmRhdGEg
PSAmbXQ4MTgzX2RhdGF9LA0KIAl7fQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvaW9tbXUvbXRrX2lv
bW11LmggYi9kcml2ZXJzL2lvbW11L210a19pb21tdS5oDQppbmRleCAwNjIzZjE5OWU5NmYuLjJi
MjA3ZGNhZGQwNiAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvaW9tbXUvbXRrX2lvbW11LmgNCisrKyBi
L2RyaXZlcnMvaW9tbXUvbXRrX2lvbW11LmgNCkBAIC0zMSw2ICszMSw3IEBAIHN0cnVjdCBtdGtf
aW9tbXVfc3VzcGVuZF9yZWcgew0KIGVudW0gbXRrX2lvbW11X3BsYXQgew0KIAlNNFVfTVQyNzAx
LA0KIAlNNFVfTVQyNzEyLA0KKwlNNFVfTVQ2Nzc5LA0KIAlNNFVfTVQ4MTczLA0KIAlNNFVfTVQ4
MTgzLA0KIH07DQpAQCAtNDUsNiArNDYsNyBAQCBzdHJ1Y3QgbXRrX2lvbW11X3BsYXRfZGF0YSB7
DQogCWJvb2wgICAgICAgICAgICAgICAgaGFzX3ZsZF9wYV9ybmc7DQogCWJvb2wgICAgICAgICAg
ICAgICAgcmVzZXRfYXhpOw0KIAlib29sICAgICAgICAgICAgICAgIGhhc193cl9sZW47DQorCWJv
b2wgICAgICAgICAgICAgICAgaGFzX21pc2NfY3RybFsyXTsNCiAJdTMyICAgICAgICAgICAgICAg
ICBtNHUxX21hc2s7DQogCXUzMiAgICAgICAgICAgICAgICAgaW52X3NlbF9yZWc7DQogCXVuc2ln
bmVkIGNoYXIgICAgICAgbGFyYmlkX3JlbWFwWzJdW01US19MQVJCX05SX01BWF07DQotLSANCjIu
MTguMA0K

