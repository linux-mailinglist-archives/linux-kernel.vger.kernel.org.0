Return-Path: <linux-kernel-owner@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id E8186ADE62
	for <lists+linux-kernel@lfdr.de>; Mon,  9 Sep 2019 20:09:28 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1730660AbfIISJR (ORCPT <rfc822;lists+linux-kernel@lfdr.de>);
        Mon, 9 Sep 2019 14:09:17 -0400
Received: from mail-eopbgr760040.outbound.protection.outlook.com ([40.107.76.40]:28296
        "EHLO NAM02-CY1-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S1730127AbfIISJQ (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
        Mon, 9 Sep 2019 14:09:16 -0400
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=c0hdddb2UoIRWwsWGRCcm5uHvKrAL229ntC7wmkxyHkR7bdWrGEFVpF9TYSBQh/D0NRmfrNCSy33DqkItItTCVX1L2ITc0zdyzg05uc9q0hA7knQLiPw4a1HzEospF2oa8BGyyXlxhG2KyQyaWyPmD3xCo8FdKdFy8a0TTb1FrfYPwykZBwfBnusSXFBsTh063b1sFUqc/MTHKLhQMEYJZx3ggyLkSeCTNtgkDK5wIdeB0BWR7X3NOgj+OMKOV7rmyXBMIMTVWP3WieTM3IeTlfGLfFwFQ3MkZQEb8NZgbB9/df8bc9TWIfVhTGRWcFQVUxw+9PIbOuK635hyNXLaQ==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=JvGbutgOsrGGmsjnJkd6pBiBi8qcUO5GWD7dutd3hLM=;
 b=mtjVgN81xdiof3tFO/C2/972QX+6zlwVkJmpNPhdUN/i5lJPV49rn1wfjb8VevVAov+7HmrV8TPTLn0b77LAehcqo35dt9OKNbeTQ/wQv8lc3I6c/0M3Hk3Wt9KF1M3D9jIXRy94lh06IEZJnssxiuwbEEvywa5rxNgjc++Gv0hksGPz32QUnQAtIQHzUDffJK5EYv4row4D2WlJZr+bpAhCZvv0NYt3EWuWWQ+X+VPnHsBJkYGykJmG3lPtsRQSxG+ATFHIDOr56VS7pMPXjjrvEBl7fIBx5oRXAPiIBYnZzevJjG9Tcv2RzJGeOsHbkwpgKznuk2BZRz3ijGpuPA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=netapp.com; dmarc=pass action=none header.from=netapp.com;
 dkim=pass header.d=netapp.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=netapp.onmicrosoft.com; s=selector2-netapp-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=JvGbutgOsrGGmsjnJkd6pBiBi8qcUO5GWD7dutd3hLM=;
 b=WiOzmt+Hm2Fp+Phlz9ljZWaziPpzAlRWFWsFCrw7JB6Jk16Oj4Ds5WBGUaYTTUuq6yX7bd4hr58lqnTd6U975oMrWYSeNb0ZweT/ApOeUdbbISjhvH1WpuDBFPzIDnBYF+jaMEFZK7DrVuBzC/oss4yrE5reF+nmL8KM/LaoAj0=
Received: from CY4PR06MB3479.namprd06.prod.outlook.com (10.175.117.23) by
 CY4PR06MB3077.namprd06.prod.outlook.com (10.171.248.31) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2199.21; Mon, 9 Sep 2019 18:08:40 +0000
Received: from CY4PR06MB3479.namprd06.prod.outlook.com
 ([fe80::dc3a:8fd7:ce1e:e18]) by CY4PR06MB3479.namprd06.prod.outlook.com
 ([fe80::dc3a:8fd7:ce1e:e18%11]) with mapi id 15.20.2241.018; Mon, 9 Sep 2019
 18:08:40 +0000
From:   "Schumaker, Anna" <Anna.Schumaker@netapp.com>
To:     "smayhew@redhat.com" <smayhew@redhat.com>,
        "trond.myklebust@hammerspace.com" <trond.myklebust@hammerspace.com>
CC:     "linux-nfs@vger.kernel.org" <linux-nfs@vger.kernel.org>,
        "linux-fsdevel@vger.kernel.org" <linux-fsdevel@vger.kernel.org>,
        "viro@zeniv.linux.org.uk" <viro@zeniv.linux.org.uk>,
        "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>,
        "dhowells@redhat.com" <dhowells@redhat.com>
Subject: Re: [PATCH v2 18/26] NFS: Rename struct nfs_parsed_mount_data to
 struct nfs_fs_context
Thread-Topic: [PATCH v2 18/26] NFS: Rename struct nfs_parsed_mount_data to
 struct nfs_fs_context
Thread-Index: AQHVYpaxoEmPel2eX0yx9PAAj4u0B6cjrgiA
Date:   Mon, 9 Sep 2019 18:08:39 +0000
Message-ID: <2dc9c647e07011b8d1b20a94e61f4f92a2b850dc.camel@netapp.com>
References: <20190903203215.9157-1-smayhew@redhat.com>
         <20190903203215.9157-19-smayhew@redhat.com>
In-Reply-To: <20190903203215.9157-19-smayhew@redhat.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
user-agent: Evolution 3.32.4 
authentication-results: spf=none (sender IP is )
 smtp.mailfrom=Anna.Schumaker@netapp.com; 
x-originating-ip: [23.28.75.121]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 8f1258d7-edfe-4ddc-ef14-08d73550be3e
x-microsoft-antispam: BCL:0;PCL:0;RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600166)(711020)(4605104)(1401327)(2017052603328)(7193020);SRVR:CY4PR06MB3077;
x-ms-traffictypediagnostic: CY4PR06MB3077:
x-microsoft-antispam-prvs: <CY4PR06MB3077E808418A215BF3CA6D33F8B70@CY4PR06MB3077.namprd06.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:6790;
x-forefront-prvs: 01559F388D
x-forefront-antispam-report: SFV:NSPM;SFS:(10009020)(4636009)(366004)(346002)(39860400002)(376002)(396003)(136003)(189003)(199004)(11346002)(446003)(6506007)(186003)(6486002)(36756003)(6436002)(478600001)(2906002)(26005)(30864003)(476003)(2616005)(102836004)(486006)(2501003)(25786009)(14444005)(256004)(6246003)(4326008)(229853002)(6512007)(76176011)(71190400001)(53936002)(99286004)(53946003)(71200400001)(7736002)(8936002)(316002)(5660300002)(66946007)(66556008)(64756008)(66446008)(76116006)(91956017)(8676002)(66476007)(54906003)(14454004)(81156014)(58126008)(81166006)(110136005)(305945005)(66066001)(6116002)(118296001)(3846002)(86362001)(579004)(569006);DIR:OUT;SFP:1101;SCL:1;SRVR:CY4PR06MB3077;H:CY4PR06MB3479.namprd06.prod.outlook.com;FPR:;SPF:None;LANG:en;PTR:InfoNoRecords;MX:1;A:1;
received-spf: None (protection.outlook.com: netapp.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: Gq0ubacABKVL9s8DmTO9WWSUwz+QSqqG3gMelbM1lXQdZpbbjNy1cEZ1tjMbcnk3rjT4mYZcs4okHBhaahEFlzSBc01yK7XRsFXIbvwLo4gZahu5Zj7xwLwElrloX471SQWh0FELqQ6/WGkyst5Rx/WIzJtio+cb9yeYAsGWy+l3UCG5Y2bS3FmIayX+h9NJdKFtLIJxlo8zGtqxiTAk3d5YhXA8WLNbfSiXLoxAOIyEuEddeMfKYegiyETGIAB4srzABRC8Itk23jS6oobIIlaH4x/JzZ4uPoLdib7Rp/dGkjPVGhi4h0UQieiIzQGoBRhgK/t/4wpJopNtzpOgCm494T0BeXwYnDcU91dZ/blFdhtyx98BNWuFwZoQh4uuezdawpfPDMuLcPGIs5LHO2/O7XDXRJ1c1SAy9erinpw=
x-ms-exchange-transport-forked: True
Content-Type: text/plain; charset="utf-8"
Content-ID: <1114F05504DAC54C886089A59F658347@namprd06.prod.outlook.com>
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: netapp.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 8f1258d7-edfe-4ddc-ef14-08d73550be3e
X-MS-Exchange-CrossTenant-originalarrivaltime: 09 Sep 2019 18:08:40.0276
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 4b0911a0-929b-4715-944b-c03745165b3a
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: 4NCyjgXv3L1kDO7fEWxBgjmXoDNkcPJgwLNg4RB6veprSDMuw2WPhcznVackhpt9BGg8ElPW4gdZ2QTciADv3A==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: CY4PR06MB3077
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

SGkgU2NvdHQsDQoNClRoYW5rcyBmb3IgdGFraW5nIHRoZXNlIHBhdGNoZXMgdXAhDQoNCk9uIFR1
ZSwgMjAxOS0wOS0wMyBhdCAxNjozMiAtMDQwMCwgU2NvdHQgTWF5aGV3IHdyb3RlOg0KPiBGcm9t
OiBEYXZpZCBIb3dlbGxzIDxkaG93ZWxsc0ByZWRoYXQuY29tPg0KPiANCj4gUmVuYW1lIHN0cnVj
dCBuZnNfcGFyc2VkX21vdW50X2RhdGEgdG8gc3RydWN0IG5mc19mc19jb250ZXh0IGFuZA0KPiBy
ZW5hbWUNCj4gcG9pbnRlcnMgdG8gaXQgdG8gImN0eCIuICBBdCBzb21lIHBvaW50IHRoaXMgd2ls
bCBiZSBwb2ludGVkIHRvIGJ5IGFuDQo+IGZzX2NvbnRleHQgc3RydWN0J3MgZnNfcHJpdmF0ZSBw
b2ludGVyLg0KPiANCj4gU2lnbmVkLW9mZi1ieTogRGF2aWQgSG93ZWxscyA8ZGhvd2VsbHNAcmVk
aGF0LmNvbT4NCj4gU2lnbmVkLW9mZi1ieTogQWwgVmlybyA8dmlyb0B6ZW5pdi5saW51eC5vcmcu
dWs+DQo+IC0tLQ0KPiAgZnMvbmZzL2NsaWVudC5jICAgICB8ICA2NiArKystLS0tDQo+ICBmcy9u
ZnMvZnNfY29udGV4dC5jIHwgNDQ0ICsrKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0tLS0t
LS0tLS0NCj4gLS0tLQ0KPiAgZnMvbmZzL2ludGVybmFsLmggICB8ICAxNCArLQ0KPiAgZnMvbmZz
L25mczRjbGllbnQuYyB8ICA2MCArKystLS0NCj4gIGZzL25mcy9uZnM0c3VwZXIuYyAgfCAgIDYg
Ky0NCj4gIGZzL25mcy9zdXBlci5jICAgICAgfCAxOTQgKysrKysrKysrLS0tLS0tLS0tLQ0KPiAg
NiBmaWxlcyBjaGFuZ2VkLCAzOTIgaW5zZXJ0aW9ucygrKSwgMzkyIGRlbGV0aW9ucygtKQ0KPiAN
Cj4gZGlmZiAtLWdpdCBhL2ZzL25mcy9jbGllbnQuYyBiL2ZzL25mcy9jbGllbnQuYw0KPiBpbmRl
eCAxMzBjMDY1MTQxYjMuLjFhZmQ3OTZhMzcwNiAxMDA2NDQNCj4gLS0tIGEvZnMvbmZzL2NsaWVu
dC5jDQo+ICsrKyBiL2ZzL25mcy9jbGllbnQuYw0KPiBAQCAtNjQ4LDI3ICs2NDgsMjcgQEAgRVhQ
T1JUX1NZTUJPTF9HUEwobmZzX2luaXRfY2xpZW50KTsNCj4gICAqIENyZWF0ZSBhIHZlcnNpb24g
MiBvciAzIGNsaWVudA0KPiAgICovDQo+ICBzdGF0aWMgaW50IG5mc19pbml0X3NlcnZlcihzdHJ1
Y3QgbmZzX3NlcnZlciAqc2VydmVyLA0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICBjb25z
dCBzdHJ1Y3QgbmZzX3BhcnNlZF9tb3VudF9kYXRhICpkYXRhLA0KPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICBjb25zdCBzdHJ1Y3QgbmZzX2ZzX2NvbnRleHQgKmNmZywNCj4gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IG5mc19zdWJ2ZXJzaW9uICpuZnNfbW9kKQ0KPiAgew0K
PiAgICAgICAgIHN0cnVjdCBycGNfdGltZW91dCB0aW1lcGFybXM7DQo+ICAgICAgICAgc3RydWN0
IG5mc19jbGllbnRfaW5pdGRhdGEgY2xfaW5pdCA9IHsNCj4gLSAgICAgICAgICAgICAgIC5ob3N0
bmFtZSA9IGRhdGEtPm5mc19zZXJ2ZXIuaG9zdG5hbWUsDQo+IC0gICAgICAgICAgICAgICAuYWRk
ciA9IChjb25zdCBzdHJ1Y3Qgc29ja2FkZHIgKikmZGF0YS0NCj4gPm5mc19zZXJ2ZXIuYWRkcmVz
cywNCj4gLSAgICAgICAgICAgICAgIC5hZGRybGVuID0gZGF0YS0+bmZzX3NlcnZlci5hZGRybGVu
LA0KPiArICAgICAgICAgICAgICAgLmhvc3RuYW1lID0gY2ZnLT5uZnNfc2VydmVyLmhvc3RuYW1l
LA0KPiArICAgICAgICAgICAgICAgLmFkZHIgPSAoY29uc3Qgc3RydWN0IHNvY2thZGRyICopJmNm
Zy0NCj4gPm5mc19zZXJ2ZXIuYWRkcmVzcywNCj4gKyAgICAgICAgICAgICAgIC5hZGRybGVuID0g
Y2ZnLT5uZnNfc2VydmVyLmFkZHJsZW4sDQo+ICAgICAgICAgICAgICAgICAubmZzX21vZCA9IG5m
c19tb2QsDQo+IC0gICAgICAgICAgICAgICAucHJvdG8gPSBkYXRhLT5uZnNfc2VydmVyLnByb3Rv
Y29sLA0KPiAtICAgICAgICAgICAgICAgLm5ldCA9IGRhdGEtPm5ldCwNCj4gKyAgICAgICAgICAg
ICAgIC5wcm90byA9IGNmZy0+bmZzX3NlcnZlci5wcm90b2NvbCwNCj4gKyAgICAgICAgICAgICAg
IC5uZXQgPSBjZmctPm5ldCwNCj4gICAgICAgICAgICAgICAgIC50aW1lcGFybXMgPSAmdGltZXBh
cm1zLA0KPiAgICAgICAgICAgICAgICAgLmNyZWQgPSBzZXJ2ZXItPmNyZWQsDQo+IC0gICAgICAg
ICAgICAgICAubmNvbm5lY3QgPSBkYXRhLT5uZnNfc2VydmVyLm5jb25uZWN0LA0KPiArICAgICAg
ICAgICAgICAgLm5jb25uZWN0ID0gY2ZnLT5uZnNfc2VydmVyLm5jb25uZWN0LA0KPiAgICAgICAg
IH07DQo+ICAgICAgICAgc3RydWN0IG5mc19jbGllbnQgKmNscDsNCj4gICAgICAgICBpbnQgZXJy
b3I7DQo+IA0KPiAtICAgICAgIG5mc19pbml0X3RpbWVvdXRfdmFsdWVzKCZ0aW1lcGFybXMsIGRh
dGEtDQo+ID5uZnNfc2VydmVyLnByb3RvY29sLA0KPiAtICAgICAgICAgICAgICAgICAgICAgICBk
YXRhLT50aW1lbywgZGF0YS0+cmV0cmFucyk7DQo+IC0gICAgICAgaWYgKGRhdGEtPmZsYWdzICYg
TkZTX01PVU5UX05PUkVTVlBPUlQpDQo+ICsgICAgICAgbmZzX2luaXRfdGltZW91dF92YWx1ZXMo
JnRpbWVwYXJtcywgY2ZnLT5uZnNfc2VydmVyLnByb3RvY29sLA0KPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGNmZy0+dGltZW8sIGNmZy0+cmV0cmFucyk7DQo+ICsgICAgICAgaWYg
KGNmZy0+ZmxhZ3MgJiBORlNfTU9VTlRfTk9SRVNWUE9SVCkNCj4gICAgICAgICAgICAgICAgIHNl
dF9iaXQoTkZTX0NTX05PUkVTVlBPUlQsICZjbF9pbml0LmluaXRfZmxhZ3MpOw0KPiANCj4gICAg
ICAgICAvKiBBbGxvY2F0ZSBvciBmaW5kIGEgY2xpZW50IHJlZmVyZW5jZSB3ZSBjYW4gdXNlICov
DQo+IEBAIC02NzksNDYgKzY3OSw0NiBAQCBzdGF0aWMgaW50IG5mc19pbml0X3NlcnZlcihzdHJ1
Y3QgbmZzX3NlcnZlcg0KPiAqc2VydmVyLA0KPiAgICAgICAgIHNlcnZlci0+bmZzX2NsaWVudCA9
IGNscDsNCj4gDQo+ICAgICAgICAgLyogSW5pdGlhbGlzZSB0aGUgY2xpZW50IHJlcHJlc2VudGF0
aW9uIGZyb20gdGhlIG1vdW50IGRhdGENCj4gKi8NCj4gLSAgICAgICBzZXJ2ZXItPmZsYWdzID0g
ZGF0YS0+ZmxhZ3M7DQo+IC0gICAgICAgc2VydmVyLT5vcHRpb25zID0gZGF0YS0+b3B0aW9uczsN
Cj4gKyAgICAgICBzZXJ2ZXItPmZsYWdzID0gY2ZnLT5mbGFnczsNCj4gKyAgICAgICBzZXJ2ZXIt
Pm9wdGlvbnMgPSBjZmctPm9wdGlvbnM7DQo+ICAgICAgICAgc2VydmVyLT5jYXBzIHw9DQo+IE5G
U19DQVBfSEFSRExJTktTfE5GU19DQVBfU1lNTElOS1N8TkZTX0NBUF9GSUxFSUR8DQo+ICAgICAg
ICAgICAgICAgICBORlNfQ0FQX01PREV8TkZTX0NBUF9OTElOS3xORlNfQ0FQX09XTkVSfE5GU19D
QVBfT1dORQ0KPiBSX0dST1VQfA0KPiAgICAgICAgICAgICAgICAgTkZTX0NBUF9BVElNRXxORlNf
Q0FQX0NUSU1FfE5GU19DQVBfTVRJTUU7DQo+IA0KPiAtICAgICAgIGlmIChkYXRhLT5yc2l6ZSkN
Cj4gLSAgICAgICAgICAgICAgIHNlcnZlci0+cnNpemUgPSBuZnNfYmxvY2tfc2l6ZShkYXRhLT5y
c2l6ZSwgTlVMTCk7DQo+IC0gICAgICAgaWYgKGRhdGEtPndzaXplKQ0KPiAtICAgICAgICAgICAg
ICAgc2VydmVyLT53c2l6ZSA9IG5mc19ibG9ja19zaXplKGRhdGEtPndzaXplLCBOVUxMKTsNCj4g
KyAgICAgICBpZiAoY2ZnLT5yc2l6ZSkNCj4gKyAgICAgICAgICAgICAgIHNlcnZlci0+cnNpemUg
PSBuZnNfYmxvY2tfc2l6ZShjZmctPnJzaXplLCBOVUxMKTsNCj4gKyAgICAgICBpZiAoY2ZnLT53
c2l6ZSkNCj4gKyAgICAgICAgICAgICAgIHNlcnZlci0+d3NpemUgPSBuZnNfYmxvY2tfc2l6ZShj
ZmctPndzaXplLCBOVUxMKTsNCj4gDQo+IC0gICAgICAgc2VydmVyLT5hY3JlZ21pbiA9IGRhdGEt
PmFjcmVnbWluICogSFo7DQo+IC0gICAgICAgc2VydmVyLT5hY3JlZ21heCA9IGRhdGEtPmFjcmVn
bWF4ICogSFo7DQo+IC0gICAgICAgc2VydmVyLT5hY2Rpcm1pbiA9IGRhdGEtPmFjZGlybWluICog
SFo7DQo+IC0gICAgICAgc2VydmVyLT5hY2Rpcm1heCA9IGRhdGEtPmFjZGlybWF4ICogSFo7DQo+
ICsgICAgICAgc2VydmVyLT5hY3JlZ21pbiA9IGNmZy0+YWNyZWdtaW4gKiBIWjsNCj4gKyAgICAg
ICBzZXJ2ZXItPmFjcmVnbWF4ID0gY2ZnLT5hY3JlZ21heCAqIEhaOw0KPiArICAgICAgIHNlcnZl
ci0+YWNkaXJtaW4gPSBjZmctPmFjZGlybWluICogSFo7DQo+ICsgICAgICAgc2VydmVyLT5hY2Rp
cm1heCA9IGNmZy0+YWNkaXJtYXggKiBIWjsNCj4gDQo+ICAgICAgICAgLyogU3RhcnQgbG9ja2Qg
aGVyZSwgYmVmb3JlIHdlIG1pZ2h0IGVycm9yIG91dCAqLw0KPiAgICAgICAgIGVycm9yID0gbmZz
X3N0YXJ0X2xvY2tkKHNlcnZlcik7DQo+ICAgICAgICAgaWYgKGVycm9yIDwgMCkNCj4gICAgICAg
ICAgICAgICAgIGdvdG8gZXJyb3I7DQo+IA0KPiAtICAgICAgIHNlcnZlci0+cG9ydCA9IGRhdGEt
Pm5mc19zZXJ2ZXIucG9ydDsNCj4gLSAgICAgICBzZXJ2ZXItPmF1dGhfaW5mbyA9IGRhdGEtPmF1
dGhfaW5mbzsNCj4gKyAgICAgICBzZXJ2ZXItPnBvcnQgPSBjZmctPm5mc19zZXJ2ZXIucG9ydDsN
Cj4gKyAgICAgICBzZXJ2ZXItPmF1dGhfaW5mbyA9IGNmZy0+YXV0aF9pbmZvOw0KPiANCj4gICAg
ICAgICBlcnJvciA9IG5mc19pbml0X3NlcnZlcl9ycGNjbGllbnQoc2VydmVyLCAmdGltZXBhcm1z
LA0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLT5zZWxl
Y3RlZF9mbGF2b3IpOw0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBjZmctPnNlbGVjdGVkX2ZsYXZvcik7DQo+ICAgICAgICAgaWYgKGVycm9yIDwgMCkNCj4gICAg
ICAgICAgICAgICAgIGdvdG8gZXJyb3I7DQo+IA0KPiAgICAgICAgIC8qIFByZXNlcnZlIHRoZSB2
YWx1ZXMgb2YgbW91bnRfc2VydmVyLXJlbGF0ZWQgbW91bnQgb3B0aW9ucw0KPiAqLw0KPiAtICAg
ICAgIGlmIChkYXRhLT5tb3VudF9zZXJ2ZXIuYWRkcmxlbikgew0KPiAtICAgICAgICAgICAgICAg
bWVtY3B5KCZzZXJ2ZXItPm1vdW50ZF9hZGRyZXNzLCAmZGF0YS0NCj4gPm1vdW50X3NlcnZlci5h
ZGRyZXNzLA0KPiAtICAgICAgICAgICAgICAgICAgICAgICBkYXRhLT5tb3VudF9zZXJ2ZXIuYWRk
cmxlbik7DQo+IC0gICAgICAgICAgICAgICBzZXJ2ZXItPm1vdW50ZF9hZGRybGVuID0gZGF0YS0+
bW91bnRfc2VydmVyLmFkZHJsZW47DQo+ICsgICAgICAgaWYgKGNmZy0+bW91bnRfc2VydmVyLmFk
ZHJsZW4pIHsNCj4gKyAgICAgICAgICAgICAgIG1lbWNweSgmc2VydmVyLT5tb3VudGRfYWRkcmVz
cywgJmNmZy0NCj4gPm1vdW50X3NlcnZlci5hZGRyZXNzLA0KPiArICAgICAgICAgICAgICAgICAg
ICAgICBjZmctPm1vdW50X3NlcnZlci5hZGRybGVuKTsNCj4gKyAgICAgICAgICAgICAgIHNlcnZl
ci0+bW91bnRkX2FkZHJsZW4gPSBjZmctPm1vdW50X3NlcnZlci5hZGRybGVuOw0KPiAgICAgICAg
IH0NCj4gLSAgICAgICBzZXJ2ZXItPm1vdW50ZF92ZXJzaW9uID0gZGF0YS0+bW91bnRfc2VydmVy
LnZlcnNpb247DQo+IC0gICAgICAgc2VydmVyLT5tb3VudGRfcG9ydCA9IGRhdGEtPm1vdW50X3Nl
cnZlci5wb3J0Ow0KPiAtICAgICAgIHNlcnZlci0+bW91bnRkX3Byb3RvY29sID0gZGF0YS0+bW91
bnRfc2VydmVyLnByb3RvY29sOw0KPiArICAgICAgIHNlcnZlci0+bW91bnRkX3ZlcnNpb24gPSBj
ZmctPm1vdW50X3NlcnZlci52ZXJzaW9uOw0KPiArICAgICAgIHNlcnZlci0+bW91bnRkX3BvcnQg
PSBjZmctPm1vdW50X3NlcnZlci5wb3J0Ow0KPiArICAgICAgIHNlcnZlci0+bW91bnRkX3Byb3Rv
Y29sID0gY2ZnLT5tb3VudF9zZXJ2ZXIucHJvdG9jb2w7DQo+IA0KPiAtICAgICAgIHNlcnZlci0+
bmFtZWxlbiAgPSBkYXRhLT5uYW1sZW47DQo+ICsgICAgICAgc2VydmVyLT5uYW1lbGVuICA9IGNm
Zy0+bmFtbGVuOw0KPiAgICAgICAgIHJldHVybiAwOw0KPiANCj4gIGVycm9yOg0KPiBAQCAtOTU5
LDcgKzk1OSw3IEBAIHN0cnVjdCBuZnNfc2VydmVyICpuZnNfY3JlYXRlX3NlcnZlcihzdHJ1Y3QN
Cj4gbmZzX21vdW50X2luZm8gKm1vdW50X2luZm8pDQo+ICAgICAgICAgICAgICAgICBnb3RvIGVy
cm9yOw0KPiANCj4gICAgICAgICAvKiBHZXQgYSBjbGllbnQgcmVwcmVzZW50YXRpb24gKi8NCj4g
LSAgICAgICBlcnJvciA9IG5mc19pbml0X3NlcnZlcihzZXJ2ZXIsIG1vdW50X2luZm8tPnBhcnNl
ZCwgbmZzX21vZCk7DQo+ICsgICAgICAgZXJyb3IgPSBuZnNfaW5pdF9zZXJ2ZXIoc2VydmVyLCBt
b3VudF9pbmZvLT5jdHgsIG5mc19tb2QpOw0KPiAgICAgICAgIGlmIChlcnJvciA8IDApDQo+ICAg
ICAgICAgICAgICAgICBnb3RvIGVycm9yOw0KPiANCj4gQEAgLTk3MCw3ICs5NzAsNyBAQCBzdHJ1
Y3QgbmZzX3NlcnZlciAqbmZzX2NyZWF0ZV9zZXJ2ZXIoc3RydWN0DQo+IG5mc19tb3VudF9pbmZv
ICptb3VudF9pbmZvKQ0KPiAgICAgICAgIGlmIChzZXJ2ZXItPm5mc19jbGllbnQtPnJwY19vcHMt
PnZlcnNpb24gPT0gMykgew0KPiAgICAgICAgICAgICAgICAgaWYgKHNlcnZlci0+bmFtZWxlbiA9
PSAwIHx8IHNlcnZlci0+bmFtZWxlbiA+DQo+IE5GUzNfTUFYTkFNTEVOKQ0KPiAgICAgICAgICAg
ICAgICAgICAgICAgICBzZXJ2ZXItPm5hbWVsZW4gPSBORlMzX01BWE5BTUxFTjsNCj4gLSAgICAg
ICAgICAgICAgIGlmICghKG1vdW50X2luZm8tPnBhcnNlZC0+ZmxhZ3MgJg0KPiBORlNfTU9VTlRf
Tk9SRElSUExVUykpDQo+ICsgICAgICAgICAgICAgICBpZiAoIShtb3VudF9pbmZvLT5jdHgtPmZs
YWdzICYgTkZTX01PVU5UX05PUkRJUlBMVVMpKQ0KPiAgICAgICAgICAgICAgICAgICAgICAgICBz
ZXJ2ZXItPmNhcHMgfD0gTkZTX0NBUF9SRUFERElSUExVUzsNCj4gICAgICAgICB9IGVsc2Ugew0K
PiAgICAgICAgICAgICAgICAgaWYgKHNlcnZlci0+bmFtZWxlbiA9PSAwIHx8IHNlcnZlci0+bmFt
ZWxlbiA+DQo+IE5GUzJfTUFYTkFNTEVOKQ0KPiBkaWZmIC0tZ2l0IGEvZnMvbmZzL2ZzX2NvbnRl
eHQuYyBiL2ZzL25mcy9mc19jb250ZXh0LmMNCj4gaW5kZXggOTY3YzY4NGIyNmQyLi5hZDZmNTJk
MGM2MzEgMTAwNjQ0DQo+IC0tLSBhL2ZzL25mcy9mc19jb250ZXh0LmMNCj4gKysrIGIvZnMvbmZz
L2ZzX2NvbnRleHQuYw0KPiBAQCAtMjQ2LDQwICsyNDYsNDAgQEAgc3RhdGljIGNvbnN0IG1hdGNo
X3RhYmxlX3QgbmZzX3ZlcnNfdG9rZW5zID0gew0KPiAgICAgICAgIHsgT3B0X3ZlcnNfZXJyLCBO
VUxMIH0NCj4gIH07DQo+IA0KPiAtc3RydWN0IG5mc19wYXJzZWRfbW91bnRfZGF0YSAqbmZzX2Fs
bG9jX3BhcnNlZF9tb3VudF9kYXRhKHZvaWQpDQo+ICtzdHJ1Y3QgbmZzX2ZzX2NvbnRleHQgKm5m
c19hbGxvY19wYXJzZWRfbW91bnRfZGF0YSh2b2lkKQ0KPiAgew0KPiAtICAgICAgIHN0cnVjdCBu
ZnNfcGFyc2VkX21vdW50X2RhdGEgKmRhdGE7DQo+IC0NCj4gLSAgICAgICBkYXRhID0ga3phbGxv
YyhzaXplb2YoKmRhdGEpLCBHRlBfS0VSTkVMKTsNCj4gLSAgICAgICBpZiAoZGF0YSkgew0KPiAt
ICAgICAgICAgICAgICAgZGF0YS0+dGltZW8gICAgICAgICAgICAgPSBORlNfVU5TUEVDX1RJTUVP
Ow0KPiAtICAgICAgICAgICAgICAgZGF0YS0+cmV0cmFucyAgICAgICAgICAgPSBORlNfVU5TUEVD
X1JFVFJBTlM7DQo+IC0gICAgICAgICAgICAgICBkYXRhLT5hY3JlZ21pbiAgICAgICAgICA9IE5G
U19ERUZfQUNSRUdNSU47DQo+IC0gICAgICAgICAgICAgICBkYXRhLT5hY3JlZ21heCAgICAgICAg
ICA9IE5GU19ERUZfQUNSRUdNQVg7DQo+IC0gICAgICAgICAgICAgICBkYXRhLT5hY2Rpcm1pbiAg
ICAgICAgICA9IE5GU19ERUZfQUNESVJNSU47DQo+IC0gICAgICAgICAgICAgICBkYXRhLT5hY2Rp
cm1heCAgICAgICAgICA9IE5GU19ERUZfQUNESVJNQVg7DQo+IC0gICAgICAgICAgICAgICBkYXRh
LT5tb3VudF9zZXJ2ZXIucG9ydCA9IE5GU19VTlNQRUNfUE9SVDsNCj4gLSAgICAgICAgICAgICAg
IGRhdGEtPm5mc19zZXJ2ZXIucG9ydCAgID0gTkZTX1VOU1BFQ19QT1JUOw0KPiAtICAgICAgICAg
ICAgICAgZGF0YS0+bmZzX3NlcnZlci5wcm90b2NvbCA9IFhQUlRfVFJBTlNQT1JUX1RDUDsNCj4g
LSAgICAgICAgICAgICAgIGRhdGEtPnNlbGVjdGVkX2ZsYXZvciAgID0gUlBDX0FVVEhfTUFYRkxB
Vk9SOw0KPiAtICAgICAgICAgICAgICAgZGF0YS0+bWlub3J2ZXJzaW9uICAgICAgPSAwOw0KPiAt
ICAgICAgICAgICAgICAgZGF0YS0+bmVlZF9tb3VudCAgICAgICAgPSB0cnVlOw0KPiAtICAgICAg
ICAgICAgICAgZGF0YS0+bmV0ICAgICAgICAgICAgICAgPSBjdXJyZW50LT5uc3Byb3h5LT5uZXRf
bnM7DQo+IC0gICAgICAgICAgICAgICBkYXRhLT5sc21fb3B0cyAgICAgICAgICA9IE5VTEw7DQo+
ICsgICAgICAgc3RydWN0IG5mc19mc19jb250ZXh0ICpjdHg7DQo+ICsNCj4gKyAgICAgICBjdHgg
PSBremFsbG9jKHNpemVvZigqY3R4KSwgR0ZQX0tFUk5FTCk7DQo+ICsgICAgICAgaWYgKGN0eCkg
ew0KPiArICAgICAgICAgICAgICAgY3R4LT50aW1lbyAgICAgICAgICAgICAgPSBORlNfVU5TUEVD
X1RJTUVPOw0KPiArICAgICAgICAgICAgICAgY3R4LT5yZXRyYW5zICAgICAgICAgICAgPSBORlNf
VU5TUEVDX1JFVFJBTlM7DQo+ICsgICAgICAgICAgICAgICBjdHgtPmFjcmVnbWluICAgICAgICAg
ICA9IE5GU19ERUZfQUNSRUdNSU47DQo+ICsgICAgICAgICAgICAgICBjdHgtPmFjcmVnbWF4ICAg
ICAgICAgICA9IE5GU19ERUZfQUNSRUdNQVg7DQo+ICsgICAgICAgICAgICAgICBjdHgtPmFjZGly
bWluICAgICAgICAgICA9IE5GU19ERUZfQUNESVJNSU47DQo+ICsgICAgICAgICAgICAgICBjdHgt
PmFjZGlybWF4ICAgICAgICAgICA9IE5GU19ERUZfQUNESVJNQVg7DQo+ICsgICAgICAgICAgICAg
ICBjdHgtPm1vdW50X3NlcnZlci5wb3J0ICA9IE5GU19VTlNQRUNfUE9SVDsNCj4gKyAgICAgICAg
ICAgICAgIGN0eC0+bmZzX3NlcnZlci5wb3J0ICAgID0gTkZTX1VOU1BFQ19QT1JUOw0KPiArICAg
ICAgICAgICAgICAgY3R4LT5uZnNfc2VydmVyLnByb3RvY29sID0gWFBSVF9UUkFOU1BPUlRfVENQ
Ow0KPiArICAgICAgICAgICAgICAgY3R4LT5zZWxlY3RlZF9mbGF2b3IgICAgPSBSUENfQVVUSF9N
QVhGTEFWT1I7DQo+ICsgICAgICAgICAgICAgICBjdHgtPm1pbm9ydmVyc2lvbiAgICAgICA9IDA7
DQo+ICsgICAgICAgICAgICAgICBjdHgtPm5lZWRfbW91bnQgPSB0cnVlOw0KPiArICAgICAgICAg
ICAgICAgY3R4LT5uZXQgICAgICAgICAgICAgICAgPSBjdXJyZW50LT5uc3Byb3h5LT5uZXRfbnM7
DQo+ICsgICAgICAgICAgICAgICBjdHgtPmxzbV9vcHRzID0gTlVMTDsNCj4gICAgICAgICB9DQo+
IC0gICAgICAgcmV0dXJuIGRhdGE7DQo+ICsgICAgICAgcmV0dXJuIGN0eDsNCj4gIH0NCj4gDQo+
IC12b2lkIG5mc19mcmVlX3BhcnNlZF9tb3VudF9kYXRhKHN0cnVjdCBuZnNfcGFyc2VkX21vdW50
X2RhdGEgKmRhdGEpDQo+ICt2b2lkIG5mc19mcmVlX3BhcnNlZF9tb3VudF9kYXRhKHN0cnVjdCBu
ZnNfZnNfY29udGV4dCAqY3R4KQ0KPiAgew0KPiAtICAgICAgIGlmIChkYXRhKSB7DQo+IC0gICAg
ICAgICAgICAgICBrZnJlZShkYXRhLT5jbGllbnRfYWRkcmVzcyk7DQo+IC0gICAgICAgICAgICAg
ICBrZnJlZShkYXRhLT5tb3VudF9zZXJ2ZXIuaG9zdG5hbWUpOw0KPiAtICAgICAgICAgICAgICAg
a2ZyZWUoZGF0YS0+bmZzX3NlcnZlci5leHBvcnRfcGF0aCk7DQo+IC0gICAgICAgICAgICAgICBr
ZnJlZShkYXRhLT5uZnNfc2VydmVyLmhvc3RuYW1lKTsNCj4gLSAgICAgICAgICAgICAgIGtmcmVl
KGRhdGEtPmZzY2FjaGVfdW5pcSk7DQo+IC0gICAgICAgICAgICAgICBzZWN1cml0eV9mcmVlX21u
dF9vcHRzKCZkYXRhLT5sc21fb3B0cyk7DQo+IC0gICAgICAgICAgICAgICBrZnJlZShkYXRhKTsN
Cj4gKyAgICAgICBpZiAoY3R4KSB7DQo+ICsgICAgICAgICAgICAgICBrZnJlZShjdHgtPmNsaWVu
dF9hZGRyZXNzKTsNCj4gKyAgICAgICAgICAgICAgIGtmcmVlKGN0eC0+bW91bnRfc2VydmVyLmhv
c3RuYW1lKTsNCj4gKyAgICAgICAgICAgICAgIGtmcmVlKGN0eC0+bmZzX3NlcnZlci5leHBvcnRf
cGF0aCk7DQo+ICsgICAgICAgICAgICAgICBrZnJlZShjdHgtPm5mc19zZXJ2ZXIuaG9zdG5hbWUp
Ow0KPiArICAgICAgICAgICAgICAga2ZyZWUoY3R4LT5mc2NhY2hlX3VuaXEpOw0KPiArICAgICAg
ICAgICAgICAgc2VjdXJpdHlfZnJlZV9tbnRfb3B0cygmY3R4LT5sc21fb3B0cyk7DQo+ICsgICAg
ICAgICAgICAgICBrZnJlZShjdHgpOw0KPiAgICAgICAgIH0NCj4gIH0NCj4gDQo+IEBAIC0zMTAs
MTUgKzMxMCwxNSBAQCBzdGF0aWMgaW50IG5mc192ZXJpZnlfc2VydmVyX2FkZHJlc3Moc3RydWN0
DQo+IHNvY2thZGRyICphZGRyKQ0KPiAgICogU2FuaXR5IGNoZWNrIHRoZSBORlMgdHJhbnNwb3J0
IHByb3RvY29sLg0KPiAgICoNCj4gICAqLw0KPiAtc3RhdGljIHZvaWQgbmZzX3ZhbGlkYXRlX3Ry
YW5zcG9ydF9wcm90b2NvbChzdHJ1Y3QNCj4gbmZzX3BhcnNlZF9tb3VudF9kYXRhICptbnQpDQo+
ICtzdGF0aWMgdm9pZCBuZnNfdmFsaWRhdGVfdHJhbnNwb3J0X3Byb3RvY29sKHN0cnVjdCBuZnNf
ZnNfY29udGV4dA0KPiAqY3R4KQ0KPiAgew0KPiAtICAgICAgIHN3aXRjaCAobW50LT5uZnNfc2Vy
dmVyLnByb3RvY29sKSB7DQo+ICsgICAgICAgc3dpdGNoIChjdHgtPm5mc19zZXJ2ZXIucHJvdG9j
b2wpIHsNCj4gICAgICAgICBjYXNlIFhQUlRfVFJBTlNQT1JUX1VEUDoNCj4gICAgICAgICBjYXNl
IFhQUlRfVFJBTlNQT1JUX1RDUDoNCj4gICAgICAgICBjYXNlIFhQUlRfVFJBTlNQT1JUX1JETUE6
DQo+ICAgICAgICAgICAgICAgICBicmVhazsNCj4gICAgICAgICBkZWZhdWx0Og0KPiAtICAgICAg
ICAgICAgICAgbW50LT5uZnNfc2VydmVyLnByb3RvY29sID0gWFBSVF9UUkFOU1BPUlRfVENQOw0K
PiArICAgICAgICAgICAgICAgY3R4LT5uZnNfc2VydmVyLnByb3RvY29sID0gWFBSVF9UUkFOU1BP
UlRfVENQOw0KPiAgICAgICAgIH0NCj4gIH0NCj4gDQo+IEBAIC0zMjYsMjAgKzMyNiwyMCBAQCBz
dGF0aWMgdm9pZA0KPiBuZnNfdmFsaWRhdGVfdHJhbnNwb3J0X3Byb3RvY29sKHN0cnVjdCBuZnNf
cGFyc2VkX21vdW50X2RhdGEgKm1udCkNCj4gICAqIEZvciB0ZXh0IGJhc2VkIE5GU3YyL3YzIG1v
dW50cywgdGhlIG1vdW50IHByb3RvY29sIHRyYW5zcG9ydA0KPiBkZWZhdWx0DQo+ICAgKiBzZXR0
aW5ncyBzaG91bGQgZGVwZW5kIHVwb24gdGhlIHNwZWNpZmllZCBORlMgdHJhbnNwb3J0Lg0KPiAg
ICovDQo+IC1zdGF0aWMgdm9pZCBuZnNfc2V0X21vdW50X3RyYW5zcG9ydF9wcm90b2NvbChzdHJ1
Y3QNCj4gbmZzX3BhcnNlZF9tb3VudF9kYXRhICptbnQpDQo+ICtzdGF0aWMgdm9pZCBuZnNfc2V0
X21vdW50X3RyYW5zcG9ydF9wcm90b2NvbChzdHJ1Y3QgbmZzX2ZzX2NvbnRleHQNCj4gKmN0eCkN
Cj4gIHsNCj4gLSAgICAgICBuZnNfdmFsaWRhdGVfdHJhbnNwb3J0X3Byb3RvY29sKG1udCk7DQo+
ICsgICAgICAgbmZzX3ZhbGlkYXRlX3RyYW5zcG9ydF9wcm90b2NvbChjdHgpOw0KPiANCj4gLSAg
ICAgICBpZiAobW50LT5tb3VudF9zZXJ2ZXIucHJvdG9jb2wgPT0gWFBSVF9UUkFOU1BPUlRfVURQ
IHx8DQo+IC0gICAgICAgICAgIG1udC0+bW91bnRfc2VydmVyLnByb3RvY29sID09IFhQUlRfVFJB
TlNQT1JUX1RDUCkNCj4gKyAgICAgICBpZiAoY3R4LT5tb3VudF9zZXJ2ZXIucHJvdG9jb2wgPT0g
WFBSVF9UUkFOU1BPUlRfVURQIHx8DQo+ICsgICAgICAgICAgIGN0eC0+bW91bnRfc2VydmVyLnBy
b3RvY29sID09IFhQUlRfVFJBTlNQT1JUX1RDUCkNCj4gICAgICAgICAgICAgICAgICAgICAgICAg
cmV0dXJuOw0KPiAtICAgICAgIHN3aXRjaCAobW50LT5uZnNfc2VydmVyLnByb3RvY29sKSB7DQo+
ICsgICAgICAgc3dpdGNoIChjdHgtPm5mc19zZXJ2ZXIucHJvdG9jb2wpIHsNCj4gICAgICAgICBj
YXNlIFhQUlRfVFJBTlNQT1JUX1VEUDoNCj4gLSAgICAgICAgICAgICAgIG1udC0+bW91bnRfc2Vy
dmVyLnByb3RvY29sID0gWFBSVF9UUkFOU1BPUlRfVURQOw0KPiArICAgICAgICAgICAgICAgY3R4
LT5tb3VudF9zZXJ2ZXIucHJvdG9jb2wgPSBYUFJUX1RSQU5TUE9SVF9VRFA7DQo+ICAgICAgICAg
ICAgICAgICBicmVhazsNCj4gICAgICAgICBjYXNlIFhQUlRfVFJBTlNQT1JUX1RDUDoNCj4gICAg
ICAgICBjYXNlIFhQUlRfVFJBTlNQT1JUX1JETUE6DQo+IC0gICAgICAgICAgICAgICBtbnQtPm1v
dW50X3NlcnZlci5wcm90b2NvbCA9IFhQUlRfVFJBTlNQT1JUX1RDUDsNCj4gKyAgICAgICAgICAg
ICAgIGN0eC0+bW91bnRfc2VydmVyLnByb3RvY29sID0gWFBSVF9UUkFOU1BPUlRfVENQOw0KPiAg
ICAgICAgIH0NCj4gIH0NCj4gDQo+IEBAIC0zNzEsOCArMzcxLDcgQEAgc3RhdGljIGJvb2wgbmZz
X2F1dGhfaW5mb19hZGQoc3RydWN0DQo+IG5mc19hdXRoX2luZm8gKmF1dGhfaW5mbywNCj4gIC8q
DQo+ICAgKiBQYXJzZSB0aGUgdmFsdWUgb2YgdGhlICdzZWM9JyBvcHRpb24uDQo+ICAgKi8NCj4g
LXN0YXRpYyBpbnQgbmZzX3BhcnNlX3NlY3VyaXR5X2ZsYXZvcnMoY2hhciAqdmFsdWUsDQo+IC0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IG5mc19wYXJzZWRfbW91
bnRfZGF0YQ0KPiAqbW50KQ0KPiArc3RhdGljIGludCBuZnNfcGFyc2Vfc2VjdXJpdHlfZmxhdm9y
cyhjaGFyICp2YWx1ZSwgc3RydWN0DQo+IG5mc19mc19jb250ZXh0ICpjdHgpDQo+ICB7DQo+ICAg
ICAgICAgc3Vic3RyaW5nX3QgYXJnc1tNQVhfT1BUX0FSR1NdOw0KPiAgICAgICAgIHJwY19hdXRo
Zmxhdm9yX3QgcHNldWRvZmxhdm9yOw0KPiBAQCAtNDIxLDcgKzQyMCw3IEBAIHN0YXRpYyBpbnQg
bmZzX3BhcnNlX3NlY3VyaXR5X2ZsYXZvcnMoY2hhcg0KPiAqdmFsdWUsDQo+ICAgICAgICAgICAg
ICAgICAgICAgICAgIHJldHVybiAwOw0KPiAgICAgICAgICAgICAgICAgfQ0KPiANCj4gLSAgICAg
ICAgICAgICAgIGlmICghbmZzX2F1dGhfaW5mb19hZGQoJm1udC0+YXV0aF9pbmZvLA0KPiBwc2V1
ZG9mbGF2b3IpKQ0KPiArICAgICAgICAgICAgICAgaWYgKCFuZnNfYXV0aF9pbmZvX2FkZCgmY3R4
LT5hdXRoX2luZm8sDQo+IHBzZXVkb2ZsYXZvcikpDQo+ICAgICAgICAgICAgICAgICAgICAgICAg
IHJldHVybiAwOw0KPiAgICAgICAgIH0NCj4gDQo+IEBAIC00MjksMzYgKzQyOCwzNiBAQCBzdGF0
aWMgaW50IG5mc19wYXJzZV9zZWN1cml0eV9mbGF2b3JzKGNoYXINCj4gKnZhbHVlLA0KPiAgfQ0K
PiANCj4gIHN0YXRpYyBpbnQgbmZzX3BhcnNlX3ZlcnNpb25fc3RyaW5nKGNoYXIgKnN0cmluZywN
Cj4gLSAgICAgICAgICAgICAgIHN0cnVjdCBuZnNfcGFyc2VkX21vdW50X2RhdGEgKm1udCwNCj4g
KyAgICAgICAgICAgICAgIHN0cnVjdCBuZnNfZnNfY29udGV4dCAqY3R4LA0KPiAgICAgICAgICAg
ICAgICAgc3Vic3RyaW5nX3QgKmFyZ3MpDQo+ICB7DQo+IC0gICAgICAgbW50LT5mbGFncyAmPSB+
TkZTX01PVU5UX1ZFUjM7DQo+ICsgICAgICAgY3R4LT5mbGFncyAmPSB+TkZTX01PVU5UX1ZFUjM7
DQo+ICAgICAgICAgc3dpdGNoIChtYXRjaF90b2tlbihzdHJpbmcsIG5mc192ZXJzX3Rva2Vucywg
YXJncykpIHsNCj4gICAgICAgICBjYXNlIE9wdF92ZXJzXzI6DQo+IC0gICAgICAgICAgICAgICBt
bnQtPnZlcnNpb24gPSAyOw0KPiArICAgICAgICAgICAgICAgY3R4LT52ZXJzaW9uID0gMjsNCj4g
ICAgICAgICAgICAgICAgIGJyZWFrOw0KPiAgICAgICAgIGNhc2UgT3B0X3ZlcnNfMzoNCj4gLSAg
ICAgICAgICAgICAgIG1udC0+ZmxhZ3MgfD0gTkZTX01PVU5UX1ZFUjM7DQo+IC0gICAgICAgICAg
ICAgICBtbnQtPnZlcnNpb24gPSAzOw0KPiArICAgICAgICAgICAgICAgY3R4LT5mbGFncyB8PSBO
RlNfTU9VTlRfVkVSMzsNCj4gKyAgICAgICAgICAgICAgIGN0eC0+dmVyc2lvbiA9IDM7DQo+ICAg
ICAgICAgICAgICAgICBicmVhazsNCj4gICAgICAgICBjYXNlIE9wdF92ZXJzXzQ6DQo+ICAgICAg
ICAgICAgICAgICAvKiBCYWNrd2FyZCBjb21wYXRpYmlsaXR5IG9wdGlvbi4gSW4gZnV0dXJlLA0K
PiAgICAgICAgICAgICAgICAgICogdGhlIG1vdW50IHByb2dyYW0gc2hvdWxkIGFsd2F5cyBzdXBw
bHkNCj4gICAgICAgICAgICAgICAgICAqIGEgTkZTdjQgbWlub3IgdmVyc2lvbiBudW1iZXIuDQo+
ICAgICAgICAgICAgICAgICAgKi8NCj4gLSAgICAgICAgICAgICAgIG1udC0+dmVyc2lvbiA9IDQ7
DQo+ICsgICAgICAgICAgICAgICBjdHgtPnZlcnNpb24gPSA0Ow0KPiAgICAgICAgICAgICAgICAg
YnJlYWs7DQo+ICAgICAgICAgY2FzZSBPcHRfdmVyc180XzA6DQo+IC0gICAgICAgICAgICAgICBt
bnQtPnZlcnNpb24gPSA0Ow0KPiAtICAgICAgICAgICAgICAgbW50LT5taW5vcnZlcnNpb24gPSAw
Ow0KPiArICAgICAgICAgICAgICAgY3R4LT52ZXJzaW9uID0gNDsNCj4gKyAgICAgICAgICAgICAg
IGN0eC0+bWlub3J2ZXJzaW9uID0gMDsNCj4gICAgICAgICAgICAgICAgIGJyZWFrOw0KPiAgICAg
ICAgIGNhc2UgT3B0X3ZlcnNfNF8xOg0KPiAtICAgICAgICAgICAgICAgbW50LT52ZXJzaW9uID0g
NDsNCj4gLSAgICAgICAgICAgICAgIG1udC0+bWlub3J2ZXJzaW9uID0gMTsNCj4gKyAgICAgICAg
ICAgICAgIGN0eC0+dmVyc2lvbiA9IDQ7DQo+ICsgICAgICAgICAgICAgICBjdHgtPm1pbm9ydmVy
c2lvbiA9IDE7DQo+ICAgICAgICAgICAgICAgICBicmVhazsNCj4gICAgICAgICBjYXNlIE9wdF92
ZXJzXzRfMjoNCj4gLSAgICAgICAgICAgICAgIG1udC0+dmVyc2lvbiA9IDQ7DQo+IC0gICAgICAg
ICAgICAgICBtbnQtPm1pbm9ydmVyc2lvbiA9IDI7DQo+ICsgICAgICAgICAgICAgICBjdHgtPnZl
cnNpb24gPSA0Ow0KPiArICAgICAgICAgICAgICAgY3R4LT5taW5vcnZlcnNpb24gPSAyOw0KPiAg
ICAgICAgICAgICAgICAgYnJlYWs7DQo+ICAgICAgICAgZGVmYXVsdDoNCj4gICAgICAgICAgICAg
ICAgIHJldHVybiAwOw0KPiBAQCAtNTA2LDcgKzUwNSw3IEBAIHN0YXRpYyBpbnQgbmZzX2dldF9v
cHRpb25fdWxfYm91bmQoc3Vic3RyaW5nX3QNCj4gYXJnc1tdLCB1bnNpZ25lZCBsb25nICpvcHRp
b24sDQo+ICAgKiBza2lwcGVkIGFzIHRoZXkgYXJlIGVuY291bnRlcmVkLiAgSWYgdGhlcmUgd2Vy
ZSBubyBlcnJvcnMsIHJldHVybg0KPiAxOw0KPiAgICogb3RoZXJ3aXNlIHJldHVybiAwICh6ZXJv
KS4NCj4gICAqLw0KPiAtaW50IG5mc19wYXJzZV9tb3VudF9vcHRpb25zKGNoYXIgKnJhdywgc3Ry
dWN0IG5mc19wYXJzZWRfbW91bnRfZGF0YQ0KPiAqbW50KQ0KPiAraW50IG5mc19wYXJzZV9tb3Vu
dF9vcHRpb25zKGNoYXIgKnJhdywgc3RydWN0IG5mc19mc19jb250ZXh0ICpjdHgpDQo+ICB7DQo+
ICAgICAgICAgY2hhciAqcCwgKnN0cmluZzsNCj4gICAgICAgICBpbnQgcmMsIHNsb3BweSA9IDAs
IGludmFsaWRfb3B0aW9uID0gMDsNCj4gQEAgLTUxOSw3ICs1MTgsNyBAQCBpbnQgbmZzX3BhcnNl
X21vdW50X29wdGlvbnMoY2hhciAqcmF3LCBzdHJ1Y3QNCj4gbmZzX3BhcnNlZF9tb3VudF9kYXRh
ICptbnQpDQo+ICAgICAgICAgfQ0KPiAgICAgICAgIGRmcHJpbnRrKE1PVU5ULCAiTkZTOiBuZnMg
bW91bnQgb3B0cz0nJXMnXG4iLCByYXcpOw0KPiANCj4gLSAgICAgICByYyA9IHNlY3VyaXR5X3Ni
X2VhdF9sc21fb3B0cyhyYXcsICZtbnQtPmxzbV9vcHRzKTsNCj4gKyAgICAgICByYyA9IHNlY3Vy
aXR5X3NiX2VhdF9sc21fb3B0cyhyYXcsICZjdHgtPmxzbV9vcHRzKTsNCj4gICAgICAgICBpZiAo
cmMpDQo+ICAgICAgICAgICAgICAgICBnb3RvIG91dF9zZWN1cml0eV9mYWlsdXJlOw0KPiANCj4g
QEAgLTU0MCw5NiArNTM5LDk2IEBAIGludCBuZnNfcGFyc2VfbW91bnRfb3B0aW9ucyhjaGFyICpy
YXcsIHN0cnVjdA0KPiBuZnNfcGFyc2VkX21vdW50X2RhdGEgKm1udCkNCj4gICAgICAgICAgICAg
ICAgICAqIGJvb2xlYW4gb3B0aW9uczogIGZvby9ub2Zvbw0KPiAgICAgICAgICAgICAgICAgICov
DQo+ICAgICAgICAgICAgICAgICBjYXNlIE9wdF9zb2Z0Og0KPiAtICAgICAgICAgICAgICAgICAg
ICAgICBtbnQtPmZsYWdzIHw9IE5GU19NT1VOVF9TT0ZUOw0KPiAtICAgICAgICAgICAgICAgICAg
ICAgICBtbnQtPmZsYWdzICY9IH5ORlNfTU9VTlRfU09GVEVSUjsNCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgY3R4LT5mbGFncyB8PSBORlNfTU9VTlRfU09GVDsNCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgY3R4LT5mbGFncyAmPSB+TkZTX01PVU5UX1NPRlRFUlI7DQo+ICAgICAgICAgICAg
ICAgICAgICAgICAgIGJyZWFrOw0KPiAgICAgICAgICAgICAgICAgY2FzZSBPcHRfc29mdGVycjoN
Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgbW50LT5mbGFncyB8PSBORlNfTU9VTlRfU09GVEVS
UjsNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgbW50LT5mbGFncyAmPSB+TkZTX01PVU5UX1NP
RlQ7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGN0eC0+ZmxhZ3MgfD0gTkZTX01PVU5UX1NP
RlRFUlI7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGN0eC0+ZmxhZ3MgJj0gfk5GU19NT1VO
VF9TT0ZUOw0KPiAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gICAgICAgICAgICAg
ICAgIGNhc2UgT3B0X2hhcmQ6DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIG1udC0+ZmxhZ3Mg
Jj0NCj4gfihORlNfTU9VTlRfU09GVHxORlNfTU9VTlRfU09GVEVSUik7DQo+ICsgICAgICAgICAg
ICAgICAgICAgICAgIGN0eC0+ZmxhZ3MgJj0NCj4gfihORlNfTU9VTlRfU09GVHxORlNfTU9VTlRf
U09GVEVSUik7DQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiAgICAgICAgICAg
ICAgICAgY2FzZSBPcHRfcG9zaXg6DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIG1udC0+Zmxh
Z3MgfD0gTkZTX01PVU5UX1BPU0lYOw0KPiArICAgICAgICAgICAgICAgICAgICAgICBjdHgtPmZs
YWdzIHw9IE5GU19NT1VOVF9QT1NJWDsNCj4gICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7
DQo+ICAgICAgICAgICAgICAgICBjYXNlIE9wdF9ub3Bvc2l4Og0KPiAtICAgICAgICAgICAgICAg
ICAgICAgICBtbnQtPmZsYWdzICY9IH5ORlNfTU9VTlRfUE9TSVg7DQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgIGN0eC0+ZmxhZ3MgJj0gfk5GU19NT1VOVF9QT1NJWDsNCj4gICAgICAgICAgICAg
ICAgICAgICAgICAgYnJlYWs7DQo+ICAgICAgICAgICAgICAgICBjYXNlIE9wdF9jdG86DQo+IC0g
ICAgICAgICAgICAgICAgICAgICAgIG1udC0+ZmxhZ3MgJj0gfk5GU19NT1VOVF9OT0NUTzsNCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgY3R4LT5mbGFncyAmPSB+TkZTX01PVU5UX05PQ1RPOw0K
PiAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gICAgICAgICAgICAgICAgIGNhc2Ug
T3B0X25vY3RvOg0KPiAtICAgICAgICAgICAgICAgICAgICAgICBtbnQtPmZsYWdzIHw9IE5GU19N
T1VOVF9OT0NUTzsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgY3R4LT5mbGFncyB8PSBORlNf
TU9VTlRfTk9DVE87DQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiAgICAgICAg
ICAgICAgICAgY2FzZSBPcHRfYWM6DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIG1udC0+Zmxh
Z3MgJj0gfk5GU19NT1VOVF9OT0FDOw0KPiArICAgICAgICAgICAgICAgICAgICAgICBjdHgtPmZs
YWdzICY9IH5ORlNfTU9VTlRfTk9BQzsNCj4gICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7
DQo+ICAgICAgICAgICAgICAgICBjYXNlIE9wdF9ub2FjOg0KPiAtICAgICAgICAgICAgICAgICAg
ICAgICBtbnQtPmZsYWdzIHw9IE5GU19NT1VOVF9OT0FDOw0KPiArICAgICAgICAgICAgICAgICAg
ICAgICBjdHgtPmZsYWdzIHw9IE5GU19NT1VOVF9OT0FDOw0KPiAgICAgICAgICAgICAgICAgICAg
ICAgICBicmVhazsNCj4gICAgICAgICAgICAgICAgIGNhc2UgT3B0X2xvY2s6DQo+IC0gICAgICAg
ICAgICAgICAgICAgICAgIG1udC0+ZmxhZ3MgJj0gfk5GU19NT1VOVF9OT05MTTsNCj4gLSAgICAg
ICAgICAgICAgICAgICAgICAgbW50LT5mbGFncyAmPSB+KE5GU19NT1VOVF9MT0NBTF9GTE9DSyB8
DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGN0eC0+ZmxhZ3MgJj0gfk5GU19NT1VOVF9OT05M
TTsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgY3R4LT5mbGFncyAmPSB+KE5GU19NT1VOVF9M
T0NBTF9GTE9DSyB8DQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBO
RlNfTU9VTlRfTE9DQUxfRkNOVEwpOw0KPiAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsN
Cj4gICAgICAgICAgICAgICAgIGNhc2UgT3B0X25vbG9jazoNCj4gLSAgICAgICAgICAgICAgICAg
ICAgICAgbW50LT5mbGFncyB8PSBORlNfTU9VTlRfTk9OTE07DQo+IC0gICAgICAgICAgICAgICAg
ICAgICAgIG1udC0+ZmxhZ3MgfD0gKE5GU19NT1VOVF9MT0NBTF9GTE9DSyB8DQo+ICsgICAgICAg
ICAgICAgICAgICAgICAgIGN0eC0+ZmxhZ3MgfD0gTkZTX01PVU5UX05PTkxNOw0KPiArICAgICAg
ICAgICAgICAgICAgICAgICBjdHgtPmZsYWdzIHw9IChORlNfTU9VTlRfTE9DQUxfRkxPQ0sgfA0K
PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBORlNfTU9VTlRfTE9DQUxf
RkNOVEwpOw0KPiAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gICAgICAgICAgICAg
ICAgIGNhc2UgT3B0X3VkcDoNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgbW50LT5mbGFncyAm
PSB+TkZTX01PVU5UX1RDUDsNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgbW50LT5uZnNfc2Vy
dmVyLnByb3RvY29sID0NCj4gWFBSVF9UUkFOU1BPUlRfVURQOw0KPiArICAgICAgICAgICAgICAg
ICAgICAgICBjdHgtPmZsYWdzICY9IH5ORlNfTU9VTlRfVENQOw0KPiArICAgICAgICAgICAgICAg
ICAgICAgICBjdHgtPm5mc19zZXJ2ZXIucHJvdG9jb2wgPQ0KPiBYUFJUX1RSQU5TUE9SVF9VRFA7
DQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiAgICAgICAgICAgICAgICAgY2Fz
ZSBPcHRfdGNwOg0KPiAtICAgICAgICAgICAgICAgICAgICAgICBtbnQtPmZsYWdzIHw9IE5GU19N
T1VOVF9UQ1A7DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIG1udC0+bmZzX3NlcnZlci5wcm90
b2NvbCA9DQo+IFhQUlRfVFJBTlNQT1JUX1RDUDsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
Y3R4LT5mbGFncyB8PSBORlNfTU9VTlRfVENQOw0KPiArICAgICAgICAgICAgICAgICAgICAgICBj
dHgtPm5mc19zZXJ2ZXIucHJvdG9jb2wgPQ0KPiBYUFJUX1RSQU5TUE9SVF9UQ1A7DQo+ICAgICAg
ICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiAgICAgICAgICAgICAgICAgY2FzZSBPcHRfcmRt
YToNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgbW50LT5mbGFncyB8PSBORlNfTU9VTlRfVENQ
OyAvKiBmb3Igc2lkZQ0KPiBwcm90b2NvbHMgKi8NCj4gLSAgICAgICAgICAgICAgICAgICAgICAg
bW50LT5uZnNfc2VydmVyLnByb3RvY29sID0NCj4gWFBSVF9UUkFOU1BPUlRfUkRNQTsNCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgY3R4LT5mbGFncyB8PSBORlNfTU9VTlRfVENQOyAvKiBmb3Ig
c2lkZQ0KPiBwcm90b2NvbHMgKi8NCj4gKyAgICAgICAgICAgICAgICAgICAgICAgY3R4LT5uZnNf
c2VydmVyLnByb3RvY29sID0NCj4gWFBSVF9UUkFOU1BPUlRfUkRNQTsNCj4gICAgICAgICAgICAg
ICAgICAgICAgICAgeHBydF9sb2FkX3RyYW5zcG9ydChwKTsNCj4gICAgICAgICAgICAgICAgICAg
ICAgICAgYnJlYWs7DQo+ICAgICAgICAgICAgICAgICBjYXNlIE9wdF9hY2w6DQo+IC0gICAgICAg
ICAgICAgICAgICAgICAgIG1udC0+ZmxhZ3MgJj0gfk5GU19NT1VOVF9OT0FDTDsNCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgY3R4LT5mbGFncyAmPSB+TkZTX01PVU5UX05PQUNMOw0KPiAgICAg
ICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gICAgICAgICAgICAgICAgIGNhc2UgT3B0X25v
YWNsOg0KPiAtICAgICAgICAgICAgICAgICAgICAgICBtbnQtPmZsYWdzIHw9IE5GU19NT1VOVF9O
T0FDTDsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgY3R4LT5mbGFncyB8PSBORlNfTU9VTlRf
Tk9BQ0w7DQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiAgICAgICAgICAgICAg
ICAgY2FzZSBPcHRfcmRpcnBsdXM6DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIG1udC0+Zmxh
Z3MgJj0gfk5GU19NT1VOVF9OT1JESVJQTFVTOw0KPiArICAgICAgICAgICAgICAgICAgICAgICBj
dHgtPmZsYWdzICY9IH5ORlNfTU9VTlRfTk9SRElSUExVUzsNCj4gICAgICAgICAgICAgICAgICAg
ICAgICAgYnJlYWs7DQo+ICAgICAgICAgICAgICAgICBjYXNlIE9wdF9ub3JkaXJwbHVzOg0KPiAt
ICAgICAgICAgICAgICAgICAgICAgICBtbnQtPmZsYWdzIHw9IE5GU19NT1VOVF9OT1JESVJQTFVT
Ow0KPiArICAgICAgICAgICAgICAgICAgICAgICBjdHgtPmZsYWdzIHw9IE5GU19NT1VOVF9OT1JE
SVJQTFVTOw0KPiAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gICAgICAgICAgICAg
ICAgIGNhc2UgT3B0X3NoYXJlY2FjaGU6DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIG1udC0+
ZmxhZ3MgJj0gfk5GU19NT1VOVF9VTlNIQVJFRDsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
Y3R4LT5mbGFncyAmPSB+TkZTX01PVU5UX1VOU0hBUkVEOw0KPiAgICAgICAgICAgICAgICAgICAg
ICAgICBicmVhazsNCj4gICAgICAgICAgICAgICAgIGNhc2UgT3B0X25vc2hhcmVjYWNoZToNCj4g
LSAgICAgICAgICAgICAgICAgICAgICAgbW50LT5mbGFncyB8PSBORlNfTU9VTlRfVU5TSEFSRUQ7
DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGN0eC0+ZmxhZ3MgfD0gTkZTX01PVU5UX1VOU0hB
UkVEOw0KPiAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gICAgICAgICAgICAgICAg
IGNhc2UgT3B0X3Jlc3Zwb3J0Og0KPiAtICAgICAgICAgICAgICAgICAgICAgICBtbnQtPmZsYWdz
ICY9IH5ORlNfTU9VTlRfTk9SRVNWUE9SVDsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgY3R4
LT5mbGFncyAmPSB+TkZTX01PVU5UX05PUkVTVlBPUlQ7DQo+ICAgICAgICAgICAgICAgICAgICAg
ICAgIGJyZWFrOw0KPiAgICAgICAgICAgICAgICAgY2FzZSBPcHRfbm9yZXN2cG9ydDoNCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgbW50LT5mbGFncyB8PSBORlNfTU9VTlRfTk9SRVNWUE9SVDsN
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgY3R4LT5mbGFncyB8PSBORlNfTU9VTlRfTk9SRVNW
UE9SVDsNCj4gICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+ICAgICAgICAgICAgICAg
ICBjYXNlIE9wdF9mc2NhY2hlOg0KPiAtICAgICAgICAgICAgICAgICAgICAgICBtbnQtPm9wdGlv
bnMgfD0gTkZTX09QVElPTl9GU0NBQ0hFOw0KPiAtICAgICAgICAgICAgICAgICAgICAgICBrZnJl
ZShtbnQtPmZzY2FjaGVfdW5pcSk7DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIG1udC0+ZnNj
YWNoZV91bmlxID0gTlVMTDsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgY3R4LT5vcHRpb25z
IHw9IE5GU19PUFRJT05fRlNDQUNIRTsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAga2ZyZWUo
Y3R4LT5mc2NhY2hlX3VuaXEpOw0KPiArICAgICAgICAgICAgICAgICAgICAgICBjdHgtPmZzY2Fj
aGVfdW5pcSA9IE5VTEw7DQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiAgICAg
ICAgICAgICAgICAgY2FzZSBPcHRfbm9mc2NhY2hlOg0KPiAtICAgICAgICAgICAgICAgICAgICAg
ICBtbnQtPm9wdGlvbnMgJj0gfk5GU19PUFRJT05fRlNDQUNIRTsNCj4gLSAgICAgICAgICAgICAg
ICAgICAgICAga2ZyZWUobW50LT5mc2NhY2hlX3VuaXEpOw0KPiAtICAgICAgICAgICAgICAgICAg
ICAgICBtbnQtPmZzY2FjaGVfdW5pcSA9IE5VTEw7DQo+ICsgICAgICAgICAgICAgICAgICAgICAg
IGN0eC0+b3B0aW9ucyAmPSB+TkZTX09QVElPTl9GU0NBQ0hFOw0KPiArICAgICAgICAgICAgICAg
ICAgICAgICBrZnJlZShjdHgtPmZzY2FjaGVfdW5pcSk7DQo+ICsgICAgICAgICAgICAgICAgICAg
ICAgIGN0eC0+ZnNjYWNoZV91bmlxID0gTlVMTDsNCj4gICAgICAgICAgICAgICAgICAgICAgICAg
YnJlYWs7DQo+ICAgICAgICAgICAgICAgICBjYXNlIE9wdF9taWdyYXRpb246DQo+IC0gICAgICAg
ICAgICAgICAgICAgICAgIG1udC0+b3B0aW9ucyB8PSBORlNfT1BUSU9OX01JR1JBVElPTjsNCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgY3R4LT5vcHRpb25zIHw9IE5GU19PUFRJT05fTUlHUkFU
SU9OOw0KPiAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gICAgICAgICAgICAgICAg
IGNhc2UgT3B0X25vbWlncmF0aW9uOg0KPiAtICAgICAgICAgICAgICAgICAgICAgICBtbnQtPm9w
dGlvbnMgJj0gfk5GU19PUFRJT05fTUlHUkFUSU9OOw0KPiArICAgICAgICAgICAgICAgICAgICAg
ICBjdHgtPm9wdGlvbnMgJj0gfk5GU19PUFRJT05fTUlHUkFUSU9OOw0KPiAgICAgICAgICAgICAg
ICAgICAgICAgICBicmVhazsNCj4gDQo+ICAgICAgICAgICAgICAgICAvKg0KPiBAQCAtNjM5LDgz
ICs2MzgsODMgQEAgaW50IG5mc19wYXJzZV9tb3VudF9vcHRpb25zKGNoYXIgKnJhdywgc3RydWN0
DQo+IG5mc19wYXJzZWRfbW91bnRfZGF0YSAqbW50KQ0KPiAgICAgICAgICAgICAgICAgICAgICAg
ICBpZiAobmZzX2dldF9vcHRpb25fdWwoYXJncywgJm9wdGlvbikgfHwNCj4gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIG9wdGlvbiA+IFVTSFJUX01BWCkNCj4gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBnb3RvIG91dF9pbnZhbGlkX3ZhbHVlOw0KPiAtICAgICAgICAgICAgICAg
ICAgICAgICBtbnQtPm5mc19zZXJ2ZXIucG9ydCA9IG9wdGlvbjsNCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgY3R4LT5uZnNfc2VydmVyLnBvcnQgPSBvcHRpb247DQo+ICAgICAgICAgICAgICAg
ICAgICAgICAgIGJyZWFrOw0KPiAgICAgICAgICAgICAgICAgY2FzZSBPcHRfcnNpemU6DQo+ICAg
ICAgICAgICAgICAgICAgICAgICAgIGlmIChuZnNfZ2V0X29wdGlvbl91bChhcmdzLCAmb3B0aW9u
KSkNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIG91dF9pbnZhbGlkX3Zh
bHVlOw0KPiAtICAgICAgICAgICAgICAgICAgICAgICBtbnQtPnJzaXplID0gb3B0aW9uOw0KPiAr
ICAgICAgICAgICAgICAgICAgICAgICBjdHgtPnJzaXplID0gb3B0aW9uOw0KPiAgICAgICAgICAg
ICAgICAgICAgICAgICBicmVhazsNCj4gICAgICAgICAgICAgICAgIGNhc2UgT3B0X3dzaXplOg0K
PiAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmZzX2dldF9vcHRpb25fdWwoYXJncywgJm9w
dGlvbikpDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ290byBvdXRfaW52YWxp
ZF92YWx1ZTsNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgbW50LT53c2l6ZSA9IG9wdGlvbjsN
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgY3R4LT53c2l6ZSA9IG9wdGlvbjsNCj4gICAgICAg
ICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+ICAgICAgICAgICAgICAgICBjYXNlIE9wdF9ic2l6
ZToNCj4gICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5mc19nZXRfb3B0aW9uX3VsKGFyZ3Ms
ICZvcHRpb24pKQ0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0X2lu
dmFsaWRfdmFsdWU7DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIG1udC0+YnNpemUgPSBvcHRp
b247DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGN0eC0+YnNpemUgPSBvcHRpb247DQo+ICAg
ICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiAgICAgICAgICAgICAgICAgY2FzZSBPcHRf
dGltZW86DQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZnNfZ2V0X29wdGlvbl91bF9i
b3VuZChhcmdzLCAmb3B0aW9uLCAxLA0KPiBJTlRfTUFYKSkNCj4gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBnb3RvIG91dF9pbnZhbGlkX3ZhbHVlOw0KPiAtICAgICAgICAgICAgICAg
ICAgICAgICBtbnQtPnRpbWVvID0gb3B0aW9uOw0KPiArICAgICAgICAgICAgICAgICAgICAgICBj
dHgtPnRpbWVvID0gb3B0aW9uOw0KPiAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4g
ICAgICAgICAgICAgICAgIGNhc2UgT3B0X3JldHJhbnM6DQo+ICAgICAgICAgICAgICAgICAgICAg
ICAgIGlmIChuZnNfZ2V0X29wdGlvbl91bF9ib3VuZChhcmdzLCAmb3B0aW9uLCAwLA0KPiBJTlRf
TUFYKSkNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIG91dF9pbnZhbGlk
X3ZhbHVlOw0KPiAtICAgICAgICAgICAgICAgICAgICAgICBtbnQtPnJldHJhbnMgPSBvcHRpb247
DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGN0eC0+cmV0cmFucyA9IG9wdGlvbjsNCj4gICAg
ICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+ICAgICAgICAgICAgICAgICBjYXNlIE9wdF9h
Y3JlZ21pbjoNCj4gICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5mc19nZXRfb3B0aW9uX3Vs
KGFyZ3MsICZvcHRpb24pKQ0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8g
b3V0X2ludmFsaWRfdmFsdWU7DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIG1udC0+YWNyZWdt
aW4gPSBvcHRpb247DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGN0eC0+YWNyZWdtaW4gPSBv
cHRpb247DQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiAgICAgICAgICAgICAg
ICAgY2FzZSBPcHRfYWNyZWdtYXg6DQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZnNf
Z2V0X29wdGlvbl91bChhcmdzLCAmb3B0aW9uKSkNCj4gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBnb3RvIG91dF9pbnZhbGlkX3ZhbHVlOw0KPiAtICAgICAgICAgICAgICAgICAgICAg
ICBtbnQtPmFjcmVnbWF4ID0gb3B0aW9uOw0KPiArICAgICAgICAgICAgICAgICAgICAgICBjdHgt
PmFjcmVnbWF4ID0gb3B0aW9uOw0KPiAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4g
ICAgICAgICAgICAgICAgIGNhc2UgT3B0X2FjZGlybWluOg0KPiAgICAgICAgICAgICAgICAgICAg
ICAgICBpZiAobmZzX2dldF9vcHRpb25fdWwoYXJncywgJm9wdGlvbikpDQo+ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgZ290byBvdXRfaW52YWxpZF92YWx1ZTsNCj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgbW50LT5hY2Rpcm1pbiA9IG9wdGlvbjsNCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgY3R4LT5hY2Rpcm1pbiA9IG9wdGlvbjsNCj4gICAgICAgICAgICAgICAgICAgICAg
ICAgYnJlYWs7DQo+ICAgICAgICAgICAgICAgICBjYXNlIE9wdF9hY2Rpcm1heDoNCj4gICAgICAg
ICAgICAgICAgICAgICAgICAgaWYgKG5mc19nZXRfb3B0aW9uX3VsKGFyZ3MsICZvcHRpb24pKQ0K
PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0X2ludmFsaWRfdmFsdWU7
DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIG1udC0+YWNkaXJtYXggPSBvcHRpb247DQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIGN0eC0+YWNkaXJtYXggPSBvcHRpb247DQo+ICAgICAgICAg
ICAgICAgICAgICAgICAgIGJyZWFrOw0KPiAgICAgICAgICAgICAgICAgY2FzZSBPcHRfYWN0aW1l
bzoNCj4gICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5mc19nZXRfb3B0aW9uX3VsKGFyZ3Ms
ICZvcHRpb24pKQ0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0X2lu
dmFsaWRfdmFsdWU7DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIG1udC0+YWNyZWdtaW4gPSBt
bnQtPmFjcmVnbWF4ID0NCj4gLSAgICAgICAgICAgICAgICAgICAgICAgbW50LT5hY2Rpcm1pbiA9
IG1udC0+YWNkaXJtYXggPSBvcHRpb247DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGN0eC0+
YWNyZWdtaW4gPSBjdHgtPmFjcmVnbWF4ID0NCj4gKyAgICAgICAgICAgICAgICAgICAgICAgY3R4
LT5hY2Rpcm1pbiA9IGN0eC0+YWNkaXJtYXggPSBvcHRpb247DQo+ICAgICAgICAgICAgICAgICAg
ICAgICAgIGJyZWFrOw0KPiAgICAgICAgICAgICAgICAgY2FzZSBPcHRfbmFtZWxlbjoNCj4gICAg
ICAgICAgICAgICAgICAgICAgICAgaWYgKG5mc19nZXRfb3B0aW9uX3VsKGFyZ3MsICZvcHRpb24p
KQ0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0X2ludmFsaWRfdmFs
dWU7DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIG1udC0+bmFtbGVuID0gb3B0aW9uOw0KPiAr
ICAgICAgICAgICAgICAgICAgICAgICBjdHgtPm5hbWxlbiA9IG9wdGlvbjsNCj4gICAgICAgICAg
ICAgICAgICAgICAgICAgYnJlYWs7DQo+ICAgICAgICAgICAgICAgICBjYXNlIE9wdF9tb3VudHBv
cnQ6DQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZnNfZ2V0X29wdGlvbl91bChhcmdz
LCAmb3B0aW9uKSB8fA0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uID4gVVNI
UlRfTUFYKQ0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0X2ludmFs
aWRfdmFsdWU7DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIG1udC0+bW91bnRfc2VydmVyLnBv
cnQgPSBvcHRpb247DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGN0eC0+bW91bnRfc2VydmVy
LnBvcnQgPSBvcHRpb247DQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiAgICAg
ICAgICAgICAgICAgY2FzZSBPcHRfbW91bnR2ZXJzOg0KPiAgICAgICAgICAgICAgICAgICAgICAg
ICBpZiAobmZzX2dldF9vcHRpb25fdWwoYXJncywgJm9wdGlvbikgfHwNCj4gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIG9wdGlvbiA8IE5GU19NTlRfVkVSU0lPTiB8fA0KPiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgb3B0aW9uID4gTkZTX01OVDNfVkVSU0lPTikNCj4gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBnb3RvIG91dF9pbnZhbGlkX3ZhbHVlOw0KPiAtICAgICAg
ICAgICAgICAgICAgICAgICBtbnQtPm1vdW50X3NlcnZlci52ZXJzaW9uID0gb3B0aW9uOw0KPiAr
ICAgICAgICAgICAgICAgICAgICAgICBjdHgtPm1vdW50X3NlcnZlci52ZXJzaW9uID0gb3B0aW9u
Ow0KPiAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gICAgICAgICAgICAgICAgIGNh
c2UgT3B0X21pbm9ydmVyc2lvbjoNCj4gICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5mc19n
ZXRfb3B0aW9uX3VsKGFyZ3MsICZvcHRpb24pKQ0KPiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGdvdG8gb3V0X2ludmFsaWRfdmFsdWU7DQo+ICAgICAgICAgICAgICAgICAgICAgICAg
IGlmIChvcHRpb24gPiBORlM0X01BWF9NSU5PUl9WRVJTSU9OKQ0KPiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGdvdG8gb3V0X2ludmFsaWRfdmFsdWU7DQo+IC0gICAgICAgICAgICAg
ICAgICAgICAgIG1udC0+bWlub3J2ZXJzaW9uID0gb3B0aW9uOw0KPiArICAgICAgICAgICAgICAg
ICAgICAgICBjdHgtPm1pbm9ydmVyc2lvbiA9IG9wdGlvbjsNCj4gICAgICAgICAgICAgICAgICAg
ICAgICAgYnJlYWs7DQo+IA0KPiAgICAgICAgICAgICAgICAgLyoNCj4gQEAgLTcyNSw3ICs3MjQs
NyBAQCBpbnQgbmZzX3BhcnNlX21vdW50X29wdGlvbnMoY2hhciAqcmF3LCBzdHJ1Y3QNCj4gbmZz
X3BhcnNlZF9tb3VudF9kYXRhICptbnQpDQo+ICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmlu
ZyA9IG1hdGNoX3N0cmR1cChhcmdzKTsNCj4gICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0
cmluZyA9PSBOVUxMKQ0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0
X25vbWVtOw0KPiAtICAgICAgICAgICAgICAgICAgICAgICByYyA9IG5mc19wYXJzZV92ZXJzaW9u
X3N0cmluZyhzdHJpbmcsIG1udCwNCj4gYXJncyk7DQo+ICsgICAgICAgICAgICAgICAgICAgICAg
IHJjID0gbmZzX3BhcnNlX3ZlcnNpb25fc3RyaW5nKHN0cmluZywgY3R4LA0KPiBhcmdzKTsNCj4g
ICAgICAgICAgICAgICAgICAgICAgICAga2ZyZWUoc3RyaW5nKTsNCj4gICAgICAgICAgICAgICAg
ICAgICAgICAgaWYgKCFyYykNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb3Rv
IG91dF9pbnZhbGlkX3ZhbHVlOw0KPiBAQCAtNzM0LDcgKzczMyw3IEBAIGludCBuZnNfcGFyc2Vf
bW91bnRfb3B0aW9ucyhjaGFyICpyYXcsIHN0cnVjdA0KPiBuZnNfcGFyc2VkX21vdW50X2RhdGEg
Km1udCkNCj4gICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nID0gbWF0Y2hfc3RyZHVwKGFy
Z3MpOw0KPiAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RyaW5nID09IE5VTEwpDQo+ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ290byBvdXRfbm9tZW07DQo+IC0gICAgICAg
ICAgICAgICAgICAgICAgIHJjID0gbmZzX3BhcnNlX3NlY3VyaXR5X2ZsYXZvcnMoc3RyaW5nLCBt
bnQpOw0KPiArICAgICAgICAgICAgICAgICAgICAgICByYyA9IG5mc19wYXJzZV9zZWN1cml0eV9m
bGF2b3JzKHN0cmluZywgY3R4KTsNCj4gICAgICAgICAgICAgICAgICAgICAgICAga2ZyZWUoc3Ry
aW5nKTsNCj4gICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyYykgew0KPiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGRmcHJpbnRrKE1PVU5ULCAiTkZTOiAgIHVucmVjb2duaXpl
ZA0KPiAiDQo+IEBAIC03NTUsMjMgKzc1NCwyMyBAQCBpbnQgbmZzX3BhcnNlX21vdW50X29wdGlv
bnMoY2hhciAqcmF3LCBzdHJ1Y3QNCj4gbmZzX3BhcnNlZF9tb3VudF9kYXRhICptbnQpDQo+ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdG9mYW1pbHkgPSBBRl9JTkVUNjsNCj4g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBmYWxsIHRocm91Z2ggKi8NCj4gICAg
ICAgICAgICAgICAgICAgICAgICAgY2FzZSBPcHRfeHBydF91ZHA6DQo+IC0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbW50LT5mbGFncyAmPSB+TkZTX01PVU5UX1RDUDsNCj4gLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBtbnQtPm5mc19zZXJ2ZXIucHJvdG9jb2wgPQ0KPiBY
UFJUX1RSQU5TUE9SVF9VRFA7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4
LT5mbGFncyAmPSB+TkZTX01PVU5UX1RDUDsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBjdHgtPm5mc19zZXJ2ZXIucHJvdG9jb2wgPQ0KPiBYUFJUX1RSQU5TUE9SVF9VRFA7DQo+
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+ICAgICAgICAgICAgICAg
ICAgICAgICAgIGNhc2UgT3B0X3hwcnRfdGNwNjoNCj4gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBwcm90b2ZhbWlseSA9IEFGX0lORVQ2Ow0KPiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIC8qIGZhbGwgdGhyb3VnaCAqLw0KPiAgICAgICAgICAgICAgICAgICAgICAgICBj
YXNlIE9wdF94cHJ0X3RjcDoNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtbnQt
PmZsYWdzIHw9IE5GU19NT1VOVF9UQ1A7DQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgbW50LT5uZnNfc2VydmVyLnByb3RvY29sID0NCj4gWFBSVF9UUkFOU1BPUlRfVENQOw0KPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC0+ZmxhZ3MgfD0gTkZTX01PVU5UX1RD
UDsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgtPm5mc19zZXJ2ZXIucHJv
dG9jb2wgPQ0KPiBYUFJUX1RSQU5TUE9SVF9UQ1A7DQo+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgYnJlYWs7DQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgT3B0X3hwcnRf
cmRtYTY6DQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdG9mYW1pbHkgPSBB
Rl9JTkVUNjsNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBmYWxsIHRocm91
Z2ggKi8NCj4gICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBPcHRfeHBydF9yZG1hOg0KPiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIHZlY3RvciBzaWRlIHByb3RvY29scyB0
byBUQ1AgKi8NCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtbnQtPmZsYWdzIHw9
IE5GU19NT1VOVF9UQ1A7DQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW50LT5u
ZnNfc2VydmVyLnByb3RvY29sID0NCj4gWFBSVF9UUkFOU1BPUlRfUkRNQTsNCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBjdHgtPmZsYWdzIHw9IE5GU19NT1VOVF9UQ1A7DQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LT5uZnNfc2VydmVyLnByb3RvY29sID0N
Cj4gWFBSVF9UUkFOU1BPUlRfUkRNQTsNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB4cHJ0X2xvYWRfdHJhbnNwb3J0KHN0cmluZyk7DQo+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgYnJlYWs7DQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6DQo+IEBA
IC03OTYsMTMgKzc5NSwxMyBAQCBpbnQgbmZzX3BhcnNlX21vdW50X29wdGlvbnMoY2hhciAqcmF3
LCBzdHJ1Y3QNCj4gbmZzX3BhcnNlZF9tb3VudF9kYXRhICptbnQpDQo+ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbW91bnRmYW1pbHkgPSBBRl9JTkVUNjsNCj4gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAvKiBmYWxsIHRocm91Z2ggKi8NCj4gICAgICAgICAgICAgICAg
ICAgICAgICAgY2FzZSBPcHRfeHBydF91ZHA6DQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgbW50LT5tb3VudF9zZXJ2ZXIucHJvdG9jb2wgPQ0KPiBYUFJUX1RSQU5TUE9SVF9VRFA7
DQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LT5tb3VudF9zZXJ2ZXIucHJv
dG9jb2wgPQ0KPiBYUFJUX1RSQU5TUE9SVF9VRFA7DQo+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgYnJlYWs7DQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgT3B0X3hwcnRf
dGNwNjoNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb3VudGZhbWlseSA9IEFG
X0lORVQ2Ow0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGZhbGwgdGhyb3Vn
aCAqLw0KPiAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE9wdF94cHJ0X3RjcDoNCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtbnQtPm1vdW50X3NlcnZlci5wcm90b2NvbCA9
DQo+IFhQUlRfVFJBTlNQT1JUX1RDUDsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBjdHgtPm1vdW50X3NlcnZlci5wcm90b2NvbCA9DQo+IFhQUlRfVFJBTlNQT1JUX1RDUDsNCj4g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gICAgICAgICAgICAgICAg
ICAgICAgICAgY2FzZSBPcHRfeHBydF9yZG1hOiAvKiBub3QgdXNlZCBmb3Igc2lkZQ0KPiBwcm90
b2NvbHMgKi8NCj4gICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoNCj4gQEAgLTgxNSwz
NSArODE0LDM1IEBAIGludCBuZnNfcGFyc2VfbW91bnRfb3B0aW9ucyhjaGFyICpyYXcsIHN0cnVj
dA0KPiBuZnNfcGFyc2VkX21vdW50X2RhdGEgKm1udCkNCj4gICAgICAgICAgICAgICAgICAgICAg
ICAgc3RyaW5nID0gbWF0Y2hfc3RyZHVwKGFyZ3MpOw0KPiAgICAgICAgICAgICAgICAgICAgICAg
ICBpZiAoc3RyaW5nID09IE5VTEwpDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Z290byBvdXRfbm9tZW07DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIG1udC0+bmZzX3NlcnZl
ci5hZGRybGVuID0NCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBycGNfcHRvbiht
bnQtPm5ldCwgc3RyaW5nLA0KPiBzdHJsZW4oc3RyaW5nKSwNCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgY3R4LT5uZnNfc2VydmVyLmFkZHJsZW4gPQ0KPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHJwY19wdG9uKGN0eC0+bmV0LCBzdHJpbmcsDQo+IHN0cmxlbihzdHJpbmcpLA0K
PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHN0cnVjdCBzb2NrYWRk
ciAqKQ0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJm1udC0+bmZz
X3NlcnZlci5hZGRyZXNzLA0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgc2l6ZW9mKG1udC0NCj4gPm5mc19zZXJ2ZXIuYWRkcmVzcykpOw0KPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgJmN0eC0+bmZzX3NlcnZlci5hZGRyZXNzLA0KPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZW9mKGN0eC0NCj4gPm5m
c19zZXJ2ZXIuYWRkcmVzcykpOw0KPiAgICAgICAgICAgICAgICAgICAgICAgICBrZnJlZShzdHJp
bmcpOw0KPiAtICAgICAgICAgICAgICAgICAgICAgICBpZiAobW50LT5uZnNfc2VydmVyLmFkZHJs
ZW4gPT0gMCkNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN0eC0+bmZzX3NlcnZlci5h
ZGRybGVuID09IDApDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ290byBvdXRf
aW52YWxpZF9hZGRyZXNzOw0KPiAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gICAg
ICAgICAgICAgICAgIGNhc2UgT3B0X2NsaWVudGFkZHI6DQo+IC0gICAgICAgICAgICAgICAgICAg
ICAgIGlmIChuZnNfZ2V0X29wdGlvbl9zdHIoYXJncywgJm1udC0NCj4gPmNsaWVudF9hZGRyZXNz
KSkNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5mc19nZXRfb3B0aW9uX3N0cihhcmdz
LCAmY3R4LQ0KPiA+Y2xpZW50X2FkZHJlc3MpKQ0KPiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGdvdG8gb3V0X25vbWVtOw0KPiAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsN
Cj4gICAgICAgICAgICAgICAgIGNhc2UgT3B0X21vdW50aG9zdDoNCj4gICAgICAgICAgICAgICAg
ICAgICAgICAgaWYgKG5mc19nZXRfb3B0aW9uX3N0cihhcmdzLA0KPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZtbnQtDQo+ID5tb3VudF9zZXJ2ZXIuaG9z
dG5hbWUpKQ0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICZjdHgtDQo+ID5tb3VudF9zZXJ2ZXIuaG9zdG5hbWUpKQ0KPiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGdvdG8gb3V0X25vbWVtOw0KPiAgICAgICAgICAgICAgICAgICAgICAgICBi
cmVhazsNCj4gICAgICAgICAgICAgICAgIGNhc2UgT3B0X21vdW50YWRkcjoNCj4gICAgICAgICAg
ICAgICAgICAgICAgICAgc3RyaW5nID0gbWF0Y2hfc3RyZHVwKGFyZ3MpOw0KPiAgICAgICAgICAg
ICAgICAgICAgICAgICBpZiAoc3RyaW5nID09IE5VTEwpDQo+ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgZ290byBvdXRfbm9tZW07DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIG1u
dC0+bW91bnRfc2VydmVyLmFkZHJsZW4gPQ0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHJwY19wdG9uKG1udC0+bmV0LCBzdHJpbmcsDQo+IHN0cmxlbihzdHJpbmcpLA0KPiArICAg
ICAgICAgICAgICAgICAgICAgICBjdHgtPm1vdW50X3NlcnZlci5hZGRybGVuID0NCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBycGNfcHRvbihjdHgtPm5ldCwgc3RyaW5nLA0KPiBz
dHJsZW4oc3RyaW5nKSwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IChzdHJ1Y3Qgc29ja2FkZHIgKikNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICZtbnQtPm1vdW50X3NlcnZlci5hZGRyZXNzLA0KPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc2l6ZW9mKG1udC0NCj4gPm1vdW50X3NlcnZlci5hZGRyZXNz
KSk7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmY3R4LT5tb3Vu
dF9zZXJ2ZXIuYWRkcmVzcywNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHNpemVvZihjdHgtDQo+ID5tb3VudF9zZXJ2ZXIuYWRkcmVzcykpOw0KPiAgICAgICAgICAg
ICAgICAgICAgICAgICBrZnJlZShzdHJpbmcpOw0KPiAtICAgICAgICAgICAgICAgICAgICAgICBp
ZiAobW50LT5tb3VudF9zZXJ2ZXIuYWRkcmxlbiA9PSAwKQ0KPiArICAgICAgICAgICAgICAgICAg
ICAgICBpZiAoY3R4LT5tb3VudF9zZXJ2ZXIuYWRkcmxlbiA9PSAwKQ0KPiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0X2ludmFsaWRfYWRkcmVzczsNCj4gICAgICAgICAg
ICAgICAgICAgICAgICAgYnJlYWs7DQo+ICAgICAgICAgICAgICAgICBjYXNlIE9wdF9uY29ubmVj
dDoNCg0KT3B0X25jb25uZWN0IG5lZWRzIHRoaXMgY29udmVyc2lvbiwgdG9vOg0KDQpmcy9uZnMv
ZnNfY29udGV4dC5jOiBJbiBmdW5jdGlvbiDigJhuZnNfZnNfY29udGV4dF9wYXJzZV9vcHRpb27i
gJk6DQpmcy9uZnMvZnNfY29udGV4dC5jOjgzMzo0OiBlcnJvcjog4oCYbW504oCZIHVuZGVjbGFy
ZWQgKGZpcnN0IHVzZSBpbiB0aGlzDQpmdW5jdGlvbik7IGRpZCB5b3UgbWVhbiDigJhpbnTigJk/
DQogIDgzMyB8ICAgIG1udC0+bmZzX3NlcnZlci5uY29ubmVjdCA9IG9wdGlvbjsNCiAgICAgIHwg
ICAgXn5+DQogICAgICB8ICAgIGludA0KDQpBbm5hDQo+IEBAIC04NjAsMTQgKzg1OSwxNCBAQCBp
bnQgbmZzX3BhcnNlX21vdW50X29wdGlvbnMoY2hhciAqcmF3LCBzdHJ1Y3QNCj4gbmZzX3BhcnNl
ZF9tb3VudF9kYXRhICptbnQpDQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGtmcmVlKHN0cmlu
Zyk7DQo+ICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAodG9rZW4pIHsNCj4gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE9wdF9sb29rdXBjYWNoZV9hbGw6DQo+IC0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtbnQtPmZsYWdzICY9DQo+IH4o
TkZTX01PVU5UX0xPT0tVUF9DQUNIRV9OT05FR3xORlNfTU9VTlRfTE9PS1VQX0NBQ0hFX05PTkUp
Ow0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LT5mbGFncyAm
PQ0KPiB+KE5GU19NT1VOVF9MT09LVVBfQ0FDSEVfTk9ORUd8TkZTX01PVU5UX0xPT0tVUF9DQUNI
RV9OT05FKTsNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFr
Ow0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgT3B0X2xvb2t1cGNhY2hl
X3Bvc2l0aXZlOg0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW50
LT5mbGFncyAmPQ0KPiB+TkZTX01PVU5UX0xPT0tVUF9DQUNIRV9OT05FOw0KPiAtICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW50LT5mbGFncyB8PQ0KPiBORlNfTU9VTlRf
TE9PS1VQX0NBQ0hFX05PTkVHOw0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgY3R4LT5mbGFncyAmPQ0KPiB+TkZTX01PVU5UX0xPT0tVUF9DQUNIRV9OT05FOw0KPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LT5mbGFncyB8PQ0KPiBO
RlNfTU9VTlRfTE9PS1VQX0NBQ0hFX05PTkVHOw0KPiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgYnJlYWs7DQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Y2FzZSBPcHRfbG9va3VwY2FjaGVfbm9uZToNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIG1udC0+ZmxhZ3MgfD0NCj4gTkZTX01PVU5UX0xPT0tVUF9DQUNIRV9OT05F
R3xORlNfTU9VTlRfTE9PS1VQX0NBQ0hFX05PTkU7DQo+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBjdHgtPmZsYWdzIHw9DQo+IE5GU19NT1VOVF9MT09LVVBfQ0FDSEVf
Tk9ORUd8TkZTX01PVU5UX0xPT0tVUF9DQUNIRV9OT05FOw0KPiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZGVmYXVsdDoNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGRmcHJpbnRrKE1PVU5ULA0KPiAiTkZTOiAgIGludmFsaWQgIg0KPiBAQCAtODc2LDkgKzg3NSw5
IEBAIGludCBuZnNfcGFyc2VfbW91bnRfb3B0aW9ucyhjaGFyICpyYXcsIHN0cnVjdA0KPiBuZnNf
cGFyc2VkX21vdW50X2RhdGEgKm1udCkNCj4gICAgICAgICAgICAgICAgICAgICAgICAgfTsNCj4g
ICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+ICAgICAgICAgICAgICAgICBjYXNlIE9w
dF9mc2NhY2hlX3VuaXE6DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIGlmIChuZnNfZ2V0X29w
dGlvbl9zdHIoYXJncywgJm1udC0NCj4gPmZzY2FjaGVfdW5pcSkpDQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgIGlmIChuZnNfZ2V0X29wdGlvbl9zdHIoYXJncywgJmN0eC0NCj4gPmZzY2FjaGVf
dW5pcSkpDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ290byBvdXRfbm9tZW07
DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIG1udC0+b3B0aW9ucyB8PSBORlNfT1BUSU9OX0ZT
Q0FDSEU7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGN0eC0+b3B0aW9ucyB8PSBORlNfT1BU
SU9OX0ZTQ0FDSEU7DQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiAgICAgICAg
ICAgICAgICAgY2FzZSBPcHRfbG9jYWxfbG9jazoNCj4gICAgICAgICAgICAgICAgICAgICAgICAg
c3RyaW5nID0gbWF0Y2hfc3RyZHVwKGFyZ3MpOw0KPiBAQCAtODg5LDE3ICs4ODgsMTcgQEAgaW50
IG5mc19wYXJzZV9tb3VudF9vcHRpb25zKGNoYXIgKnJhdywgc3RydWN0DQo+IG5mc19wYXJzZWRf
bW91bnRfZGF0YSAqbW50KQ0KPiAgICAgICAgICAgICAgICAgICAgICAgICBrZnJlZShzdHJpbmcp
Ow0KPiAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHRva2VuKSB7DQo+ICAgICAgICAg
ICAgICAgICAgICAgICAgIGNhc2UgT3B0X2xvY2FsX2xvY2tfYWxsOg0KPiAtICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIG1udC0+ZmxhZ3MgfD0gKE5GU19NT1VOVF9MT0NBTF9GTE9DSw0K
PiB8DQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LT5mbGFncyB8PSAoTkZT
X01PVU5UX0xPQ0FMX0ZMT0NLDQo+IHwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBORlNfTU9VTlRfTE9DQUxfRkNOVEwpDQo+IDsNCj4gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gICAgICAgICAgICAgICAgICAgICAgICAg
Y2FzZSBPcHRfbG9jYWxfbG9ja19mbG9jazoNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBtbnQtPmZsYWdzIHw9IE5GU19NT1VOVF9MT0NBTF9GTE9DSzsNCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBjdHgtPmZsYWdzIHw9IE5GU19NT1VOVF9MT0NBTF9GTE9DSzsN
Cj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gICAgICAgICAgICAg
ICAgICAgICAgICAgY2FzZSBPcHRfbG9jYWxfbG9ja19wb3NpeDoNCj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBtbnQtPmZsYWdzIHw9IE5GU19NT1VOVF9MT0NBTF9GQ05UTDsNCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgtPmZsYWdzIHw9IE5GU19NT1VOVF9M
T0NBTF9GQ05UTDsNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4g
ICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBPcHRfbG9jYWxfbG9ja19ub25lOg0KPiAtICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1udC0+ZmxhZ3MgJj0gfihORlNfTU9VTlRfTE9D
QUxfRkxPQ0sNCj4gfA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC0+Zmxh
Z3MgJj0gfihORlNfTU9VTlRfTE9DQUxfRkxPQ0sNCj4gfA0KPiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBORlNfTU9VTlRfTE9DQUxfRkNOVEwNCj4gKTsN
Cj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gICAgICAgICAgICAg
ICAgICAgICAgICAgZGVmYXVsdDoNCj4gQEAgLTkzMiwxMSArOTMxLDExIEBAIGludCBuZnNfcGFy
c2VfbW91bnRfb3B0aW9ucyhjaGFyICpyYXcsIHN0cnVjdA0KPiBuZnNfcGFyc2VkX21vdW50X2Rh
dGEgKm1udCkNCj4gICAgICAgICBpZiAoIXNsb3BweSAmJiBpbnZhbGlkX29wdGlvbikNCj4gICAg
ICAgICAgICAgICAgIHJldHVybiAwOw0KPiANCj4gLSAgICAgICBpZiAobW50LT5taW5vcnZlcnNp
b24gJiYgbW50LT52ZXJzaW9uICE9IDQpDQo+ICsgICAgICAgaWYgKGN0eC0+bWlub3J2ZXJzaW9u
ICYmIGN0eC0+dmVyc2lvbiAhPSA0KQ0KPiAgICAgICAgICAgICAgICAgZ290byBvdXRfbWlub3J2
ZXJzaW9uX21pc21hdGNoOw0KPiANCj4gLSAgICAgICBpZiAobW50LT5vcHRpb25zICYgTkZTX09Q
VElPTl9NSUdSQVRJT04gJiYNCj4gLSAgICAgICAgICAgKG1udC0+dmVyc2lvbiAhPSA0IHx8IG1u
dC0+bWlub3J2ZXJzaW9uICE9IDApKQ0KPiArICAgICAgIGlmIChjdHgtPm9wdGlvbnMgJiBORlNf
T1BUSU9OX01JR1JBVElPTiAmJg0KPiArICAgICAgICAgICAoY3R4LT52ZXJzaW9uICE9IDQgfHwg
Y3R4LT5taW5vcnZlcnNpb24gIT0gMCkpDQo+ICAgICAgICAgICAgICAgICBnb3RvIG91dF9taWdy
YXRpb25fbWlzdXNlOw0KPiANCj4gICAgICAgICAvKg0KPiBAQCAtOTQ0LDE1ICs5NDMsMTUgQEAg
aW50IG5mc19wYXJzZV9tb3VudF9vcHRpb25zKGNoYXIgKnJhdywgc3RydWN0DQo+IG5mc19wYXJz
ZWRfbW91bnRfZGF0YSAqbW50KQ0KPiAgICAgICAgICAqIGZhbWlsaWVzIGluIHRoZSBhZGRyPS9t
b3VudGFkZHI9IG9wdGlvbnMuDQo+ICAgICAgICAgICovDQo+ICAgICAgICAgaWYgKHByb3RvZmFt
aWx5ICE9IEFGX1VOU1BFQyAmJg0KPiAtICAgICAgICAgICBwcm90b2ZhbWlseSAhPSBtbnQtPm5m
c19zZXJ2ZXIuYWRkcmVzcy5zc19mYW1pbHkpDQo+ICsgICAgICAgICAgIHByb3RvZmFtaWx5ICE9
IGN0eC0+bmZzX3NlcnZlci5hZGRyZXNzLnNzX2ZhbWlseSkNCj4gICAgICAgICAgICAgICAgIGdv
dG8gb3V0X3Byb3RvX21pc21hdGNoOw0KPiANCj4gICAgICAgICBpZiAobW91bnRmYW1pbHkgIT0g
QUZfVU5TUEVDKSB7DQo+IC0gICAgICAgICAgICAgICBpZiAobW50LT5tb3VudF9zZXJ2ZXIuYWRk
cmxlbikgew0KPiAtICAgICAgICAgICAgICAgICAgICAgICBpZiAobW91bnRmYW1pbHkgIT0gbW50
LQ0KPiA+bW91bnRfc2VydmVyLmFkZHJlc3Muc3NfZmFtaWx5KQ0KPiArICAgICAgICAgICAgICAg
aWYgKGN0eC0+bW91bnRfc2VydmVyLmFkZHJsZW4pIHsNCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgaWYgKG1vdW50ZmFtaWx5ICE9IGN0eC0NCj4gPm1vdW50X3NlcnZlci5hZGRyZXNzLnNzX2Zh
bWlseSkNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIG91dF9tb3VudHBy
b3RvX21pc21hdGNoOw0KPiAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCj4gLSAgICAgICAgICAg
ICAgICAgICAgICAgaWYgKG1vdW50ZmFtaWx5ICE9IG1udC0NCj4gPm5mc19zZXJ2ZXIuYWRkcmVz
cy5zc19mYW1pbHkpDQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGlmIChtb3VudGZhbWlseSAh
PSBjdHgtDQo+ID5uZnNfc2VydmVyLmFkZHJlc3Muc3NfZmFtaWx5KQ0KPiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0X21vdW50cHJvdG9fbWlzbWF0Y2g7DQo+ICAgICAg
ICAgICAgICAgICB9DQo+ICAgICAgICAgfQ0KPiBAQCAtOTc0LDcgKzk3Myw3IEBAIGludCBuZnNf
cGFyc2VfbW91bnRfb3B0aW9ucyhjaGFyICpyYXcsIHN0cnVjdA0KPiBuZnNfcGFyc2VkX21vdW50
X2RhdGEgKm1udCkNCj4gICAgICAgICByZXR1cm4gMDsNCj4gIG91dF9taW5vcnZlcnNpb25fbWlz
bWF0Y2g6DQo+ICAgICAgICAgcHJpbnRrKEtFUk5fSU5GTyAiTkZTOiBtb3VudCBvcHRpb24gdmVy
cz0ldSBkb2VzIG5vdCBzdXBwb3J0DQo+ICINCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICJt
aW5vcnZlcnNpb249JXVcbiIsIG1udC0+dmVyc2lvbiwgbW50LQ0KPiA+bWlub3J2ZXJzaW9uKTsN
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICJtaW5vcnZlcnNpb249JXVcbiIsIGN0eC0+dmVy
c2lvbiwgY3R4LQ0KPiA+bWlub3J2ZXJzaW9uKTsNCj4gICAgICAgICByZXR1cm4gMDsNCj4gIG91
dF9taWdyYXRpb25fbWlzdXNlOg0KPiAgICAgICAgIHByaW50ayhLRVJOX0lORk8NCj4gQEAgLTEw
ODIsMTggKzEwODEsMTggQEAgc3RhdGljIGludCBuZnNfcGFyc2VfZGV2bmFtZShjb25zdCBjaGFy
DQo+ICpkZXZfbmFtZSwNCj4gICAqICAgbW91bnRwcm90bz10Y3AgYWZ0ZXIgbW91bnRwcm90bz11
ZHAsIGFuZCBzbyBvbg0KPiAgICovDQo+ICBzdGF0aWMgaW50IG5mczIzX3ZhbGlkYXRlX21vdW50
X2RhdGEodm9pZCAqb3B0aW9ucywNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHN0cnVjdCBuZnNfcGFyc2VkX21vdW50X2RhdGENCj4gKmFyZ3MsDQo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgbmZzX2ZzX2NvbnRleHQgKmN0eCwNCj4g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBuZnNfZmggKm1udGZo
LA0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqZGV2
X25hbWUpDQo+ICB7DQo+ICAgICAgICAgc3RydWN0IG5mc19tb3VudF9kYXRhICpkYXRhID0gKHN0
cnVjdCBuZnNfbW91bnRfZGF0YQ0KPiAqKW9wdGlvbnM7DQo+IC0gICAgICAgc3RydWN0IHNvY2th
ZGRyICpzYXAgPSAoc3RydWN0IHNvY2thZGRyICopJmFyZ3MtDQo+ID5uZnNfc2VydmVyLmFkZHJl
c3M7DQo+ICsgICAgICAgc3RydWN0IHNvY2thZGRyICpzYXAgPSAoc3RydWN0IHNvY2thZGRyICop
JmN0eC0NCj4gPm5mc19zZXJ2ZXIuYWRkcmVzczsNCj4gICAgICAgICBpbnQgZXh0cmFfZmxhZ3Mg
PSBORlNfTU9VTlRfTEVHQUNZX0lOVEVSRkFDRTsNCj4gDQo+ICAgICAgICAgaWYgKGRhdGEgPT0g
TlVMTCkNCj4gICAgICAgICAgICAgICAgIGdvdG8gb3V0X25vX2RhdGE7DQo+IA0KPiAtICAgICAg
IGFyZ3MtPnZlcnNpb24gPSBORlNfREVGQVVMVF9WRVJTSU9OOw0KPiArICAgICAgIGN0eC0+dmVy
c2lvbiA9IE5GU19ERUZBVUxUX1ZFUlNJT047DQo+ICAgICAgICAgc3dpdGNoIChkYXRhLT52ZXJz
aW9uKSB7DQo+ICAgICAgICAgY2FzZSAxOg0KPiAgICAgICAgICAgICAgICAgZGF0YS0+bmFtbGVu
ID0gMDsgLyogZmFsbCB0aHJvdWdoICovDQo+IEBAIC0xMTE5LDEwICsxMTE4LDEwIEBAIHN0YXRp
YyBpbnQgbmZzMjNfdmFsaWRhdGVfbW91bnRfZGF0YSh2b2lkDQo+ICpvcHRpb25zLA0KPiAgICAg
ICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS0+cm9vdC5zaXplID4gTkZTM19GSFNJWkUgfHwg
ZGF0YS0NCj4gPnJvb3Quc2l6ZSA9PSAwKQ0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGdvdG8gb3V0X2ludmFsaWRfZmg7DQo+ICAgICAgICAgICAgICAgICAgICAgICAgIG1udGZo
LT5zaXplID0gZGF0YS0+cm9vdC5zaXplOw0KPiAtICAgICAgICAgICAgICAgICAgICAgICBhcmdz
LT52ZXJzaW9uID0gMzsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgY3R4LT52ZXJzaW9uID0g
MzsNCj4gICAgICAgICAgICAgICAgIH0gZWxzZSB7DQo+ICAgICAgICAgICAgICAgICAgICAgICAg
IG1udGZoLT5zaXplID0gTkZTMl9GSFNJWkU7DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIGFy
Z3MtPnZlcnNpb24gPSAyOw0KPiArICAgICAgICAgICAgICAgICAgICAgICBjdHgtPnZlcnNpb24g
PSAyOw0KPiAgICAgICAgICAgICAgICAgfQ0KPiANCj4gDQo+IEBAIC0xMTMyLDQ3ICsxMTMxLDQ3
IEBAIHN0YXRpYyBpbnQgbmZzMjNfdmFsaWRhdGVfbW91bnRfZGF0YSh2b2lkDQo+ICpvcHRpb25z
LA0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZW9mKG1udGZoLT5kYXRhKSAt
IG1udGZoLT5zaXplKTsNCj4gDQo+ICAgICAgICAgICAgICAgICAvKg0KPiAtICAgICAgICAgICAg
ICAgICogVHJhbnNsYXRlIHRvIG5mc19wYXJzZWRfbW91bnRfZGF0YSwgd2hpY2gNCj4gbmZzX2Zp
bGxfc3VwZXINCj4gKyAgICAgICAgICAgICAgICAqIFRyYW5zbGF0ZSB0byBuZnNfZnNfY29udGV4
dCwgd2hpY2ggbmZzX2ZpbGxfc3VwZXINCj4gICAgICAgICAgICAgICAgICAqIGNhbiBkZWFsIHdp
dGguDQo+ICAgICAgICAgICAgICAgICAgKi8NCj4gLSAgICAgICAgICAgICAgIGFyZ3MtPmZsYWdz
ICAgICAgICAgICAgID0gZGF0YS0+ZmxhZ3MgJg0KPiBORlNfTU9VTlRfRkxBR01BU0s7DQo+IC0g
ICAgICAgICAgICAgICBhcmdzLT5mbGFncyAgICAgICAgICAgICB8PSBleHRyYV9mbGFnczsNCj4g
LSAgICAgICAgICAgICAgIGFyZ3MtPnJzaXplICAgICAgICAgICAgID0gZGF0YS0+cnNpemU7DQo+
IC0gICAgICAgICAgICAgICBhcmdzLT53c2l6ZSAgICAgICAgICAgICA9IGRhdGEtPndzaXplOw0K
PiAtICAgICAgICAgICAgICAgYXJncy0+dGltZW8gICAgICAgICAgICAgPSBkYXRhLT50aW1lbzsN
Cj4gLSAgICAgICAgICAgICAgIGFyZ3MtPnJldHJhbnMgICAgICAgICAgID0gZGF0YS0+cmV0cmFu
czsNCj4gLSAgICAgICAgICAgICAgIGFyZ3MtPmFjcmVnbWluICAgICAgICAgID0gZGF0YS0+YWNy
ZWdtaW47DQo+IC0gICAgICAgICAgICAgICBhcmdzLT5hY3JlZ21heCAgICAgICAgICA9IGRhdGEt
PmFjcmVnbWF4Ow0KPiAtICAgICAgICAgICAgICAgYXJncy0+YWNkaXJtaW4gICAgICAgICAgPSBk
YXRhLT5hY2Rpcm1pbjsNCj4gLSAgICAgICAgICAgICAgIGFyZ3MtPmFjZGlybWF4ICAgICAgICAg
ID0gZGF0YS0+YWNkaXJtYXg7DQo+IC0gICAgICAgICAgICAgICBhcmdzLT5uZWVkX21vdW50ICAg
ICAgICA9IGZhbHNlOw0KPiArICAgICAgICAgICAgICAgY3R4LT5mbGFncyAgICAgID0gZGF0YS0+
ZmxhZ3MgJiBORlNfTU9VTlRfRkxBR01BU0s7DQo+ICsgICAgICAgICAgICAgICBjdHgtPmZsYWdz
ICAgICAgfD0gZXh0cmFfZmxhZ3M7DQo+ICsgICAgICAgICAgICAgICBjdHgtPnJzaXplICAgICAg
PSBkYXRhLT5yc2l6ZTsNCj4gKyAgICAgICAgICAgICAgIGN0eC0+d3NpemUgICAgICA9IGRhdGEt
PndzaXplOw0KPiArICAgICAgICAgICAgICAgY3R4LT50aW1lbyAgICAgID0gZGF0YS0+dGltZW87
DQo+ICsgICAgICAgICAgICAgICBjdHgtPnJldHJhbnMgICAgPSBkYXRhLT5yZXRyYW5zOw0KPiAr
ICAgICAgICAgICAgICAgY3R4LT5hY3JlZ21pbiAgID0gZGF0YS0+YWNyZWdtaW47DQo+ICsgICAg
ICAgICAgICAgICBjdHgtPmFjcmVnbWF4ICAgPSBkYXRhLT5hY3JlZ21heDsNCj4gKyAgICAgICAg
ICAgICAgIGN0eC0+YWNkaXJtaW4gICA9IGRhdGEtPmFjZGlybWluOw0KPiArICAgICAgICAgICAg
ICAgY3R4LT5hY2Rpcm1heCAgID0gZGF0YS0+YWNkaXJtYXg7DQo+ICsgICAgICAgICAgICAgICBj
dHgtPm5lZWRfbW91bnQgPSBmYWxzZTsNCj4gDQo+ICAgICAgICAgICAgICAgICBtZW1jcHkoc2Fw
LCAmZGF0YS0+YWRkciwgc2l6ZW9mKGRhdGEtPmFkZHIpKTsNCj4gLSAgICAgICAgICAgICAgIGFy
Z3MtPm5mc19zZXJ2ZXIuYWRkcmxlbiA9IHNpemVvZihkYXRhLT5hZGRyKTsNCj4gLSAgICAgICAg
ICAgICAgIGFyZ3MtPm5mc19zZXJ2ZXIucG9ydCA9IG50b2hzKGRhdGEtPmFkZHIuc2luX3BvcnQp
Ow0KPiArICAgICAgICAgICAgICAgY3R4LT5uZnNfc2VydmVyLmFkZHJsZW4gPSBzaXplb2YoZGF0
YS0+YWRkcik7DQo+ICsgICAgICAgICAgICAgICBjdHgtPm5mc19zZXJ2ZXIucG9ydCA9IG50b2hz
KGRhdGEtPmFkZHIuc2luX3BvcnQpOw0KPiAgICAgICAgICAgICAgICAgaWYgKHNhcC0+c2FfZmFt
aWx5ICE9IEFGX0lORVQgfHwNCj4gICAgICAgICAgICAgICAgICAgICAhbmZzX3ZlcmlmeV9zZXJ2
ZXJfYWRkcmVzcyhzYXApKQ0KPiAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIG91dF9ub19h
ZGRyZXNzOw0KPiANCj4gICAgICAgICAgICAgICAgIGlmICghKGRhdGEtPmZsYWdzICYgTkZTX01P
VU5UX1RDUCkpDQo+IC0gICAgICAgICAgICAgICAgICAgICAgIGFyZ3MtPm5mc19zZXJ2ZXIucHJv
dG9jb2wgPQ0KPiBYUFJUX1RSQU5TUE9SVF9VRFA7DQo+ICsgICAgICAgICAgICAgICAgICAgICAg
IGN0eC0+bmZzX3NlcnZlci5wcm90b2NvbCA9DQo+IFhQUlRfVFJBTlNQT1JUX1VEUDsNCj4gICAg
ICAgICAgICAgICAgIC8qIE4uQi4gY2FsbGVyIHdpbGwgZnJlZSBuZnNfc2VydmVyLmhvc3RuYW1l
IGluIGFsbA0KPiBjYXNlcyAqLw0KPiAtICAgICAgICAgICAgICAgYXJncy0+bmZzX3NlcnZlci5o
b3N0bmFtZSA9IGtzdHJkdXAoZGF0YS0+aG9zdG5hbWUsDQo+IEdGUF9LRVJORUwpOw0KPiAtICAg
ICAgICAgICAgICAgYXJncy0+bmFtbGVuICAgICAgICAgICAgPSBkYXRhLT5uYW1sZW47DQo+IC0g
ICAgICAgICAgICAgICBhcmdzLT5ic2l6ZSAgICAgICAgICAgICA9IGRhdGEtPmJzaXplOw0KPiAr
ICAgICAgICAgICAgICAgY3R4LT5uZnNfc2VydmVyLmhvc3RuYW1lID0ga3N0cmR1cChkYXRhLT5o
b3N0bmFtZSwNCj4gR0ZQX0tFUk5FTCk7DQo+ICsgICAgICAgICAgICAgICBjdHgtPm5hbWxlbiAg
ICAgICAgICAgICA9IGRhdGEtPm5hbWxlbjsNCj4gKyAgICAgICAgICAgICAgIGN0eC0+YnNpemUg
ICAgICAgICAgICAgID0gZGF0YS0+YnNpemU7DQo+IA0KPiAgICAgICAgICAgICAgICAgaWYgKGRh
dGEtPmZsYWdzICYgTkZTX01PVU5UX1NFQ0ZMQVZPVVIpDQo+IC0gICAgICAgICAgICAgICAgICAg
ICAgIGFyZ3MtPnNlbGVjdGVkX2ZsYXZvciA9IGRhdGEtPnBzZXVkb2ZsYXZvcjsNCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgY3R4LT5zZWxlY3RlZF9mbGF2b3IgPSBkYXRhLT5wc2V1ZG9mbGF2
b3I7DQo+ICAgICAgICAgICAgICAgICBlbHNlDQo+IC0gICAgICAgICAgICAgICAgICAgICAgIGFy
Z3MtPnNlbGVjdGVkX2ZsYXZvciA9IFJQQ19BVVRIX1VOSVg7DQo+IC0gICAgICAgICAgICAgICBp
ZiAoIWFyZ3MtPm5mc19zZXJ2ZXIuaG9zdG5hbWUpDQo+ICsgICAgICAgICAgICAgICAgICAgICAg
IGN0eC0+c2VsZWN0ZWRfZmxhdm9yID0gUlBDX0FVVEhfVU5JWDsNCj4gKyAgICAgICAgICAgICAg
IGlmICghY3R4LT5uZnNfc2VydmVyLmhvc3RuYW1lKQ0KPiAgICAgICAgICAgICAgICAgICAgICAg
ICBnb3RvIG91dF9ub21lbTsNCj4gDQo+ICAgICAgICAgICAgICAgICBpZiAoIShkYXRhLT5mbGFn
cyAmIE5GU19NT1VOVF9OT05MTSkpDQo+IC0gICAgICAgICAgICAgICAgICAgICAgIGFyZ3MtPmZs
YWdzICY9IH4oTkZTX01PVU5UX0xPQ0FMX0ZMT0NLfA0KPiArICAgICAgICAgICAgICAgICAgICAg
ICBjdHgtPmZsYWdzICY9IH4oTkZTX01PVU5UX0xPQ0FMX0ZMT0NLfA0KPiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5GU19NT1VOVF9MT0NBTF9GQ05UTCk7DQo+ICAg
ICAgICAgICAgICAgICBlbHNlDQo+IC0gICAgICAgICAgICAgICAgICAgICAgIGFyZ3MtPmZsYWdz
IHw9IChORlNfTU9VTlRfTE9DQUxfRkxPQ0t8DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGN0
eC0+ZmxhZ3MgfD0gKE5GU19NT1VOVF9MT0NBTF9GTE9DS3wNCj4gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIE5GU19NT1VOVF9MT0NBTF9GQ05UTCk7DQo+ICAgICAgICAg
ICAgICAgICAvKg0KPiAgICAgICAgICAgICAgICAgICogVGhlIGxlZ2FjeSB2ZXJzaW9uIDYgYmlu
YXJ5IG1vdW50IGRhdGEgZnJvbQ0KPiB1c2Vyc3BhY2UgaGFzIGENCj4gQEAgLTExODcsNyArMTE4
Niw3IEBAIHN0YXRpYyBpbnQgbmZzMjNfdmFsaWRhdGVfbW91bnRfZGF0YSh2b2lkDQo+ICpvcHRp
b25zLA0KPiAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgcmM7DQo+ICAgICAgICAgICAgICAg
ICAgICAgICAgIGRhdGEtPmNvbnRleHRbTkZTX01BWF9DT05URVhUX0xFTl0gPSAnXDAnOw0KPiAg
ICAgICAgICAgICAgICAgICAgICAgICByYyA9IHNlY3VyaXR5X2FkZF9tbnRfb3B0KCJjb250ZXh0
IiwgZGF0YS0NCj4gPmNvbnRleHQsDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdHJsZW4oZGF0YS0+Y29udGV4dCksICZhcmdzLQ0KPiA+bHNtX29wdHMpOw0KPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RybGVuKGRhdGEtPmNvbnRl
eHQpLCBjdHgtDQo+ID5sc21fb3B0cyk7DQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChy
YykNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmM7DQo+ICAjZWxz
ZQ0KPiBAQCAtMTIyOSwxMCArMTIyOCw5IEBAIHN0YXRpYyBpbnQgbmZzMjNfdmFsaWRhdGVfbW91
bnRfZGF0YSh2b2lkDQo+ICpvcHRpb25zLA0KPiAgfQ0KPiANCj4gICNpZiBJU19FTkFCTEVEKENP
TkZJR19ORlNfVjQpDQo+IC0NCj4gLXN0YXRpYyB2b2lkIG5mczRfdmFsaWRhdGVfbW91bnRfZmxh
Z3Moc3RydWN0IG5mc19wYXJzZWRfbW91bnRfZGF0YQ0KPiAqYXJncykNCj4gK3N0YXRpYyB2b2lk
IG5mczRfdmFsaWRhdGVfbW91bnRfZmxhZ3Moc3RydWN0IG5mc19mc19jb250ZXh0ICpjdHgpDQo+
ICB7DQo+IC0gICAgICAgYXJncy0+ZmxhZ3MgJj0NCj4gfihORlNfTU9VTlRfTk9OTE18TkZTX01P
VU5UX05PQUNMfE5GU19NT1VOVF9WRVIzfA0KPiArICAgICAgIGN0eC0+ZmxhZ3MgJj0NCj4gfihO
RlNfTU9VTlRfTk9OTE18TkZTX01PVU5UX05PQUNMfE5GU19NT1VOVF9WRVIzfA0KPiAgICAgICAg
ICAgICAgICAgICAgICAgICAgTkZTX01PVU5UX0xPQ0FMX0ZMT0NLfE5GU19NT1VOVF9MT0NBTF9G
Q05UTCkNCj4gOw0KPiAgfQ0KPiANCj4gQEAgLTEyNDAsMzAgKzEyMzgsMzAgQEAgc3RhdGljIHZv
aWQgbmZzNF92YWxpZGF0ZV9tb3VudF9mbGFncyhzdHJ1Y3QNCj4gbmZzX3BhcnNlZF9tb3VudF9k
YXRhICphcmdzKQ0KPiAgICogVmFsaWRhdGUgTkZTdjQgbW91bnQgb3B0aW9ucw0KPiAgICovDQo+
ICBzdGF0aWMgaW50IG5mczRfdmFsaWRhdGVfbW91bnRfZGF0YSh2b2lkICpvcHRpb25zLA0KPiAt
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgbmZzX3BhcnNlZF9tb3Vu
dF9kYXRhDQo+ICphcmdzLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBz
dHJ1Y3QgbmZzX2ZzX2NvbnRleHQgKmN0eCwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgY29uc3QgY2hhciAqZGV2X25hbWUpDQo+ICB7DQo+IC0gICAgICAgc3RydWN0IHNv
Y2thZGRyICpzYXAgPSAoc3RydWN0IHNvY2thZGRyICopJmFyZ3MtDQo+ID5uZnNfc2VydmVyLmFk
ZHJlc3M7DQo+ICsgICAgICAgc3RydWN0IHNvY2thZGRyICpzYXAgPSAoc3RydWN0IHNvY2thZGRy
ICopJmN0eC0NCj4gPm5mc19zZXJ2ZXIuYWRkcmVzczsNCj4gICAgICAgICBzdHJ1Y3QgbmZzNF9t
b3VudF9kYXRhICpkYXRhID0gKHN0cnVjdCBuZnM0X21vdW50X2RhdGENCj4gKilvcHRpb25zOw0K
PiAgICAgICAgIGNoYXIgKmM7DQo+IA0KPiAgICAgICAgIGlmIChkYXRhID09IE5VTEwpDQo+ICAg
ICAgICAgICAgICAgICBnb3RvIG91dF9ub19kYXRhOw0KPiANCj4gLSAgICAgICBhcmdzLT52ZXJz
aW9uID0gNDsNCj4gKyAgICAgICBjdHgtPnZlcnNpb24gPSA0Ow0KPiANCj4gICAgICAgICBzd2l0
Y2ggKGRhdGEtPnZlcnNpb24pIHsNCj4gICAgICAgICBjYXNlIDE6DQo+IC0gICAgICAgICAgICAg
ICBpZiAoZGF0YS0+aG9zdF9hZGRybGVuID4gc2l6ZW9mKGFyZ3MtDQo+ID5uZnNfc2VydmVyLmFk
ZHJlc3MpKQ0KPiArICAgICAgICAgICAgICAgaWYgKGRhdGEtPmhvc3RfYWRkcmxlbiA+IHNpemVv
ZihjdHgtDQo+ID5uZnNfc2VydmVyLmFkZHJlc3MpKQ0KPiAgICAgICAgICAgICAgICAgICAgICAg
ICBnb3RvIG91dF9ub19hZGRyZXNzOw0KPiAgICAgICAgICAgICAgICAgaWYgKGRhdGEtPmhvc3Rf
YWRkcmxlbiA9PSAwKQ0KPiAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIG91dF9ub19hZGRy
ZXNzOw0KPiAtICAgICAgICAgICAgICAgYXJncy0+bmZzX3NlcnZlci5hZGRybGVuID0gZGF0YS0+
aG9zdF9hZGRybGVuOw0KPiArICAgICAgICAgICAgICAgY3R4LT5uZnNfc2VydmVyLmFkZHJsZW4g
PSBkYXRhLT5ob3N0X2FkZHJsZW47DQo+ICAgICAgICAgICAgICAgICBpZiAoY29weV9mcm9tX3Vz
ZXIoc2FwLCBkYXRhLT5ob3N0X2FkZHIsIGRhdGEtDQo+ID5ob3N0X2FkZHJsZW4pKQ0KPiAgICAg
ICAgICAgICAgICAgICAgICAgICByZXR1cm4gLUVGQVVMVDsNCj4gICAgICAgICAgICAgICAgIGlm
ICghbmZzX3ZlcmlmeV9zZXJ2ZXJfYWRkcmVzcyhzYXApKQ0KPiAgICAgICAgICAgICAgICAgICAg
ICAgICBnb3RvIG91dF9ub19hZGRyZXNzOw0KPiAtICAgICAgICAgICAgICAgYXJncy0+bmZzX3Nl
cnZlci5wb3J0ID0gbnRvaHMoKChzdHJ1Y3Qgc29ja2FkZHJfaW4NCj4gKilzYXApLT5zaW5fcG9y
dCk7DQo+ICsgICAgICAgICAgICAgICBjdHgtPm5mc19zZXJ2ZXIucG9ydCA9IG50b2hzKCgoc3Ry
dWN0IHNvY2thZGRyX2luDQo+ICopc2FwKS0+c2luX3BvcnQpOw0KPiANCj4gICAgICAgICAgICAg
ICAgIGlmIChkYXRhLT5hdXRoX2ZsYXZvdXJsZW4pIHsNCj4gICAgICAgICAgICAgICAgICAgICAg
ICAgcnBjX2F1dGhmbGF2b3JfdCBwc2V1ZG9mbGF2b3I7DQo+IEBAIC0xMjczLDQzICsxMjcxLDQz
IEBAIHN0YXRpYyBpbnQgbmZzNF92YWxpZGF0ZV9tb3VudF9kYXRhKHZvaWQNCj4gKm9wdGlvbnMs
DQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLT5hdXRo
X2ZsYXZvdXJzLA0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
c2l6ZW9mKHBzZXVkb2ZsYXZvcikpKQ0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHJldHVybiAtRUZBVUxUOw0KPiAtICAgICAgICAgICAgICAgICAgICAgICBhcmdzLT5zZWxlY3Rl
ZF9mbGF2b3IgPSBwc2V1ZG9mbGF2b3I7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGN0eC0+
c2VsZWN0ZWRfZmxhdm9yID0gcHNldWRvZmxhdm9yOw0KPiAgICAgICAgICAgICAgICAgfSBlbHNl
DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIGFyZ3MtPnNlbGVjdGVkX2ZsYXZvciA9IFJQQ19B
VVRIX1VOSVg7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGN0eC0+c2VsZWN0ZWRfZmxhdm9y
ID0gUlBDX0FVVEhfVU5JWDsNCj4gDQo+ICAgICAgICAgICAgICAgICBjID0gc3RybmR1cF91c2Vy
KGRhdGEtPmhvc3RuYW1lLmRhdGEsDQo+IE5GUzRfTUFYTkFNTEVOKTsNCj4gICAgICAgICAgICAg
ICAgIGlmIChJU19FUlIoYykpDQo+ICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBQVFJf
RVJSKGMpOw0KPiAtICAgICAgICAgICAgICAgYXJncy0+bmZzX3NlcnZlci5ob3N0bmFtZSA9IGM7
DQo+ICsgICAgICAgICAgICAgICBjdHgtPm5mc19zZXJ2ZXIuaG9zdG5hbWUgPSBjOw0KPiANCj4g
ICAgICAgICAgICAgICAgIGMgPSBzdHJuZHVwX3VzZXIoZGF0YS0+bW50X3BhdGguZGF0YSwNCj4g
TkZTNF9NQVhQQVRITEVOKTsNCj4gICAgICAgICAgICAgICAgIGlmIChJU19FUlIoYykpDQo+ICAg
ICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBQVFJfRVJSKGMpOw0KPiAtICAgICAgICAgICAg
ICAgYXJncy0+bmZzX3NlcnZlci5leHBvcnRfcGF0aCA9IGM7DQo+ICsgICAgICAgICAgICAgICBj
dHgtPm5mc19zZXJ2ZXIuZXhwb3J0X3BhdGggPSBjOw0KPiAgICAgICAgICAgICAgICAgZGZwcmlu
dGsoTU9VTlQsICJORlM6IE1OVFBBVEg6ICclcydcbiIsIGMpOw0KPiANCj4gICAgICAgICAgICAg
ICAgIGMgPSBzdHJuZHVwX3VzZXIoZGF0YS0+Y2xpZW50X2FkZHIuZGF0YSwgMTYpOw0KPiAgICAg
ICAgICAgICAgICAgaWYgKElTX0VSUihjKSkNCj4gICAgICAgICAgICAgICAgICAgICAgICAgcmV0
dXJuIFBUUl9FUlIoYyk7DQo+IC0gICAgICAgICAgICAgICBhcmdzLT5jbGllbnRfYWRkcmVzcyA9
IGM7DQo+ICsgICAgICAgICAgICAgICBjdHgtPmNsaWVudF9hZGRyZXNzID0gYzsNCj4gDQo+ICAg
ICAgICAgICAgICAgICAvKg0KPiAtICAgICAgICAgICAgICAgICogVHJhbnNsYXRlIHRvIG5mc19w
YXJzZWRfbW91bnRfZGF0YSwgd2hpY2gNCj4gbmZzNF9maWxsX3N1cGVyDQo+ICsgICAgICAgICAg
ICAgICAgKiBUcmFuc2xhdGUgdG8gbmZzX2ZzX2NvbnRleHQsIHdoaWNoIG5mczRfZmlsbF9zdXBl
cg0KPiAgICAgICAgICAgICAgICAgICogY2FuIGRlYWwgd2l0aC4NCj4gICAgICAgICAgICAgICAg
ICAqLw0KPiANCj4gLSAgICAgICAgICAgICAgIGFyZ3MtPmZsYWdzICAgICA9IGRhdGEtPmZsYWdz
ICYgTkZTNF9NT1VOVF9GTEFHTUFTSzsNCj4gLSAgICAgICAgICAgICAgIGFyZ3MtPnJzaXplICAg
ICA9IGRhdGEtPnJzaXplOw0KPiAtICAgICAgICAgICAgICAgYXJncy0+d3NpemUgICAgID0gZGF0
YS0+d3NpemU7DQo+IC0gICAgICAgICAgICAgICBhcmdzLT50aW1lbyAgICAgPSBkYXRhLT50aW1l
bzsNCj4gLSAgICAgICAgICAgICAgIGFyZ3MtPnJldHJhbnMgICA9IGRhdGEtPnJldHJhbnM7DQo+
IC0gICAgICAgICAgICAgICBhcmdzLT5hY3JlZ21pbiAgPSBkYXRhLT5hY3JlZ21pbjsNCj4gLSAg
ICAgICAgICAgICAgIGFyZ3MtPmFjcmVnbWF4ICA9IGRhdGEtPmFjcmVnbWF4Ow0KPiAtICAgICAg
ICAgICAgICAgYXJncy0+YWNkaXJtaW4gID0gZGF0YS0+YWNkaXJtaW47DQo+IC0gICAgICAgICAg
ICAgICBhcmdzLT5hY2Rpcm1heCAgPSBkYXRhLT5hY2Rpcm1heDsNCj4gLSAgICAgICAgICAgICAg
IGFyZ3MtPm5mc19zZXJ2ZXIucHJvdG9jb2wgPSBkYXRhLT5wcm90bzsNCj4gLSAgICAgICAgICAg
ICAgIG5mc192YWxpZGF0ZV90cmFuc3BvcnRfcHJvdG9jb2woYXJncyk7DQo+IC0gICAgICAgICAg
ICAgICBpZiAoYXJncy0+bmZzX3NlcnZlci5wcm90b2NvbCA9PSBYUFJUX1RSQU5TUE9SVF9VRFAp
DQo+ICsgICAgICAgICAgICAgICBjdHgtPmZsYWdzICAgICAgPSBkYXRhLT5mbGFncyAmIE5GUzRf
TU9VTlRfRkxBR01BU0s7DQo+ICsgICAgICAgICAgICAgICBjdHgtPnJzaXplICAgICAgPSBkYXRh
LT5yc2l6ZTsNCj4gKyAgICAgICAgICAgICAgIGN0eC0+d3NpemUgICAgICA9IGRhdGEtPndzaXpl
Ow0KPiArICAgICAgICAgICAgICAgY3R4LT50aW1lbyAgICAgID0gZGF0YS0+dGltZW87DQo+ICsg
ICAgICAgICAgICAgICBjdHgtPnJldHJhbnMgICAgPSBkYXRhLT5yZXRyYW5zOw0KPiArICAgICAg
ICAgICAgICAgY3R4LT5hY3JlZ21pbiAgID0gZGF0YS0+YWNyZWdtaW47DQo+ICsgICAgICAgICAg
ICAgICBjdHgtPmFjcmVnbWF4ICAgPSBkYXRhLT5hY3JlZ21heDsNCj4gKyAgICAgICAgICAgICAg
IGN0eC0+YWNkaXJtaW4gICA9IGRhdGEtPmFjZGlybWluOw0KPiArICAgICAgICAgICAgICAgY3R4
LT5hY2Rpcm1heCAgID0gZGF0YS0+YWNkaXJtYXg7DQo+ICsgICAgICAgICAgICAgICBjdHgtPm5m
c19zZXJ2ZXIucHJvdG9jb2wgPSBkYXRhLT5wcm90bzsNCj4gKyAgICAgICAgICAgICAgIG5mc192
YWxpZGF0ZV90cmFuc3BvcnRfcHJvdG9jb2woY3R4KTsNCj4gKyAgICAgICAgICAgICAgIGlmIChj
dHgtPm5mc19zZXJ2ZXIucHJvdG9jb2wgPT0gWFBSVF9UUkFOU1BPUlRfVURQKQ0KPiAgICAgICAg
ICAgICAgICAgICAgICAgICBnb3RvIG91dF9pbnZhbGlkX3RyYW5zcG9ydF91ZHA7DQo+IA0KPiAg
ICAgICAgICAgICAgICAgYnJlYWs7DQo+IEBAIC0xMzM5LDY3ICsxMzM3LDY3IEBAIHN0YXRpYyBp
bnQgbmZzNF92YWxpZGF0ZV9tb3VudF9kYXRhKHZvaWQNCj4gKm9wdGlvbnMsDQo+IA0KPiAgaW50
IG5mc192YWxpZGF0ZV9tb3VudF9kYXRhKHN0cnVjdCBmaWxlX3N5c3RlbV90eXBlICpmc190eXBl
LA0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqb3B0aW9ucywNCj4gLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBuZnNfcGFyc2VkX21vdW50X2RhdGEgKmFyZ3Ms
DQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgbmZzX2ZzX2NvbnRleHQgKmN0
eCwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBuZnNfZmggKm1udGZoLA0K
PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqZGV2X25hbWUpDQo+ICB7
DQo+ICAgICAgICAgaWYgKGZzX3R5cGUgPT0gJm5mc19mc190eXBlKQ0KPiAtICAgICAgICAgICAg
ICAgcmV0dXJuIG5mczIzX3ZhbGlkYXRlX21vdW50X2RhdGEob3B0aW9ucywgYXJncywNCj4gbW50
ZmgsIGRldl9uYW1lKTsNCj4gLSAgICAgICByZXR1cm4gbmZzNF92YWxpZGF0ZV9tb3VudF9kYXRh
KG9wdGlvbnMsIGFyZ3MsIGRldl9uYW1lKTsNCj4gKyAgICAgICAgICAgICAgIHJldHVybiBuZnMy
M192YWxpZGF0ZV9tb3VudF9kYXRhKG9wdGlvbnMsIGN0eCwgbW50ZmgsDQo+IGRldl9uYW1lKTsN
Cj4gKyAgICAgICByZXR1cm4gbmZzNF92YWxpZGF0ZV9tb3VudF9kYXRhKG9wdGlvbnMsIGN0eCwg
ZGV2X25hbWUpOw0KPiAgfQ0KPiAgI2Vsc2UNCj4gIGludCBuZnNfdmFsaWRhdGVfbW91bnRfZGF0
YShzdHJ1Y3QgZmlsZV9zeXN0ZW1fdHlwZSAqZnNfdHlwZSwNCj4gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHZvaWQgKm9wdGlvbnMsDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICBz
dHJ1Y3QgbmZzX3BhcnNlZF9tb3VudF9kYXRhICphcmdzLA0KPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgc3RydWN0IG5mc19mc19jb250ZXh0ICpjdHgsDQo+ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3QgbmZzX2ZoICptbnRmaCwNCj4gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGNvbnN0IGNoYXIgKmRldl9uYW1lKQ0KPiAgew0KPiAtICAgICAgIHJldHVybiBuZnMy
M192YWxpZGF0ZV9tb3VudF9kYXRhKG9wdGlvbnMsIGFyZ3MsIG1udGZoLA0KPiBkZXZfbmFtZSk7
DQo+ICsgICAgICAgcmV0dXJuIG5mczIzX3ZhbGlkYXRlX21vdW50X2RhdGEob3B0aW9ucywgY3R4
LCBtbnRmaCwNCj4gZGV2X25hbWUpOw0KPiAgfQ0KPiAgI2VuZGlmDQo+IA0KPiAgaW50IG5mc192
YWxpZGF0ZV90ZXh0X21vdW50X2RhdGEodm9pZCAqb3B0aW9ucywNCj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IG5mc19wYXJzZWRfbW91bnRfZGF0YSAqYXJncywNCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IG5mc19mc19jb250ZXh0ICpj
dHgsDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmRldl9u
YW1lKQ0KPiAgew0KPiAgICAgICAgIGludCBwb3J0ID0gMDsNCj4gICAgICAgICBpbnQgbWF4X25h
bWVsZW4gPSBQQUdFX1NJWkU7DQo+ICAgICAgICAgaW50IG1heF9wYXRobGVuID0gTkZTX01BWFBB
VEhMRU47DQo+IC0gICAgICAgc3RydWN0IHNvY2thZGRyICpzYXAgPSAoc3RydWN0IHNvY2thZGRy
ICopJmFyZ3MtDQo+ID5uZnNfc2VydmVyLmFkZHJlc3M7DQo+ICsgICAgICAgc3RydWN0IHNvY2th
ZGRyICpzYXAgPSAoc3RydWN0IHNvY2thZGRyICopJmN0eC0NCj4gPm5mc19zZXJ2ZXIuYWRkcmVz
czsNCj4gDQo+IC0gICAgICAgaWYgKG5mc19wYXJzZV9tb3VudF9vcHRpb25zKChjaGFyICopb3B0
aW9ucywgYXJncykgPT0gMCkNCj4gKyAgICAgICBpZiAobmZzX3BhcnNlX21vdW50X29wdGlvbnMo
KGNoYXIgKilvcHRpb25zLCBjdHgpID09IDApDQo+ICAgICAgICAgICAgICAgICByZXR1cm4gLUVJ
TlZBTDsNCj4gDQo+ICAgICAgICAgaWYgKCFuZnNfdmVyaWZ5X3NlcnZlcl9hZGRyZXNzKHNhcCkp
DQo+ICAgICAgICAgICAgICAgICBnb3RvIG91dF9ub19hZGRyZXNzOw0KPiANCj4gLSAgICAgICBp
ZiAoYXJncy0+dmVyc2lvbiA9PSA0KSB7DQo+ICsgICAgICAgaWYgKGN0eC0+dmVyc2lvbiA9PSA0
KSB7DQo+ICAjaWYgSVNfRU5BQkxFRChDT05GSUdfTkZTX1Y0KQ0KPiAtICAgICAgICAgICAgICAg
aWYgKGFyZ3MtPm5mc19zZXJ2ZXIucHJvdG9jb2wgPT0gWFBSVF9UUkFOU1BPUlRfUkRNQSkNCj4g
KyAgICAgICAgICAgICAgIGlmIChjdHgtPm5mc19zZXJ2ZXIucHJvdG9jb2wgPT0gWFBSVF9UUkFO
U1BPUlRfUkRNQSkNCj4gICAgICAgICAgICAgICAgICAgICAgICAgcG9ydCA9IE5GU19SRE1BX1BP
UlQ7DQo+ICAgICAgICAgICAgICAgICBlbHNlDQo+ICAgICAgICAgICAgICAgICAgICAgICAgIHBv
cnQgPSBORlNfUE9SVDsNCj4gICAgICAgICAgICAgICAgIG1heF9uYW1lbGVuID0gTkZTNF9NQVhO
QU1MRU47DQo+ICAgICAgICAgICAgICAgICBtYXhfcGF0aGxlbiA9IE5GUzRfTUFYUEFUSExFTjsN
Cj4gLSAgICAgICAgICAgICAgIG5mc192YWxpZGF0ZV90cmFuc3BvcnRfcHJvdG9jb2woYXJncyk7
DQo+IC0gICAgICAgICAgICAgICBpZiAoYXJncy0+bmZzX3NlcnZlci5wcm90b2NvbCA9PSBYUFJU
X1RSQU5TUE9SVF9VRFApDQo+ICsgICAgICAgICAgICAgICBuZnNfdmFsaWRhdGVfdHJhbnNwb3J0
X3Byb3RvY29sKGN0eCk7DQo+ICsgICAgICAgICAgICAgICBpZiAoY3R4LT5uZnNfc2VydmVyLnBy
b3RvY29sID09IFhQUlRfVFJBTlNQT1JUX1VEUCkNCj4gICAgICAgICAgICAgICAgICAgICAgICAg
Z290byBvdXRfaW52YWxpZF90cmFuc3BvcnRfdWRwOw0KPiAtICAgICAgICAgICAgICAgbmZzNF92
YWxpZGF0ZV9tb3VudF9mbGFncyhhcmdzKTsNCj4gKyAgICAgICAgICAgICAgIG5mczRfdmFsaWRh
dGVfbW91bnRfZmxhZ3MoY3R4KTsNCj4gICNlbHNlDQo+ICAgICAgICAgICAgICAgICBnb3RvIG91
dF92NF9ub3RfY29tcGlsZWQ7DQo+ICAjZW5kaWYgLyogQ09ORklHX05GU19WNCAqLw0KPiAgICAg
ICAgIH0gZWxzZSB7DQo+IC0gICAgICAgICAgICAgICBuZnNfc2V0X21vdW50X3RyYW5zcG9ydF9w
cm90b2NvbChhcmdzKTsNCj4gLSAgICAgICAgICAgICAgIGlmIChhcmdzLT5uZnNfc2VydmVyLnBy
b3RvY29sID09IFhQUlRfVFJBTlNQT1JUX1JETUEpDQo+ICsgICAgICAgICAgICAgICBuZnNfc2V0
X21vdW50X3RyYW5zcG9ydF9wcm90b2NvbChjdHgpOw0KPiArICAgICAgICAgICAgICAgaWYgKGN0
eC0+bmZzX3NlcnZlci5wcm90b2NvbCA9PSBYUFJUX1RSQU5TUE9SVF9SRE1BKQ0KPiAgICAgICAg
ICAgICAgICAgICAgICAgICBwb3J0ID0gTkZTX1JETUFfUE9SVDsNCj4gICAgICAgICB9DQo+IA0K
PiAtICAgICAgIG5mc19zZXRfcG9ydChzYXAsICZhcmdzLT5uZnNfc2VydmVyLnBvcnQsIHBvcnQp
Ow0KPiArICAgICAgIG5mc19zZXRfcG9ydChzYXAsICZjdHgtPm5mc19zZXJ2ZXIucG9ydCwgcG9y
dCk7DQo+IA0KPiAgICAgICAgIHJldHVybiBuZnNfcGFyc2VfZGV2bmFtZShkZXZfbmFtZSwNCj4g
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmYXJncy0+bmZzX3NlcnZlci5ob3N0
bmFtZSwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmY3R4LT5uZnNfc2Vy
dmVyLmhvc3RuYW1lLA0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heF9u
YW1lbGVuLA0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZhcmdzLT5uZnNf
c2VydmVyLmV4cG9ydF9wYXRoLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICZjdHgtPm5mc19zZXJ2ZXIuZXhwb3J0X3BhdGgsDQo+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgbWF4X3BhdGhsZW4pOw0KPiANCj4gICNpZiAhSVNfRU5BQkxFRChDT05GSUdf
TkZTX1Y0KQ0KPiBkaWZmIC0tZ2l0IGEvZnMvbmZzL2ludGVybmFsLmggYi9mcy9uZnMvaW50ZXJu
YWwuaA0KPiBpbmRleCBiNjZmZDM1OTkzYjMuLjYzMjE3NGQ2NjZhOCAxMDA2NDQNCj4gLS0tIGEv
ZnMvbmZzL2ludGVybmFsLmgNCj4gKysrIGIvZnMvbmZzL2ludGVybmFsLmgNCj4gQEAgLTg5LDcg
Kzg5LDcgQEAgc3RydWN0IG5mc19jbGllbnRfaW5pdGRhdGEgew0KPiAgLyoNCj4gICAqIEluLWtl
cm5lbCBtb3VudCBhcmd1bWVudHMNCj4gICAqLw0KPiAtc3RydWN0IG5mc19wYXJzZWRfbW91bnRf
ZGF0YSB7DQo+ICtzdHJ1Y3QgbmZzX2ZzX2NvbnRleHQgew0KPiAgICAgICAgIGludCAgICAgICAg
ICAgICAgICAgICAgIGZsYWdzOw0KPiAgICAgICAgIHVuc2lnbmVkIGludCAgICAgICAgICAgIHJz
aXplLCB3c2l6ZTsNCj4gICAgICAgICB1bnNpZ25lZCBpbnQgICAgICAgICAgICB0aW1lbywgcmV0
cmFuczsNCj4gQEAgLTE0Niw3ICsxNDYsNyBAQCBzdHJ1Y3QgbmZzX21vdW50X3JlcXVlc3Qgew0K
PiANCj4gIHN0cnVjdCBuZnNfbW91bnRfaW5mbyB7DQo+ICAgICAgICAgdW5zaWduZWQgaW50IGlu
aGVyaXRlZF9ic2l6ZTsNCj4gLSAgICAgICBzdHJ1Y3QgbmZzX3BhcnNlZF9tb3VudF9kYXRhICpw
YXJzZWQ7DQo+ICsgICAgICAgc3RydWN0IG5mc19mc19jb250ZXh0ICpjdHg7DQo+ICAgICAgICAg
c3RydWN0IG5mc19jbG9uZV9tb3VudCAqY2xvbmVkOw0KPiAgICAgICAgIHN0cnVjdCBuZnNfc2Vy
dmVyICpzZXJ2ZXI7DQo+ICAgICAgICAgc3RydWN0IG5mc19maCAqbW50Zmg7DQo+IEBAIC0yMzcs
MTYgKzIzNywxNiBAQCBzdHJ1Y3QgbmZzX3BhZ2Vpb19kZXNjcmlwdG9yOw0KPiAgLyogbW91bnQu
YyAqLw0KPiAgI2RlZmluZSBORlNfVEVYVF9EQVRBICAgICAgICAgIDENCj4gDQo+IC1leHRlcm4g
c3RydWN0IG5mc19wYXJzZWRfbW91bnRfZGF0YQ0KPiAqbmZzX2FsbG9jX3BhcnNlZF9tb3VudF9k
YXRhKHZvaWQpOw0KPiAtZXh0ZXJuIHZvaWQgbmZzX2ZyZWVfcGFyc2VkX21vdW50X2RhdGEoc3Ry
dWN0IG5mc19wYXJzZWRfbW91bnRfZGF0YQ0KPiAqZGF0YSk7DQo+IC1leHRlcm4gaW50IG5mc19w
YXJzZV9tb3VudF9vcHRpb25zKGNoYXIgKnJhdywgc3RydWN0DQo+IG5mc19wYXJzZWRfbW91bnRf
ZGF0YSAqbW50KTsNCj4gK2V4dGVybiBzdHJ1Y3QgbmZzX2ZzX2NvbnRleHQgKm5mc19hbGxvY19w
YXJzZWRfbW91bnRfZGF0YSh2b2lkKTsNCj4gK2V4dGVybiB2b2lkIG5mc19mcmVlX3BhcnNlZF9t
b3VudF9kYXRhKHN0cnVjdCBuZnNfZnNfY29udGV4dCAqY3R4KTsNCj4gK2V4dGVybiBpbnQgbmZz
X3BhcnNlX21vdW50X29wdGlvbnMoY2hhciAqcmF3LCBzdHJ1Y3QgbmZzX2ZzX2NvbnRleHQNCj4g
KmN0eCk7DQo+ICBleHRlcm4gaW50IG5mc192YWxpZGF0ZV9tb3VudF9kYXRhKHN0cnVjdCBmaWxl
X3N5c3RlbV90eXBlICpmc190eXBlLA0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHZvaWQgKm9wdGlvbnMsDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
c3RydWN0IG5mc19wYXJzZWRfbW91bnRfZGF0YQ0KPiAqYXJncywNCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgbmZzX2ZzX2NvbnRleHQgKmN0eCwNCj4gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgbmZzX2ZoICptbnRmaCwNCj4gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpkZXZfbmFtZSk7DQo+
ICBleHRlcm4gaW50IG5mc192YWxpZGF0ZV90ZXh0X21vdW50X2RhdGEodm9pZCAqb3B0aW9ucywN
Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBuZnNfcGFy
c2VkX21vdW50X2RhdGENCj4gKmFyZ3MsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3QgbmZzX2ZzX2NvbnRleHQgKmN0eCwNCj4gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmRldl9uYW1lKTsNCj4gDQo+ICAv
KiBwYWdlbGlzdC5jICovDQo+IGRpZmYgLS1naXQgYS9mcy9uZnMvbmZzNGNsaWVudC5jIGIvZnMv
bmZzL25mczRjbGllbnQuYw0KPiBpbmRleCAxNmZiYTgzYjVjNGIuLjJlZTIyODFjZTQwNCAxMDA2
NDQNCj4gLS0tIGEvZnMvbmZzL25mczRjbGllbnQuYw0KPiArKysgYi9mcy9uZnMvbmZzNGNsaWVu
dC5jDQo+IEBAIC0xMDUzLDYxICsxMDUzLDYxIEBAIHN0YXRpYyBpbnQgbmZzNF9zZXJ2ZXJfY29t
bW9uX3NldHVwKHN0cnVjdA0KPiBuZnNfc2VydmVyICpzZXJ2ZXIsDQo+ICAgKiBDcmVhdGUgYSB2
ZXJzaW9uIDQgdm9sdW1lIHJlY29yZA0KPiAgICovDQo+ICBzdGF0aWMgaW50IG5mczRfaW5pdF9z
ZXJ2ZXIoc3RydWN0IG5mc19zZXJ2ZXIgKnNlcnZlciwNCj4gLSAgICAgICAgICAgICAgIHN0cnVj
dCBuZnNfcGFyc2VkX21vdW50X2RhdGEgKmRhdGEpDQo+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzdHJ1Y3QgbmZzX2ZzX2NvbnRleHQgKmN0eCkNCj4gIHsNCj4gICAgICAgICBzdHJ1Y3Qg
cnBjX3RpbWVvdXQgdGltZXBhcm1zOw0KPiAgICAgICAgIGludCBlcnJvcjsNCj4gDQo+IC0gICAg
ICAgbmZzX2luaXRfdGltZW91dF92YWx1ZXMoJnRpbWVwYXJtcywgZGF0YS0NCj4gPm5mc19zZXJ2
ZXIucHJvdG9jb2wsDQo+IC0gICAgICAgICAgICAgICAgICAgICAgIGRhdGEtPnRpbWVvLCBkYXRh
LT5yZXRyYW5zKTsNCj4gKyAgICAgICBuZnNfaW5pdF90aW1lb3V0X3ZhbHVlcygmdGltZXBhcm1z
LCBjdHgtPm5mc19zZXJ2ZXIucHJvdG9jb2wsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgY3R4LT50aW1lbywgY3R4LT5yZXRyYW5zKTsNCj4gDQo+ICAgICAgICAgLyogSW5pdGlh
bGlzZSB0aGUgY2xpZW50IHJlcHJlc2VudGF0aW9uIGZyb20gdGhlIG1vdW50IGRhdGENCj4gKi8N
Cj4gLSAgICAgICBzZXJ2ZXItPmZsYWdzID0gZGF0YS0+ZmxhZ3M7DQo+IC0gICAgICAgc2VydmVy
LT5vcHRpb25zID0gZGF0YS0+b3B0aW9uczsNCj4gLSAgICAgICBzZXJ2ZXItPmF1dGhfaW5mbyA9
IGRhdGEtPmF1dGhfaW5mbzsNCj4gKyAgICAgICBzZXJ2ZXItPmZsYWdzID0gY3R4LT5mbGFnczsN
Cj4gKyAgICAgICBzZXJ2ZXItPm9wdGlvbnMgPSBjdHgtPm9wdGlvbnM7DQo+ICsgICAgICAgc2Vy
dmVyLT5hdXRoX2luZm8gPSBjdHgtPmF1dGhfaW5mbzsNCj4gDQo+ICAgICAgICAgLyogVXNlIHRo
ZSBmaXJzdCBzcGVjaWZpZWQgYXV0aCBmbGF2b3IuIElmIHRoaXMgZmxhdm9yIGlzbid0DQo+ICAg
ICAgICAgICogYWxsb3dlZCBieSB0aGUgc2VydmVyLCB1c2UgdGhlIFNFQ0lORk8gcGF0aCB0byB0
cnkgdGhlDQo+ICAgICAgICAgICogb3RoZXIgc3BlY2lmaWVkIGZsYXZvcnMgKi8NCj4gLSAgICAg
ICBpZiAoZGF0YS0+YXV0aF9pbmZvLmZsYXZvcl9sZW4gPj0gMSkNCj4gLSAgICAgICAgICAgICAg
IGRhdGEtPnNlbGVjdGVkX2ZsYXZvciA9IGRhdGEtPmF1dGhfaW5mby5mbGF2b3JzWzBdOw0KPiAr
ICAgICAgIGlmIChjdHgtPmF1dGhfaW5mby5mbGF2b3JfbGVuID49IDEpDQo+ICsgICAgICAgICAg
ICAgICBjdHgtPnNlbGVjdGVkX2ZsYXZvciA9IGN0eC0+YXV0aF9pbmZvLmZsYXZvcnNbMF07DQo+
ICAgICAgICAgZWxzZQ0KPiAtICAgICAgICAgICAgICAgZGF0YS0+c2VsZWN0ZWRfZmxhdm9yID0g
UlBDX0FVVEhfVU5JWDsNCj4gKyAgICAgICAgICAgICAgIGN0eC0+c2VsZWN0ZWRfZmxhdm9yID0g
UlBDX0FVVEhfVU5JWDsNCj4gDQo+ICAgICAgICAgLyogR2V0IGEgY2xpZW50IHJlY29yZCAqLw0K
PiAgICAgICAgIGVycm9yID0gbmZzNF9zZXRfY2xpZW50KHNlcnZlciwNCj4gLSAgICAgICAgICAg
ICAgICAgICAgICAgZGF0YS0+bmZzX3NlcnZlci5ob3N0bmFtZSwNCj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgKGNvbnN0IHN0cnVjdCBzb2NrYWRkciAqKSZkYXRhLQ0KPiA+bmZzX3NlcnZlci5h
ZGRyZXNzLA0KPiAtICAgICAgICAgICAgICAgICAgICAgICBkYXRhLT5uZnNfc2VydmVyLmFkZHJs
ZW4sDQo+IC0gICAgICAgICAgICAgICAgICAgICAgIGRhdGEtPmNsaWVudF9hZGRyZXNzLA0KPiAt
ICAgICAgICAgICAgICAgICAgICAgICBkYXRhLT5uZnNfc2VydmVyLnByb3RvY29sLA0KPiArICAg
ICAgICAgICAgICAgICAgICAgICBjdHgtPm5mc19zZXJ2ZXIuaG9zdG5hbWUsDQo+ICsgICAgICAg
ICAgICAgICAgICAgICAgIChjb25zdCBzdHJ1Y3Qgc29ja2FkZHIgKikmY3R4LQ0KPiA+bmZzX3Nl
cnZlci5hZGRyZXNzLA0KPiArICAgICAgICAgICAgICAgICAgICAgICBjdHgtPm5mc19zZXJ2ZXIu
YWRkcmxlbiwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgY3R4LT5jbGllbnRfYWRkcmVzcywN
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgY3R4LT5uZnNfc2VydmVyLnByb3RvY29sLA0KPiAg
ICAgICAgICAgICAgICAgICAgICAgICAmdGltZXBhcm1zLA0KPiAtICAgICAgICAgICAgICAgICAg
ICAgICBkYXRhLT5taW5vcnZlcnNpb24sDQo+IC0gICAgICAgICAgICAgICAgICAgICAgIGRhdGEt
Pm5mc19zZXJ2ZXIubmNvbm5lY3QsDQo+IC0gICAgICAgICAgICAgICAgICAgICAgIGRhdGEtPm5l
dCk7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGN0eC0+bWlub3J2ZXJzaW9uLA0KPiArICAg
ICAgICAgICAgICAgICAgICAgICBjdHgtPm5mc19zZXJ2ZXIubmNvbm5lY3QsDQo+ICsgICAgICAg
ICAgICAgICAgICAgICAgIGN0eC0+bmV0KTsNCj4gICAgICAgICBpZiAoZXJyb3IgPCAwKQ0KPiAg
ICAgICAgICAgICAgICAgcmV0dXJuIGVycm9yOw0KPiANCj4gLSAgICAgICBpZiAoZGF0YS0+cnNp
emUpDQo+IC0gICAgICAgICAgICAgICBzZXJ2ZXItPnJzaXplID0gbmZzX2Jsb2NrX3NpemUoZGF0
YS0+cnNpemUsIE5VTEwpOw0KPiAtICAgICAgIGlmIChkYXRhLT53c2l6ZSkNCj4gLSAgICAgICAg
ICAgICAgIHNlcnZlci0+d3NpemUgPSBuZnNfYmxvY2tfc2l6ZShkYXRhLT53c2l6ZSwgTlVMTCk7
DQo+ICsgICAgICAgaWYgKGN0eC0+cnNpemUpDQo+ICsgICAgICAgICAgICAgICBzZXJ2ZXItPnJz
aXplID0gbmZzX2Jsb2NrX3NpemUoY3R4LT5yc2l6ZSwgTlVMTCk7DQo+ICsgICAgICAgaWYgKGN0
eC0+d3NpemUpDQo+ICsgICAgICAgICAgICAgICBzZXJ2ZXItPndzaXplID0gbmZzX2Jsb2NrX3Np
emUoY3R4LT53c2l6ZSwgTlVMTCk7DQo+IA0KPiAtICAgICAgIHNlcnZlci0+YWNyZWdtaW4gPSBk
YXRhLT5hY3JlZ21pbiAqIEhaOw0KPiAtICAgICAgIHNlcnZlci0+YWNyZWdtYXggPSBkYXRhLT5h
Y3JlZ21heCAqIEhaOw0KPiAtICAgICAgIHNlcnZlci0+YWNkaXJtaW4gPSBkYXRhLT5hY2Rpcm1p
biAqIEhaOw0KPiAtICAgICAgIHNlcnZlci0+YWNkaXJtYXggPSBkYXRhLT5hY2Rpcm1heCAqIEha
Ow0KPiAtICAgICAgIHNlcnZlci0+cG9ydCAgICAgPSBkYXRhLT5uZnNfc2VydmVyLnBvcnQ7DQo+
ICsgICAgICAgc2VydmVyLT5hY3JlZ21pbiA9IGN0eC0+YWNyZWdtaW4gKiBIWjsNCj4gKyAgICAg
ICBzZXJ2ZXItPmFjcmVnbWF4ID0gY3R4LT5hY3JlZ21heCAqIEhaOw0KPiArICAgICAgIHNlcnZl
ci0+YWNkaXJtaW4gPSBjdHgtPmFjZGlybWluICogSFo7DQo+ICsgICAgICAgc2VydmVyLT5hY2Rp
cm1heCA9IGN0eC0+YWNkaXJtYXggKiBIWjsNCj4gKyAgICAgICBzZXJ2ZXItPnBvcnQgICAgID0g
Y3R4LT5uZnNfc2VydmVyLnBvcnQ7DQo+IA0KPiAgICAgICAgIHJldHVybiBuZnNfaW5pdF9zZXJ2
ZXJfcnBjY2xpZW50KHNlcnZlciwgJnRpbWVwYXJtcywNCj4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBkYXRhLT5zZWxlY3RlZF9mbGF2b3IpOw0KPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC0+c2VsZWN0ZWRfZmxhdm9yKTsNCj4g
IH0NCj4gDQo+ICAvKg0KPiAgICogQ3JlYXRlIGEgdmVyc2lvbiA0IHZvbHVtZSByZWNvcmQNCj4g
ICAqIC0ga2V5ZWQgb24gc2VydmVyIGFuZCBGU0lEDQo+ICAgKi8NCj4gLS8qc3RydWN0IG5mc19z
ZXJ2ZXIgKm5mczRfY3JlYXRlX3NlcnZlcihjb25zdCBzdHJ1Y3QNCj4gbmZzX3BhcnNlZF9tb3Vu
dF9kYXRhICpkYXRhLA0KPiArLypzdHJ1Y3QgbmZzX3NlcnZlciAqbmZzNF9jcmVhdGVfc2VydmVy
KGNvbnN0IHN0cnVjdCBuZnNfZnNfY29udGV4dA0KPiAqZGF0YSwNCj4gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgbmZzX2ZoICptbnRmaCkqLw0KPiAgc3RydWN0
IG5mc19zZXJ2ZXIgKm5mczRfY3JlYXRlX3NlcnZlcihzdHJ1Y3QgbmZzX21vdW50X2luZm8NCj4g
Km1vdW50X2luZm8pDQo+ICB7DQo+IEBAIC0xMTIxLDEwICsxMTIxLDEwIEBAIHN0cnVjdCBuZnNf
c2VydmVyICpuZnM0X2NyZWF0ZV9zZXJ2ZXIoc3RydWN0DQo+IG5mc19tb3VudF9pbmZvICptb3Vu
dF9pbmZvKQ0KPiANCj4gICAgICAgICBzZXJ2ZXItPmNyZWQgPSBnZXRfY3JlZChjdXJyZW50X2Ny
ZWQoKSk7DQo+IA0KPiAtICAgICAgIGF1dGhfcHJvYmUgPSBtb3VudF9pbmZvLT5wYXJzZWQtPmF1
dGhfaW5mby5mbGF2b3JfbGVuIDwgMTsNCj4gKyAgICAgICBhdXRoX3Byb2JlID0gbW91bnRfaW5m
by0+Y3R4LT5hdXRoX2luZm8uZmxhdm9yX2xlbiA8IDE7DQo+IA0KPiAgICAgICAgIC8qIHNldCB1
cCB0aGUgZ2VuZXJhbCBSUEMgY2xpZW50ICovDQo+IC0gICAgICAgZXJyb3IgPSBuZnM0X2luaXRf
c2VydmVyKHNlcnZlciwgbW91bnRfaW5mby0+cGFyc2VkKTsNCj4gKyAgICAgICBlcnJvciA9IG5m
czRfaW5pdF9zZXJ2ZXIoc2VydmVyLCBtb3VudF9pbmZvLT5jdHgpOw0KPiAgICAgICAgIGlmIChl
cnJvciA8IDApDQo+ICAgICAgICAgICAgICAgICBnb3RvIGVycm9yOw0KPiANCj4gZGlmZiAtLWdp
dCBhL2ZzL25mcy9uZnM0c3VwZXIuYyBiL2ZzL25mcy9uZnM0c3VwZXIuYw0KPiBpbmRleCAzOGYy
ZWVjN2UxYWQuLmNhOTc0MDEzN2NmZSAxMDA2NDQNCj4gLS0tIGEvZnMvbmZzL25mczRzdXBlci5j
DQo+ICsrKyBiL2ZzL25mcy9uZnM0c3VwZXIuYw0KPiBAQCAtMTk4LDE1ICsxOTgsMTUgQEAgc3Rh
dGljIHN0cnVjdCBkZW50cnkgKmRvX25mczRfbW91bnQoc3RydWN0DQo+IG5mc19zZXJ2ZXIgKnNl
cnZlciwgaW50IGZsYWdzLA0KPiAgc3RydWN0IGRlbnRyeSAqbmZzNF90cnlfbW91bnQoaW50IGZs
YWdzLCBjb25zdCBjaGFyICpkZXZfbmFtZSwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgc3RydWN0IG5mc19tb3VudF9pbmZvICptb3VudF9pbmZvKQ0KPiAgew0KPiAtICAgICAgIHN0
cnVjdCBuZnNfcGFyc2VkX21vdW50X2RhdGEgKmRhdGEgPSBtb3VudF9pbmZvLT5wYXJzZWQ7DQo+
ICsgICAgICAgc3RydWN0IG5mc19mc19jb250ZXh0ICpjdHggPSBtb3VudF9pbmZvLT5jdHg7DQo+
ICAgICAgICAgc3RydWN0IGRlbnRyeSAqcmVzOw0KPiANCj4gICAgICAgICBkZnByaW50ayhNT1VO
VCwgIi0tPiBuZnM0X3RyeV9tb3VudCgpXG4iKTsNCj4gDQo+ICAgICAgICAgcmVzID0gZG9fbmZz
NF9tb3VudChuZnM0X2NyZWF0ZV9zZXJ2ZXIobW91bnRfaW5mbyksDQo+ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBmbGFncywgbW91bnRfaW5mbywNCj4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGRhdGEtPm5mc19zZXJ2ZXIuaG9zdG5hbWUsDQo+IC0gICAgICAgICAgICAgICAgICAg
ICAgICAgICBkYXRhLT5uZnNfc2VydmVyLmV4cG9ydF9wYXRoKTsNCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGN0eC0+bmZzX3NlcnZlci5ob3N0bmFtZSwNCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGN0eC0+bmZzX3NlcnZlci5leHBvcnRfcGF0aCk7DQo+IA0KPiAgICAgICAg
IGRmcHJpbnRrKE1PVU5ULCAiPC0tIG5mczRfdHJ5X21vdW50KCkgPSAlZCVzXG4iLA0KPiAgICAg
ICAgICAgICAgICAgIFBUUl9FUlJfT1JfWkVSTyhyZXMpLA0KPiBkaWZmIC0tZ2l0IGEvZnMvbmZz
L3N1cGVyLmMgYi9mcy9uZnMvc3VwZXIuYw0KPiBpbmRleCA4ODYyMjBkMmRhNGUuLmFiZDk5ZWQw
MGUzOSAxMDA2NDQNCj4gLS0tIGEvZnMvbmZzL3N1cGVyLmMNCj4gKysrIGIvZnMvbmZzL3N1cGVy
LmMNCj4gQEAgLTcyNiwxMiArNzI2LDEzIEBAIGJvb2wgbmZzX2F1dGhfaW5mb19tYXRjaChjb25z
dCBzdHJ1Y3QNCj4gbmZzX2F1dGhfaW5mbyAqYXV0aF9pbmZvLA0KPiAgRVhQT1JUX1NZTUJPTF9H
UEwobmZzX2F1dGhfaW5mb19tYXRjaCk7DQo+IA0KPiAgLyoNCj4gLSAqIEVuc3VyZSB0aGF0IGEg
c3BlY2lmaWVkIGF1dGh0eXBlIGluIGFyZ3MtPmF1dGhfaW5mbyBpcyBzdXBwb3J0ZWQNCj4gYnkN
Cj4gLSAqIHRoZSBzZXJ2ZXIuIFJldHVybnMgMCBhbmQgc2V0cyBhcmdzLT5zZWxlY3RlZF9mbGF2
b3IgaWYgaXQncyBvaywNCj4gYW5kDQo+ICsgKiBFbnN1cmUgdGhhdCBhIHNwZWNpZmllZCBhdXRo
dHlwZSBpbiBjZmctPmF1dGhfaW5mbyBpcyBzdXBwb3J0ZWQNCj4gYnkNCj4gKyAqIHRoZSBzZXJ2
ZXIuIFJldHVybnMgMCBhbmQgc2V0cyBjZmctPnNlbGVjdGVkX2ZsYXZvciBpZiBpdCdzIG9rLA0K
PiBhbmQNCj4gICAqIC1FQUNDRVMgaWYgbm90Lg0KPiAgICovDQo+IC1zdGF0aWMgaW50IG5mc192
ZXJpZnlfYXV0aGZsYXZvcnMoc3RydWN0IG5mc19wYXJzZWRfbW91bnRfZGF0YQ0KPiAqYXJncywN
Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgcnBjX2F1dGhmbGF2b3JfdCAqc2VydmVyX2F1dGhs
aXN0LCB1bnNpZ25lZA0KPiBpbnQgY291bnQpDQo+ICtzdGF0aWMgaW50IG5mc192ZXJpZnlfYXV0
aGZsYXZvcnMoc3RydWN0IG5mc19mc19jb250ZXh0ICpjZmcsDQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBycGNfYXV0aGZsYXZvcl90ICpzZXJ2ZXJfYXV0aGxpc3QsDQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgY291bnQpDQo+ICB7
DQo+ICAgICAgICAgcnBjX2F1dGhmbGF2b3JfdCBmbGF2b3IgPSBSUENfQVVUSF9NQVhGTEFWT1I7
DQo+ICAgICAgICAgYm9vbCBmb3VuZF9hdXRoX251bGwgPSBmYWxzZTsNCj4gQEAgLTc1Miw3ICs3
NTMsNyBAQCBzdGF0aWMgaW50IG5mc192ZXJpZnlfYXV0aGZsYXZvcnMoc3RydWN0DQo+IG5mc19w
YXJzZWRfbW91bnRfZGF0YSAqYXJncywNCj4gICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY291bnQ7
IGkrKykgew0KPiAgICAgICAgICAgICAgICAgZmxhdm9yID0gc2VydmVyX2F1dGhsaXN0W2ldOw0K
PiANCj4gLSAgICAgICAgICAgICAgIGlmIChuZnNfYXV0aF9pbmZvX21hdGNoKCZhcmdzLT5hdXRo
X2luZm8sIGZsYXZvcikpDQo+ICsgICAgICAgICAgICAgICBpZiAobmZzX2F1dGhfaW5mb19tYXRj
aCgmY2ZnLT5hdXRoX2luZm8sIGZsYXZvcikpDQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGdv
dG8gb3V0Ow0KPiANCj4gICAgICAgICAgICAgICAgIGlmIChmbGF2b3IgPT0gUlBDX0FVVEhfTlVM
TCkNCj4gQEAgLTc2MCw3ICs3NjEsNyBAQCBzdGF0aWMgaW50IG5mc192ZXJpZnlfYXV0aGZsYXZv
cnMoc3RydWN0DQo+IG5mc19wYXJzZWRfbW91bnRfZGF0YSAqYXJncywNCj4gICAgICAgICB9DQo+
IA0KPiAgICAgICAgIGlmIChmb3VuZF9hdXRoX251bGwpIHsNCj4gLSAgICAgICAgICAgICAgIGZs
YXZvciA9IGFyZ3MtPmF1dGhfaW5mby5mbGF2b3JzWzBdOw0KPiArICAgICAgICAgICAgICAgZmxh
dm9yID0gY2ZnLT5hdXRoX2luZm8uZmxhdm9yc1swXTsNCj4gICAgICAgICAgICAgICAgIGdvdG8g
b3V0Ow0KPiAgICAgICAgIH0NCj4gDQo+IEBAIC03NjksOCArNzcwLDggQEAgc3RhdGljIGludCBu
ZnNfdmVyaWZ5X2F1dGhmbGF2b3JzKHN0cnVjdA0KPiBuZnNfcGFyc2VkX21vdW50X2RhdGEgKmFy
Z3MsDQo+ICAgICAgICAgcmV0dXJuIC1FQUNDRVM7DQo+IA0KPiAgb3V0Og0KPiAtICAgICAgIGFy
Z3MtPnNlbGVjdGVkX2ZsYXZvciA9IGZsYXZvcjsNCj4gLSAgICAgICBkZnByaW50ayhNT1VOVCwg
Ik5GUzogdXNpbmcgYXV0aCBmbGF2b3IgJXVcbiIsIGFyZ3MtDQo+ID5zZWxlY3RlZF9mbGF2b3Ip
Ow0KPiArICAgICAgIGNmZy0+c2VsZWN0ZWRfZmxhdm9yID0gZmxhdm9yOw0KPiArICAgICAgIGRm
cHJpbnRrKE1PVU5ULCAiTkZTOiB1c2luZyBhdXRoIGZsYXZvciAldVxuIiwgY2ZnLQ0KPiA+c2Vs
ZWN0ZWRfZmxhdm9yKTsNCj4gICAgICAgICByZXR1cm4gMDsNCj4gIH0NCj4gDQo+IEBAIC03Nzgs
NTAgKzc3OSw1MCBAQCBzdGF0aWMgaW50IG5mc192ZXJpZnlfYXV0aGZsYXZvcnMoc3RydWN0DQo+
IG5mc19wYXJzZWRfbW91bnRfZGF0YSAqYXJncywNCj4gICAqIFVzZSB0aGUgcmVtb3RlIHNlcnZl
cidzIE1PVU5UIHNlcnZpY2UgdG8gcmVxdWVzdCB0aGUgTkZTIGZpbGUNCj4gaGFuZGxlDQo+ICAg
KiBjb3JyZXNwb25kaW5nIHRvIHRoZSBwcm92aWRlZCBwYXRoLg0KPiAgICovDQo+IC1zdGF0aWMg
aW50IG5mc19yZXF1ZXN0X21vdW50KHN0cnVjdCBuZnNfcGFyc2VkX21vdW50X2RhdGEgKmFyZ3Ms
DQo+ICtzdGF0aWMgaW50IG5mc19yZXF1ZXN0X21vdW50KHN0cnVjdCBuZnNfZnNfY29udGV4dCAq
Y2ZnLA0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBuZnNfZmggKnJvb3Rf
ZmgsDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnBjX2F1dGhmbGF2b3JfdCAqc2Vy
dmVyX2F1dGhsaXN0LA0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGlu
dCAqc2VydmVyX2F1dGhsaXN0X2xlbikNCj4gIHsNCj4gICAgICAgICBzdHJ1Y3QgbmZzX21vdW50
X3JlcXVlc3QgcmVxdWVzdCA9IHsNCj4gICAgICAgICAgICAgICAgIC5zYXAgICAgICAgICAgICA9
IChzdHJ1Y3Qgc29ja2FkZHIgKikNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgJmFyZ3MtDQo+ID5tb3VudF9zZXJ2ZXIuYWRkcmVzcywNCj4gLSAgICAg
ICAgICAgICAgIC5kaXJwYXRoICAgICAgICA9IGFyZ3MtPm5mc19zZXJ2ZXIuZXhwb3J0X3BhdGgs
DQo+IC0gICAgICAgICAgICAgICAucHJvdG9jb2wgICAgICAgPSBhcmdzLT5tb3VudF9zZXJ2ZXIu
cHJvdG9jb2wsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICZjZmctDQo+ID5tb3VudF9zZXJ2ZXIuYWRkcmVzcywNCj4gKyAgICAgICAgICAgICAgIC5k
aXJwYXRoICAgICAgICA9IGNmZy0+bmZzX3NlcnZlci5leHBvcnRfcGF0aCwNCj4gKyAgICAgICAg
ICAgICAgIC5wcm90b2NvbCAgICAgICA9IGNmZy0+bW91bnRfc2VydmVyLnByb3RvY29sLA0KPiAg
ICAgICAgICAgICAgICAgLmZoICAgICAgICAgICAgID0gcm9vdF9maCwNCj4gLSAgICAgICAgICAg
ICAgIC5ub3Jlc3Zwb3J0ICAgICA9IGFyZ3MtPmZsYWdzICYgTkZTX01PVU5UX05PUkVTVlBPUlQs
DQo+ICsgICAgICAgICAgICAgICAubm9yZXN2cG9ydCAgICAgPSBjZmctPmZsYWdzICYgTkZTX01P
VU5UX05PUkVTVlBPUlQsDQo+ICAgICAgICAgICAgICAgICAuYXV0aF9mbGF2X2xlbiAgPSBzZXJ2
ZXJfYXV0aGxpc3RfbGVuLA0KPiAgICAgICAgICAgICAgICAgLmF1dGhfZmxhdnMgICAgID0gc2Vy
dmVyX2F1dGhsaXN0LA0KPiAtICAgICAgICAgICAgICAgLm5ldCAgICAgICAgICAgID0gYXJncy0+
bmV0LA0KPiArICAgICAgICAgICAgICAgLm5ldCAgICAgICAgICAgID0gY2ZnLT5uZXQsDQo+ICAg
ICAgICAgfTsNCj4gICAgICAgICBpbnQgc3RhdHVzOw0KPiANCj4gLSAgICAgICBpZiAoYXJncy0+
bW91bnRfc2VydmVyLnZlcnNpb24gPT0gMCkgew0KPiAtICAgICAgICAgICAgICAgc3dpdGNoIChh
cmdzLT52ZXJzaW9uKSB7DQo+ICsgICAgICAgaWYgKGNmZy0+bW91bnRfc2VydmVyLnZlcnNpb24g
PT0gMCkgew0KPiArICAgICAgICAgICAgICAgc3dpdGNoIChjZmctPnZlcnNpb24pIHsNCj4gICAg
ICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoNCj4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBhcmdzLT5tb3VudF9zZXJ2ZXIudmVyc2lvbiA9DQo+IE5GU19NTlQzX1ZFUlNJT047
DQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2ZnLT5tb3VudF9zZXJ2ZXIudmVy
c2lvbiA9DQo+IE5GU19NTlQzX1ZFUlNJT047DQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgYnJlYWs7DQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjoNCj4gLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLT5tb3VudF9zZXJ2ZXIudmVyc2lvbiA9DQo+
IE5GU19NTlRfVkVSU0lPTjsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZmct
Pm1vdW50X3NlcnZlci52ZXJzaW9uID0NCj4gTkZTX01OVF9WRVJTSU9OOw0KPiAgICAgICAgICAg
ICAgICAgfQ0KPiAgICAgICAgIH0NCj4gLSAgICAgICByZXF1ZXN0LnZlcnNpb24gPSBhcmdzLT5t
b3VudF9zZXJ2ZXIudmVyc2lvbjsNCj4gKyAgICAgICByZXF1ZXN0LnZlcnNpb24gPSBjZmctPm1v
dW50X3NlcnZlci52ZXJzaW9uOw0KPiANCj4gLSAgICAgICBpZiAoYXJncy0+bW91bnRfc2VydmVy
Lmhvc3RuYW1lKQ0KPiAtICAgICAgICAgICAgICAgcmVxdWVzdC5ob3N0bmFtZSA9IGFyZ3MtPm1v
dW50X3NlcnZlci5ob3N0bmFtZTsNCj4gKyAgICAgICBpZiAoY2ZnLT5tb3VudF9zZXJ2ZXIuaG9z
dG5hbWUpDQo+ICsgICAgICAgICAgICAgICByZXF1ZXN0Lmhvc3RuYW1lID0gY2ZnLT5tb3VudF9z
ZXJ2ZXIuaG9zdG5hbWU7DQo+ICAgICAgICAgZWxzZQ0KPiAtICAgICAgICAgICAgICAgcmVxdWVz
dC5ob3N0bmFtZSA9IGFyZ3MtPm5mc19zZXJ2ZXIuaG9zdG5hbWU7DQo+ICsgICAgICAgICAgICAg
ICByZXF1ZXN0Lmhvc3RuYW1lID0gY2ZnLT5uZnNfc2VydmVyLmhvc3RuYW1lOw0KPiANCj4gICAg
ICAgICAvKg0KPiAgICAgICAgICAqIENvbnN0cnVjdCB0aGUgbW91bnQgc2VydmVyJ3MgYWRkcmVz
cy4NCj4gICAgICAgICAgKi8NCj4gLSAgICAgICBpZiAoYXJncy0+bW91bnRfc2VydmVyLmFkZHJl
c3Muc3NfZmFtaWx5ID09IEFGX1VOU1BFQykgew0KPiAtICAgICAgICAgICAgICAgbWVtY3B5KHJl
cXVlc3Quc2FwLCAmYXJncy0+bmZzX3NlcnZlci5hZGRyZXNzLA0KPiAtICAgICAgICAgICAgICAg
ICAgICAgIGFyZ3MtPm5mc19zZXJ2ZXIuYWRkcmxlbik7DQo+IC0gICAgICAgICAgICAgICBhcmdz
LT5tb3VudF9zZXJ2ZXIuYWRkcmxlbiA9IGFyZ3MtDQo+ID5uZnNfc2VydmVyLmFkZHJsZW47DQo+
ICsgICAgICAgaWYgKGNmZy0+bW91bnRfc2VydmVyLmFkZHJlc3Muc3NfZmFtaWx5ID09IEFGX1VO
U1BFQykgew0KPiArICAgICAgICAgICAgICAgbWVtY3B5KHJlcXVlc3Quc2FwLCAmY2ZnLT5uZnNf
c2VydmVyLmFkZHJlc3MsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgY2ZnLT5uZnNfc2VydmVy
LmFkZHJsZW4pOw0KPiArICAgICAgICAgICAgICAgY2ZnLT5tb3VudF9zZXJ2ZXIuYWRkcmxlbiA9
IGNmZy0+bmZzX3NlcnZlci5hZGRybGVuOw0KPiAgICAgICAgIH0NCj4gLSAgICAgICByZXF1ZXN0
LnNhbGVuID0gYXJncy0+bW91bnRfc2VydmVyLmFkZHJsZW47DQo+IC0gICAgICAgbmZzX3NldF9w
b3J0KHJlcXVlc3Quc2FwLCAmYXJncy0+bW91bnRfc2VydmVyLnBvcnQsIDApOw0KPiArICAgICAg
IHJlcXVlc3Quc2FsZW4gPSBjZmctPm1vdW50X3NlcnZlci5hZGRybGVuOw0KPiArICAgICAgIG5m
c19zZXRfcG9ydChyZXF1ZXN0LnNhcCwgJmNmZy0+bW91bnRfc2VydmVyLnBvcnQsIDApOw0KPiAN
Cj4gICAgICAgICAvKg0KPiAgICAgICAgICAqIE5vdyBhc2sgdGhlIG1vdW50IHNlcnZlciB0byBt
YXAgb3VyIGV4cG9ydCBwYXRoDQo+IEBAIC04NDQsMTIgKzg0NSwxMiBAQCBzdGF0aWMgc3RydWN0
IG5mc19zZXJ2ZXINCj4gKm5mc190cnlfbW91bnRfcmVxdWVzdChzdHJ1Y3QgbmZzX21vdW50X2lu
Zm8gKm1vdW50X2luZg0KPiAgICAgICAgIGJvb2wgdHJpZWRfYXV0aF91bml4ID0gZmFsc2U7DQo+
ICAgICAgICAgYm9vbCBhdXRoX251bGxfaW5fbGlzdCA9IGZhbHNlOw0KPiAgICAgICAgIHN0cnVj
dCBuZnNfc2VydmVyICpzZXJ2ZXIgPSBFUlJfUFRSKC1FQUNDRVMpOw0KPiAtICAgICAgIHN0cnVj
dCBuZnNfcGFyc2VkX21vdW50X2RhdGEgKmFyZ3MgPSBtb3VudF9pbmZvLT5wYXJzZWQ7DQo+ICsg
ICAgICAgc3RydWN0IG5mc19mc19jb250ZXh0ICpjdHggPSBtb3VudF9pbmZvLT5jdHg7DQo+ICAg
ICAgICAgcnBjX2F1dGhmbGF2b3JfdCBhdXRobGlzdFtORlNfTUFYX1NFQ0ZMQVZPUlNdOw0KPiAg
ICAgICAgIHVuc2lnbmVkIGludCBhdXRobGlzdF9sZW4gPSBBUlJBWV9TSVpFKGF1dGhsaXN0KTsN
Cj4gICAgICAgICBzdHJ1Y3QgbmZzX3N1YnZlcnNpb24gKm5mc19tb2QgPSBtb3VudF9pbmZvLT5u
ZnNfbW9kOw0KPiANCj4gLSAgICAgICBzdGF0dXMgPSBuZnNfcmVxdWVzdF9tb3VudChhcmdzLCBt
b3VudF9pbmZvLT5tbnRmaCwgYXV0aGxpc3QsDQo+ICsgICAgICAgc3RhdHVzID0gbmZzX3JlcXVl
c3RfbW91bnQoY3R4LCBtb3VudF9pbmZvLT5tbnRmaCwgYXV0aGxpc3QsDQo+ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmYXV0aGxpc3RfbGVuKTsNCj4gICAgICAgICBp
ZiAoc3RhdHVzKQ0KPiAgICAgICAgICAgICAgICAgcmV0dXJuIEVSUl9QVFIoc3RhdHVzKTsNCj4g
QEAgLTg1OCwxMCArODU5LDEwIEBAIHN0YXRpYyBzdHJ1Y3QgbmZzX3NlcnZlcg0KPiAqbmZzX3Ry
eV9tb3VudF9yZXF1ZXN0KHN0cnVjdCBuZnNfbW91bnRfaW5mbyAqbW91bnRfaW5mDQo+ICAgICAg
ICAgICogV2FzIGEgc2VjPSBhdXRoZmxhdm9yIHNwZWNpZmllZCBpbiB0aGUgb3B0aW9ucz8gRmly
c3QsDQo+IHZlcmlmeQ0KPiAgICAgICAgICAqIHdoZXRoZXIgdGhlIHNlcnZlciBzdXBwb3J0cyBp
dCwgYW5kIHRoZW4ganVzdCB0cnkgdG8gdXNlDQo+IGl0IGlmIHNvLg0KPiAgICAgICAgICAqLw0K
PiAtICAgICAgIGlmIChhcmdzLT5hdXRoX2luZm8uZmxhdm9yX2xlbiA+IDApIHsNCj4gLSAgICAg
ICAgICAgICAgIHN0YXR1cyA9IG5mc192ZXJpZnlfYXV0aGZsYXZvcnMoYXJncywgYXV0aGxpc3Qs
DQo+IGF1dGhsaXN0X2xlbik7DQo+ICsgICAgICAgaWYgKGN0eC0+YXV0aF9pbmZvLmZsYXZvcl9s
ZW4gPiAwKSB7DQo+ICsgICAgICAgICAgICAgICBzdGF0dXMgPSBuZnNfdmVyaWZ5X2F1dGhmbGF2
b3JzKGN0eCwgYXV0aGxpc3QsDQo+IGF1dGhsaXN0X2xlbik7DQo+ICAgICAgICAgICAgICAgICBk
ZnByaW50ayhNT1VOVCwgIk5GUzogdXNpbmcgYXV0aCBmbGF2b3IgJXVcbiIsDQo+IC0gICAgICAg
ICAgICAgICAgICAgICAgICBhcmdzLT5zZWxlY3RlZF9mbGF2b3IpOw0KPiArICAgICAgICAgICAg
ICAgICAgICAgICAgY3R4LT5zZWxlY3RlZF9mbGF2b3IpOw0KPiAgICAgICAgICAgICAgICAgaWYg
KHN0YXR1cykNCj4gICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEVSUl9QVFIoc3RhdHVz
KTsNCj4gICAgICAgICAgICAgICAgIHJldHVybiBuZnNfbW9kLT5ycGNfb3BzLT5jcmVhdGVfc2Vy
dmVyKG1vdW50X2luZm8pOw0KPiBAQCAtODkwLDcgKzg5MSw3IEBAIHN0YXRpYyBzdHJ1Y3QgbmZz
X3NlcnZlcg0KPiAqbmZzX3RyeV9tb3VudF9yZXF1ZXN0KHN0cnVjdCBuZnNfbW91bnRfaW5mbyAq
bW91bnRfaW5mDQo+ICAgICAgICAgICAgICAgICAgICAgICAgIC8qIEZhbGx0aHJvdWdoICovDQo+
ICAgICAgICAgICAgICAgICB9DQo+ICAgICAgICAgICAgICAgICBkZnByaW50ayhNT1VOVCwgIk5G
UzogYXR0ZW1wdGluZyB0byB1c2UgYXV0aCBmbGF2b3INCj4gJXVcbiIsIGZsYXZvcik7DQo+IC0g
ICAgICAgICAgICAgICBhcmdzLT5zZWxlY3RlZF9mbGF2b3IgPSBmbGF2b3I7DQo+ICsgICAgICAg
ICAgICAgICBjdHgtPnNlbGVjdGVkX2ZsYXZvciA9IGZsYXZvcjsNCj4gICAgICAgICAgICAgICAg
IHNlcnZlciA9IG5mc19tb2QtPnJwY19vcHMtPmNyZWF0ZV9zZXJ2ZXIobW91bnRfaW5mbyk7DQo+
ICAgICAgICAgICAgICAgICBpZiAoIUlTX0VSUihzZXJ2ZXIpKQ0KPiAgICAgICAgICAgICAgICAg
ICAgICAgICByZXR1cm4gc2VydmVyOw0KPiBAQCAtOTA2LDcgKzkwNyw3IEBAIHN0YXRpYyBzdHJ1
Y3QgbmZzX3NlcnZlcg0KPiAqbmZzX3RyeV9tb3VudF9yZXF1ZXN0KHN0cnVjdCBuZnNfbW91bnRf
aW5mbyAqbW91bnRfaW5mDQo+IA0KPiAgICAgICAgIC8qIExhc3QgY2hhbmNlISBUcnkgQVVUSF9V
TklYICovDQo+ICAgICAgICAgZGZwcmludGsoTU9VTlQsICJORlM6IGF0dGVtcHRpbmcgdG8gdXNl
IGF1dGggZmxhdm9yICV1XG4iLA0KPiBSUENfQVVUSF9VTklYKTsNCj4gLSAgICAgICBhcmdzLT5z
ZWxlY3RlZF9mbGF2b3IgPSBSUENfQVVUSF9VTklYOw0KPiArICAgICAgIGN0eC0+c2VsZWN0ZWRf
Zmxhdm9yID0gUlBDX0FVVEhfVU5JWDsNCj4gICAgICAgICByZXR1cm4gbmZzX21vZC0+cnBjX29w
cy0+Y3JlYXRlX3NlcnZlcihtb3VudF9pbmZvKTsNCj4gIH0NCj4gDQo+IEBAIC05MTYsNyArOTE3
LDcgQEAgc3RydWN0IGRlbnRyeSAqbmZzX3RyeV9tb3VudChpbnQgZmxhZ3MsIGNvbnN0DQo+IGNo
YXIgKmRldl9uYW1lLA0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBuZnNf
bW91bnRfaW5mbyAqbW91bnRfaW5mbykNCj4gIHsNCj4gICAgICAgICBzdHJ1Y3QgbmZzX3N1YnZl
cnNpb24gKm5mc19tb2QgPSBtb3VudF9pbmZvLT5uZnNfbW9kOw0KPiAtICAgICAgIGlmIChtb3Vu
dF9pbmZvLT5wYXJzZWQtPm5lZWRfbW91bnQpDQo+ICsgICAgICAgaWYgKG1vdW50X2luZm8tPmN0
eC0+bmVlZF9tb3VudCkNCj4gICAgICAgICAgICAgICAgIG1vdW50X2luZm8tPnNlcnZlciA9DQo+
IG5mc190cnlfbW91bnRfcmVxdWVzdChtb3VudF9pbmZvKTsNCj4gICAgICAgICBlbHNlDQo+ICAg
ICAgICAgICAgICAgICBtb3VudF9pbmZvLT5zZXJ2ZXIgPSBuZnNfbW9kLT5ycGNfb3BzLQ0KPiA+
Y3JlYXRlX3NlcnZlcihtb3VudF9pbmZvKTsNCj4gQEAgLTk0MCwyNCArOTQxLDI0IEBAIEVYUE9S
VF9TWU1CT0xfR1BMKG5mc190cnlfbW91bnQpOw0KPiANCj4gIHN0YXRpYyBpbnQNCj4gIG5mc19j
b21wYXJlX3JlbW91bnRfZGF0YShzdHJ1Y3QgbmZzX3NlcnZlciAqbmZzcywNCj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgIHN0cnVjdCBuZnNfcGFyc2VkX21vdW50X2RhdGEgKmRhdGEpDQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgbmZzX2ZzX2NvbnRleHQgKmN0eCkNCj4gIHsN
Cj4gLSAgICAgICBpZiAoKGRhdGEtPmZsYWdzIF4gbmZzcy0+ZmxhZ3MpICYgTkZTX1JFTU9VTlRf
Q01QX0ZMQUdNQVNLIHx8DQo+IC0gICAgICAgICAgIGRhdGEtPnJzaXplICE9IG5mc3MtPnJzaXpl
IHx8DQo+IC0gICAgICAgICAgIGRhdGEtPndzaXplICE9IG5mc3MtPndzaXplIHx8DQo+IC0gICAg
ICAgICAgIGRhdGEtPnZlcnNpb24gIT0gbmZzcy0+bmZzX2NsaWVudC0+cnBjX29wcy0+dmVyc2lv
biB8fA0KPiAtICAgICAgICAgICBkYXRhLT5taW5vcnZlcnNpb24gIT0gbmZzcy0+bmZzX2NsaWVu
dC0+Y2xfbWlub3J2ZXJzaW9uDQo+IHx8DQo+IC0gICAgICAgICAgIGRhdGEtPnJldHJhbnMgIT0g
bmZzcy0+Y2xpZW50LT5jbF90aW1lb3V0LT50b19yZXRyaWVzIHx8DQo+IC0gICAgICAgICAgICFu
ZnNfYXV0aF9pbmZvX21hdGNoKCZkYXRhLT5hdXRoX2luZm8sIG5mc3MtPmNsaWVudC0NCj4gPmNs
X2F1dGgtPmF1X2ZsYXZvcikgfHwNCj4gLSAgICAgICAgICAgZGF0YS0+YWNyZWdtaW4gIT0gbmZz
cy0+YWNyZWdtaW4gLyBIWiB8fA0KPiAtICAgICAgICAgICBkYXRhLT5hY3JlZ21heCAhPSBuZnNz
LT5hY3JlZ21heCAvIEhaIHx8DQo+IC0gICAgICAgICAgIGRhdGEtPmFjZGlybWluICE9IG5mc3Mt
PmFjZGlybWluIC8gSFogfHwNCj4gLSAgICAgICAgICAgZGF0YS0+YWNkaXJtYXggIT0gbmZzcy0+
YWNkaXJtYXggLyBIWiB8fA0KPiAtICAgICAgICAgICBkYXRhLT50aW1lbyAhPSAoMTBVICogbmZz
cy0+Y2xpZW50LT5jbF90aW1lb3V0LQ0KPiA+dG9faW5pdHZhbCAvIEhaKSB8fA0KPiAtICAgICAg
ICAgICAoZGF0YS0+b3B0aW9ucyAmIE5GU19PUFRJT05fRlNDQUNIRSkgIT0gKG5mc3MtPm9wdGlv
bnMgJg0KPiBORlNfT1BUSU9OX0ZTQ0FDSEUpIHx8DQo+IC0gICAgICAgICAgIGRhdGEtPm5mc19z
ZXJ2ZXIucG9ydCAhPSBuZnNzLT5wb3J0IHx8DQo+IC0gICAgICAgICAgIGRhdGEtPm5mc19zZXJ2
ZXIuYWRkcmxlbiAhPSBuZnNzLT5uZnNfY2xpZW50LT5jbF9hZGRybGVuDQo+IHx8DQo+IC0gICAg
ICAgICAgICFycGNfY21wX2FkZHIoKHN0cnVjdCBzb2NrYWRkciAqKSZkYXRhLQ0KPiA+bmZzX3Nl
cnZlci5hZGRyZXNzLA0KPiArICAgICAgIGlmICgoY3R4LT5mbGFncyBeIG5mc3MtPmZsYWdzKSAm
IE5GU19SRU1PVU5UX0NNUF9GTEFHTUFTSyB8fA0KPiArICAgICAgICAgICBjdHgtPnJzaXplICE9
IG5mc3MtPnJzaXplIHx8DQo+ICsgICAgICAgICAgIGN0eC0+d3NpemUgIT0gbmZzcy0+d3NpemUg
fHwNCj4gKyAgICAgICAgICAgY3R4LT52ZXJzaW9uICE9IG5mc3MtPm5mc19jbGllbnQtPnJwY19v
cHMtPnZlcnNpb24gfHwNCj4gKyAgICAgICAgICAgY3R4LT5taW5vcnZlcnNpb24gIT0gbmZzcy0+
bmZzX2NsaWVudC0+Y2xfbWlub3J2ZXJzaW9uIHx8DQo+ICsgICAgICAgICAgIGN0eC0+cmV0cmFu
cyAhPSBuZnNzLT5jbGllbnQtPmNsX3RpbWVvdXQtPnRvX3JldHJpZXMgfHwNCj4gKyAgICAgICAg
ICAgIW5mc19hdXRoX2luZm9fbWF0Y2goJmN0eC0+YXV0aF9pbmZvLCBuZnNzLT5jbGllbnQtDQo+
ID5jbF9hdXRoLT5hdV9mbGF2b3IpIHx8DQo+ICsgICAgICAgICAgIGN0eC0+YWNyZWdtaW4gIT0g
bmZzcy0+YWNyZWdtaW4gLyBIWiB8fA0KPiArICAgICAgICAgICBjdHgtPmFjcmVnbWF4ICE9IG5m
c3MtPmFjcmVnbWF4IC8gSFogfHwNCj4gKyAgICAgICAgICAgY3R4LT5hY2Rpcm1pbiAhPSBuZnNz
LT5hY2Rpcm1pbiAvIEhaIHx8DQo+ICsgICAgICAgICAgIGN0eC0+YWNkaXJtYXggIT0gbmZzcy0+
YWNkaXJtYXggLyBIWiB8fA0KPiArICAgICAgICAgICBjdHgtPnRpbWVvICE9ICgxMFUgKiBuZnNz
LT5jbGllbnQtPmNsX3RpbWVvdXQtPnRvX2luaXR2YWwgDQo+IC8gSFopIHx8DQo+ICsgICAgICAg
ICAgIChjdHgtPm9wdGlvbnMgJiBORlNfT1BUSU9OX0ZTQ0FDSEUpICE9IChuZnNzLT5vcHRpb25z
ICYNCj4gTkZTX09QVElPTl9GU0NBQ0hFKSB8fA0KPiArICAgICAgICAgICBjdHgtPm5mc19zZXJ2
ZXIucG9ydCAhPSBuZnNzLT5wb3J0IHx8DQo+ICsgICAgICAgICAgIGN0eC0+bmZzX3NlcnZlci5h
ZGRybGVuICE9IG5mc3MtPm5mc19jbGllbnQtPmNsX2FkZHJsZW4NCj4gfHwNCj4gKyAgICAgICAg
ICAgIXJwY19jbXBfYWRkcigoc3RydWN0IHNvY2thZGRyICopJmN0eC0NCj4gPm5mc19zZXJ2ZXIu
YWRkcmVzcywNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAoc3RydWN0IHNvY2thZGRyICop
Jm5mc3MtPm5mc19jbGllbnQtDQo+ID5jbF9hZGRyKSkNCj4gICAgICAgICAgICAgICAgIHJldHVy
biAtRUlOVkFMOw0KPiANCj4gQEAgLTk2OSw3ICs5NzAsNyBAQCBuZnNfcmVtb3VudChzdHJ1Y3Qg
c3VwZXJfYmxvY2sgKnNiLCBpbnQgKmZsYWdzLA0KPiBjaGFyICpyYXdfZGF0YSkNCj4gIHsNCj4g
ICAgICAgICBpbnQgZXJyb3I7DQo+ICAgICAgICAgc3RydWN0IG5mc19zZXJ2ZXIgKm5mc3MgPSBz
Yi0+c19mc19pbmZvOw0KPiAtICAgICAgIHN0cnVjdCBuZnNfcGFyc2VkX21vdW50X2RhdGEgKmRh
dGE7DQo+ICsgICAgICAgc3RydWN0IG5mc19mc19jb250ZXh0ICpjdHg7DQo+ICAgICAgICAgc3Ry
dWN0IG5mc19tb3VudF9kYXRhICpvcHRpb25zID0gKHN0cnVjdCBuZnNfbW91bnRfZGF0YQ0KPiAq
KXJhd19kYXRhOw0KPiAgICAgICAgIHN0cnVjdCBuZnM0X21vdW50X2RhdGEgKm9wdGlvbnM0ID0g
KHN0cnVjdCBuZnM0X21vdW50X2RhdGENCj4gKilyYXdfZGF0YTsNCj4gICAgICAgICB1MzIgbmZz
dmVycyA9IG5mc3MtPm5mc19jbGllbnQtPnJwY19vcHMtPnZlcnNpb247DQo+IEBAIC05ODcsMzIg
Kzk4OCwzMiBAQCBuZnNfcmVtb3VudChzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCBpbnQgKmZsYWdz
LA0KPiBjaGFyICpyYXdfZGF0YSkNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIG9wdGlvbnMtPnZlcnNpb24gPD0gNikpKSkNCj4gICAgICAgICAgICAgICAgIHJl
dHVybiAwOw0KPiANCj4gLSAgICAgICBkYXRhID0gbmZzX2FsbG9jX3BhcnNlZF9tb3VudF9kYXRh
KCk7DQo+IC0gICAgICAgaWYgKGRhdGEgPT0gTlVMTCkNCj4gKyAgICAgICBjdHggPSBuZnNfYWxs
b2NfcGFyc2VkX21vdW50X2RhdGEoKTsNCj4gKyAgICAgICBpZiAoY3R4ID09IE5VTEwpDQo+ICAg
ICAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsNCj4gDQo+ICAgICAgICAgLyogZmlsbCBvdXQg
c3RydWN0IHdpdGggdmFsdWVzIGZyb20gZXhpc3RpbmcgbW91bnQgKi8NCj4gLSAgICAgICBkYXRh
LT5mbGFncyA9IG5mc3MtPmZsYWdzOw0KPiAtICAgICAgIGRhdGEtPnJzaXplID0gbmZzcy0+cnNp
emU7DQo+IC0gICAgICAgZGF0YS0+d3NpemUgPSBuZnNzLT53c2l6ZTsNCj4gLSAgICAgICBkYXRh
LT5yZXRyYW5zID0gbmZzcy0+Y2xpZW50LT5jbF90aW1lb3V0LT50b19yZXRyaWVzOw0KPiAtICAg
ICAgIGRhdGEtPnNlbGVjdGVkX2ZsYXZvciA9IG5mc3MtPmNsaWVudC0+Y2xfYXV0aC0+YXVfZmxh
dm9yOw0KPiAtICAgICAgIGRhdGEtPmFjcmVnbWluID0gbmZzcy0+YWNyZWdtaW4gLyBIWjsNCj4g
LSAgICAgICBkYXRhLT5hY3JlZ21heCA9IG5mc3MtPmFjcmVnbWF4IC8gSFo7DQo+IC0gICAgICAg
ZGF0YS0+YWNkaXJtaW4gPSBuZnNzLT5hY2Rpcm1pbiAvIEhaOw0KPiAtICAgICAgIGRhdGEtPmFj
ZGlybWF4ID0gbmZzcy0+YWNkaXJtYXggLyBIWjsNCj4gLSAgICAgICBkYXRhLT50aW1lbyA9IDEw
VSAqIG5mc3MtPmNsaWVudC0+Y2xfdGltZW91dC0+dG9faW5pdHZhbCAvDQo+IEhaOw0KPiAtICAg
ICAgIGRhdGEtPm5mc19zZXJ2ZXIucG9ydCA9IG5mc3MtPnBvcnQ7DQo+IC0gICAgICAgZGF0YS0+
bmZzX3NlcnZlci5hZGRybGVuID0gbmZzcy0+bmZzX2NsaWVudC0+Y2xfYWRkcmxlbjsNCj4gLSAg
ICAgICBkYXRhLT52ZXJzaW9uID0gbmZzdmVyczsNCj4gLSAgICAgICBkYXRhLT5taW5vcnZlcnNp
b24gPSBuZnNzLT5uZnNfY2xpZW50LT5jbF9taW5vcnZlcnNpb247DQo+IC0gICAgICAgZGF0YS0+
bmV0ID0gY3VycmVudC0+bnNwcm94eS0+bmV0X25zOw0KPiAtICAgICAgIG1lbWNweSgmZGF0YS0+
bmZzX3NlcnZlci5hZGRyZXNzLCAmbmZzcy0+bmZzX2NsaWVudC0+Y2xfYWRkciwNCj4gLSAgICAg
ICAgICAgICAgIGRhdGEtPm5mc19zZXJ2ZXIuYWRkcmxlbik7DQo+ICsgICAgICAgY3R4LT5mbGFn
cyA9IG5mc3MtPmZsYWdzOw0KPiArICAgICAgIGN0eC0+cnNpemUgPSBuZnNzLT5yc2l6ZTsNCj4g
KyAgICAgICBjdHgtPndzaXplID0gbmZzcy0+d3NpemU7DQo+ICsgICAgICAgY3R4LT5yZXRyYW5z
ID0gbmZzcy0+Y2xpZW50LT5jbF90aW1lb3V0LT50b19yZXRyaWVzOw0KPiArICAgICAgIGN0eC0+
c2VsZWN0ZWRfZmxhdm9yID0gbmZzcy0+Y2xpZW50LT5jbF9hdXRoLT5hdV9mbGF2b3I7DQo+ICsg
ICAgICAgY3R4LT5hY3JlZ21pbiA9IG5mc3MtPmFjcmVnbWluIC8gSFo7DQo+ICsgICAgICAgY3R4
LT5hY3JlZ21heCA9IG5mc3MtPmFjcmVnbWF4IC8gSFo7DQo+ICsgICAgICAgY3R4LT5hY2Rpcm1p
biA9IG5mc3MtPmFjZGlybWluIC8gSFo7DQo+ICsgICAgICAgY3R4LT5hY2Rpcm1heCA9IG5mc3Mt
PmFjZGlybWF4IC8gSFo7DQo+ICsgICAgICAgY3R4LT50aW1lbyA9IDEwVSAqIG5mc3MtPmNsaWVu
dC0+Y2xfdGltZW91dC0+dG9faW5pdHZhbCAvIEhaOw0KPiArICAgICAgIGN0eC0+bmZzX3NlcnZl
ci5wb3J0ID0gbmZzcy0+cG9ydDsNCj4gKyAgICAgICBjdHgtPm5mc19zZXJ2ZXIuYWRkcmxlbiA9
IG5mc3MtPm5mc19jbGllbnQtPmNsX2FkZHJsZW47DQo+ICsgICAgICAgY3R4LT52ZXJzaW9uID0g
bmZzdmVyczsNCj4gKyAgICAgICBjdHgtPm1pbm9ydmVyc2lvbiA9IG5mc3MtPm5mc19jbGllbnQt
PmNsX21pbm9ydmVyc2lvbjsNCj4gKyAgICAgICBjdHgtPm5ldCA9IGN1cnJlbnQtPm5zcHJveHkt
Pm5ldF9uczsNCj4gKyAgICAgICBtZW1jcHkoJmN0eC0+bmZzX3NlcnZlci5hZGRyZXNzLCAmbmZz
cy0+bmZzX2NsaWVudC0+Y2xfYWRkciwNCj4gKyAgICAgICAgICAgICAgIGN0eC0+bmZzX3NlcnZl
ci5hZGRybGVuKTsNCj4gDQo+ICAgICAgICAgLyogb3ZlcndyaXRlIHRob3NlIHZhbHVlcyB3aXRo
IGFueSB0aGF0IHdlcmUgc3BlY2lmaWVkICovDQo+ICAgICAgICAgZXJyb3IgPSAtRUlOVkFMOw0K
PiAtICAgICAgIGlmICghbmZzX3BhcnNlX21vdW50X29wdGlvbnMoKGNoYXIgKilvcHRpb25zLCBk
YXRhKSkNCj4gKyAgICAgICBpZiAoIW5mc19wYXJzZV9tb3VudF9vcHRpb25zKChjaGFyICopb3B0
aW9ucywgY3R4KSkNCj4gICAgICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiANCj4gICAgICAgICAv
Kg0KPiBAQCAtMTAyMSwxNSArMTAyMiwxNSBAQCBuZnNfcmVtb3VudChzdHJ1Y3Qgc3VwZXJfYmxv
Y2sgKnNiLCBpbnQNCj4gKmZsYWdzLCBjaGFyICpyYXdfZGF0YSkNCj4gICAgICAgICAgKiB3aWxs
IGNsZWFyIFNCX1NZTkNIUk9OT1VTIGlmIC1vIHN5bmMgd2Fzbid0IHNwZWNpZmllZCBpbg0KPiB0
aGUNCj4gICAgICAgICAgKiByZW1vdW50IG9wdGlvbnMsIHNvIHdlIGhhdmUgdG8gZXhwbGljaXRs
eSByZXNldCBpdC4NCj4gICAgICAgICAgKi8NCj4gLSAgICAgICBpZiAoZGF0YS0+ZmxhZ3MgJiBO
RlNfTU9VTlRfTk9BQykNCj4gKyAgICAgICBpZiAoY3R4LT5mbGFncyAmIE5GU19NT1VOVF9OT0FD
KQ0KPiAgICAgICAgICAgICAgICAgKmZsYWdzIHw9IFNCX1NZTkNIUk9OT1VTOw0KPiANCj4gICAg
ICAgICAvKiBjb21wYXJlIG5ldyBtb3VudCBvcHRpb25zIHdpdGggb2xkIG9uZXMgKi8NCj4gLSAg
ICAgICBlcnJvciA9IG5mc19jb21wYXJlX3JlbW91bnRfZGF0YShuZnNzLCBkYXRhKTsNCj4gKyAg
ICAgICBlcnJvciA9IG5mc19jb21wYXJlX3JlbW91bnRfZGF0YShuZnNzLCBjdHgpOw0KPiAgICAg
ICAgIGlmICghZXJyb3IpDQo+IC0gICAgICAgICAgICAgICBlcnJvciA9IHNlY3VyaXR5X3NiX3Jl
bW91bnQoc2IsIGRhdGEtPmxzbV9vcHRzKTsNCj4gKyAgICAgICAgICAgICAgIGVycm9yID0gc2Vj
dXJpdHlfc2JfcmVtb3VudChzYiwgY3R4LT5sc21fb3B0cyk7DQo+ICBvdXQ6DQo+IC0gICAgICAg
bmZzX2ZyZWVfcGFyc2VkX21vdW50X2RhdGEoZGF0YSk7DQo+ICsgICAgICAgbmZzX2ZyZWVfcGFy
c2VkX21vdW50X2RhdGEoY3R4KTsNCj4gICAgICAgICByZXR1cm4gZXJyb3I7DQo+ICB9DQo+ICBF
WFBPUlRfU1lNQk9MX0dQTChuZnNfcmVtb3VudCk7DQo+IEBAIC0xMDM5LDE1ICsxMDQwLDE1IEBA
IEVYUE9SVF9TWU1CT0xfR1BMKG5mc19yZW1vdW50KTsNCj4gICAqLw0KPiAgc3RhdGljIHZvaWQg
bmZzX2ZpbGxfc3VwZXIoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgc3RydWN0DQo+IG5mc19tb3Vu
dF9pbmZvICptb3VudF9pbmZvKQ0KPiAgew0KPiAtICAgICAgIHN0cnVjdCBuZnNfcGFyc2VkX21v
dW50X2RhdGEgKmRhdGEgPSBtb3VudF9pbmZvLT5wYXJzZWQ7DQo+ICsgICAgICAgc3RydWN0IG5m
c19mc19jb250ZXh0ICpjdHggPSBtb3VudF9pbmZvLT5jdHg7DQo+ICAgICAgICAgc3RydWN0IG5m
c19zZXJ2ZXIgKnNlcnZlciA9IE5GU19TQihzYik7DQo+IA0KPiAgICAgICAgIHNiLT5zX2Jsb2Nr
c2l6ZV9iaXRzID0gMDsNCj4gICAgICAgICBzYi0+c19ibG9ja3NpemUgPSAwOw0KPiAgICAgICAg
IHNiLT5zX3hhdHRyID0gc2VydmVyLT5uZnNfY2xpZW50LT5jbF9uZnNfbW9kLT54YXR0cjsNCj4g
ICAgICAgICBzYi0+c19vcCA9IHNlcnZlci0+bmZzX2NsaWVudC0+Y2xfbmZzX21vZC0+c29wczsN
Cj4gLSAgICAgICBpZiAoZGF0YSAmJiBkYXRhLT5ic2l6ZSkNCj4gLSAgICAgICAgICAgICAgIHNi
LT5zX2Jsb2Nrc2l6ZSA9IG5mc19ibG9ja19zaXplKGRhdGEtPmJzaXplLCAmc2ItDQo+ID5zX2Js
b2Nrc2l6ZV9iaXRzKTsNCj4gKyAgICAgICBpZiAoY3R4ICYmIGN0eC0+YnNpemUpDQo+ICsgICAg
ICAgICAgICAgICBzYi0+c19ibG9ja3NpemUgPSBuZnNfYmxvY2tfc2l6ZShjdHgtPmJzaXplLCAm
c2ItDQo+ID5zX2Jsb2Nrc2l6ZV9iaXRzKTsNCj4gDQo+ICAgICAgICAgaWYgKHNlcnZlci0+bmZz
X2NsaWVudC0+cnBjX29wcy0+dmVyc2lvbiAhPSAyKSB7DQo+ICAgICAgICAgICAgICAgICAvKiBU
aGUgVkZTIHNob3VsZG4ndCBhcHBseSB0aGUgdW1hc2sgdG8gbW9kZSBiaXRzLiBXZQ0KPiB3aWxs
IGRvDQo+IEBAIC0xMTk5LDcgKzEyMDAsNyBAQCBzdGF0aWMgaW50IG5mc19jb21wYXJlX3N1cGVy
KHN0cnVjdCBzdXBlcl9ibG9jaw0KPiAqc2IsIHZvaWQgKmRhdGEpDQo+IA0KPiAgI2lmZGVmIENP
TkZJR19ORlNfRlNDQUNIRQ0KPiAgc3RhdGljIHZvaWQgbmZzX2dldF9jYWNoZV9jb29raWUoc3Ry
dWN0IHN1cGVyX2Jsb2NrICpzYiwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
c3RydWN0IG5mc19wYXJzZWRfbW91bnRfZGF0YQ0KPiAqcGFyc2VkLA0KPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgbmZzX2ZzX2NvbnRleHQgKmN0eCwNCj4gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IG5mc19jbG9uZV9tb3VudCAqY2xvbmVk
KQ0KPiAgew0KPiAgICAgICAgIHN0cnVjdCBuZnNfc2VydmVyICpuZnNzID0gTkZTX1NCKHNiKTsN
Cj4gQEAgLTEyMDksMTIgKzEyMTAsMTIgQEAgc3RhdGljIHZvaWQgbmZzX2dldF9jYWNoZV9jb29r
aWUoc3RydWN0DQo+IHN1cGVyX2Jsb2NrICpzYiwNCj4gICAgICAgICBuZnNzLT5mc2NhY2hlX2tl
eSA9IE5VTEw7DQo+ICAgICAgICAgbmZzcy0+ZnNjYWNoZSA9IE5VTEw7DQo+IA0KPiAtICAgICAg
IGlmIChwYXJzZWQpIHsNCj4gLSAgICAgICAgICAgICAgIGlmICghKHBhcnNlZC0+b3B0aW9ucyAm
IE5GU19PUFRJT05fRlNDQUNIRSkpDQo+ICsgICAgICAgaWYgKGN0eCkgew0KPiArICAgICAgICAg
ICAgICAgaWYgKCEoY3R4LT5vcHRpb25zICYgTkZTX09QVElPTl9GU0NBQ0hFKSkNCj4gICAgICAg
ICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KPiAtICAgICAgICAgICAgICAgaWYgKHBhcnNlZC0+
ZnNjYWNoZV91bmlxKSB7DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIHVuaXEgPSBwYXJzZWQt
PmZzY2FjaGVfdW5pcTsNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgdWxlbiA9IHN0cmxlbihw
YXJzZWQtPmZzY2FjaGVfdW5pcSk7DQo+ICsgICAgICAgICAgICAgICBpZiAoY3R4LT5mc2NhY2hl
X3VuaXEpIHsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgdW5pcSA9IGN0eC0+ZnNjYWNoZV91
bmlxOw0KPiArICAgICAgICAgICAgICAgICAgICAgICB1bGVuID0gc3RybGVuKGN0eC0+ZnNjYWNo
ZV91bmlxKTsNCj4gICAgICAgICAgICAgICAgIH0NCj4gICAgICAgICB9IGVsc2UgaWYgKGNsb25l
ZCkgew0KPiAgICAgICAgICAgICAgICAgc3RydWN0IG5mc19zZXJ2ZXIgKm1udF9zID0gTkZTX1NC
KGNsb25lZC0+c2IpOw0KPiBAQCAtMTIzMSw3ICsxMjMyLDcgQEAgc3RhdGljIHZvaWQgbmZzX2dl
dF9jYWNoZV9jb29raWUoc3RydWN0DQo+IHN1cGVyX2Jsb2NrICpzYiwNCj4gIH0NCj4gICNlbHNl
DQo+ICBzdGF0aWMgdm9pZCBuZnNfZ2V0X2NhY2hlX2Nvb2tpZShzdHJ1Y3Qgc3VwZXJfYmxvY2sg
KnNiLA0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgbmZzX3BhcnNl
ZF9tb3VudF9kYXRhDQo+ICpwYXJzZWQsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHN0cnVjdCBuZnNfZnNfY29udGV4dCAqcGFyc2VkLA0KPiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBzdHJ1Y3QgbmZzX2Nsb25lX21vdW50ICpjbG9uZWQpDQo+ICB7DQo+ICB9
DQo+IEBAIC0xMjk2LDcgKzEyOTcsNyBAQCBzdGF0aWMgc3RydWN0IGRlbnRyeSAqbmZzX2ZzX21v
dW50X2NvbW1vbihpbnQNCj4gZmxhZ3MsIGNvbnN0IGNoYXIgKmRldl9uYW1lLA0KPiAgICAgICAg
ICAgICAgICAgICAgICAgICBzLT5zX2Jsb2Nrc2l6ZV9iaXRzID0gYnNpemU7DQo+ICAgICAgICAg
ICAgICAgICAgICAgICAgIHMtPnNfYmxvY2tzaXplID0gMVUgPDwgYnNpemU7DQo+ICAgICAgICAg
ICAgICAgICB9DQo+IC0gICAgICAgICAgICAgICBuZnNfZ2V0X2NhY2hlX2Nvb2tpZShzLCBtb3Vu
dF9pbmZvLT5wYXJzZWQsDQo+IG1vdW50X2luZm8tPmNsb25lZCk7DQo+ICsgICAgICAgICAgICAg
ICBuZnNfZ2V0X2NhY2hlX2Nvb2tpZShzLCBtb3VudF9pbmZvLT5jdHgsIG1vdW50X2luZm8tDQo+
ID5jbG9uZWQpOw0KPiAgICAgICAgICAgICAgICAgaWYgKCEoc2VydmVyLT5mbGFncyAmIE5GU19N
T1VOVF9VTlNIQVJFRCkpDQo+ICAgICAgICAgICAgICAgICAgICAgICAgIHMtPnNfaWZsYWdzIHw9
IFNCX0lfTVVMVElST09UOw0KPiAgICAgICAgIH0NCj4gQEAgLTEzMTcsNyArMTMxOCw3IEBAIHN0
YXRpYyBzdHJ1Y3QgZGVudHJ5ICpuZnNfZnNfbW91bnRfY29tbW9uKGludA0KPiBmbGFncywgY29u
c3QgY2hhciAqZGV2X25hbWUsDQo+ICAgICAgICAgICAgICAgICBlcnJvciA9IHNlY3VyaXR5X3Ni
X2Nsb25lX21udF9vcHRzKG1vdW50X2luZm8tDQo+ID5jbG9uZWQtPnNiLCBzLCBrZmxhZ3MsDQo+
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmtmbGFnc19vdXQpOw0KPiAgICAgICAg
IH0gZWxzZSB7DQo+IC0gICAgICAgICAgICAgICBlcnJvciA9IHNlY3VyaXR5X3NiX3NldF9tbnRf
b3B0cyhzLCBtb3VudF9pbmZvLQ0KPiA+cGFyc2VkLT5sc21fb3B0cywNCj4gKyAgICAgICAgICAg
ICAgIGVycm9yID0gc2VjdXJpdHlfc2Jfc2V0X21udF9vcHRzKHMsIG1vdW50X2luZm8tPmN0eC0N
Cj4gPmxzbV9vcHRzLA0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGtmbGFncywNCj4gJmtmbGFnc19vdXQpOw0KPiAgICAgICAgIH0NCj4g
ICAgICAgICBpZiAoZXJyb3IpDQo+IEBAIC0xMzU0LDIxICsxMzU1LDIyIEBAIHN0cnVjdCBkZW50
cnkgKm5mc19mc19tb3VudChzdHJ1Y3QNCj4gZmlsZV9zeXN0ZW1fdHlwZSAqZnNfdHlwZSwNCj4g
ICAgICAgICBzdHJ1Y3QgbmZzX3N1YnZlcnNpb24gKm5mc19tb2Q7DQo+ICAgICAgICAgaW50IGVy
cm9yOw0KPiANCj4gLSAgICAgICBtb3VudF9pbmZvLnBhcnNlZCA9IG5mc19hbGxvY19wYXJzZWRf
bW91bnRfZGF0YSgpOw0KPiArICAgICAgIG1vdW50X2luZm8uY3R4ID0gbmZzX2FsbG9jX3BhcnNl
ZF9tb3VudF9kYXRhKCk7DQo+ICAgICAgICAgbW91bnRfaW5mby5tbnRmaCA9IG5mc19hbGxvY19m
aGFuZGxlKCk7DQo+IC0gICAgICAgaWYgKG1vdW50X2luZm8ucGFyc2VkID09IE5VTEwgfHwgbW91
bnRfaW5mby5tbnRmaCA9PSBOVUxMKQ0KPiArICAgICAgIGlmIChtb3VudF9pbmZvLmN0eCA9PSBO
VUxMIHx8IG1vdW50X2luZm8ubW50ZmggPT0gTlVMTCkNCj4gICAgICAgICAgICAgICAgIGdvdG8g
b3V0Ow0KPiANCj4gICAgICAgICAvKiBWYWxpZGF0ZSB0aGUgbW91bnQgZGF0YSAqLw0KPiAtICAg
ICAgIGVycm9yID0gbmZzX3ZhbGlkYXRlX21vdW50X2RhdGEoZnNfdHlwZSwgcmF3X2RhdGEsDQo+
IG1vdW50X2luZm8ucGFyc2VkLCBtb3VudF9pbmZvLm1udGZoLCBkZXZfbmFtZSk7DQo+ICsgICAg
ICAgZXJyb3IgPSBuZnNfdmFsaWRhdGVfbW91bnRfZGF0YShmc190eXBlLCByYXdfZGF0YSwNCj4g
bW91bnRfaW5mby5jdHgsIG1vdW50X2luZm8ubW50ZmgsIGRldl9uYW1lKTsNCj4gICAgICAgICBp
ZiAoZXJyb3IgPT0gTkZTX1RFWFRfREFUQSkNCj4gLSAgICAgICAgICAgICAgIGVycm9yID0gbmZz
X3ZhbGlkYXRlX3RleHRfbW91bnRfZGF0YShyYXdfZGF0YSwNCj4gbW91bnRfaW5mby5wYXJzZWQs
IGRldl9uYW1lKTsNCj4gKyAgICAgICAgICAgICAgIGVycm9yID0gbmZzX3ZhbGlkYXRlX3RleHRf
bW91bnRfZGF0YShyYXdfZGF0YSwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBtb3VudF9pbmZvLmN0eCwNCj4gZGV2X25hbWUpOw0KPiAgICAg
ICAgIGlmIChlcnJvciA8IDApIHsNCj4gICAgICAgICAgICAgICAgIG1udHJvb3QgPSBFUlJfUFRS
KGVycm9yKTsNCj4gICAgICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiAgICAgICAgIH0NCj4gDQo+
IC0gICAgICAgbmZzX21vZCA9IGdldF9uZnNfdmVyc2lvbihtb3VudF9pbmZvLnBhcnNlZC0+dmVy
c2lvbik7DQo+ICsgICAgICAgbmZzX21vZCA9IGdldF9uZnNfdmVyc2lvbihtb3VudF9pbmZvLmN0
eC0+dmVyc2lvbik7DQo+ICAgICAgICAgaWYgKElTX0VSUihuZnNfbW9kKSkgew0KPiAgICAgICAg
ICAgICAgICAgbW50cm9vdCA9IEVSUl9DQVNUKG5mc19tb2QpOw0KPiAgICAgICAgICAgICAgICAg
Z290byBvdXQ7DQo+IEBAIC0xMzc5LDcgKzEzODEsNyBAQCBzdHJ1Y3QgZGVudHJ5ICpuZnNfZnNf
bW91bnQoc3RydWN0DQo+IGZpbGVfc3lzdGVtX3R5cGUgKmZzX3R5cGUsDQo+IA0KPiAgICAgICAg
IHB1dF9uZnNfdmVyc2lvbihuZnNfbW9kKTsNCj4gIG91dDoNCj4gLSAgICAgICBuZnNfZnJlZV9w
YXJzZWRfbW91bnRfZGF0YShtb3VudF9pbmZvLnBhcnNlZCk7DQo+ICsgICAgICAgbmZzX2ZyZWVf
cGFyc2VkX21vdW50X2RhdGEobW91bnRfaW5mby5jdHgpOw0KPiAgICAgICAgIG5mc19mcmVlX2Zo
YW5kbGUobW91bnRfaW5mby5tbnRmaCk7DQo+ICAgICAgICAgcmV0dXJuIG1udHJvb3Q7DQo+ICB9
DQo+IC0tDQo+IDIuMTcuMg0KPiANCg==
