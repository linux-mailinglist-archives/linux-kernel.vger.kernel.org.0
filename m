Return-Path: <linux-kernel-owner@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 4EA5C194201
	for <lists+linux-kernel@lfdr.de>; Thu, 26 Mar 2020 15:52:04 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1728367AbgCZOv5 (ORCPT <rfc822;lists+linux-kernel@lfdr.de>);
        Thu, 26 Mar 2020 10:51:57 -0400
Received: from mail-lf1-f67.google.com ([209.85.167.67]:35884 "EHLO
        mail-lf1-f67.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S1728347AbgCZOvz (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Thu, 26 Mar 2020 10:51:55 -0400
Received: by mail-lf1-f67.google.com with SMTP id s1so5071219lfd.3
        for <linux-kernel@vger.kernel.org>; Thu, 26 Mar 2020 07:51:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20161025;
        h=mime-version:references:in-reply-to:from:date:message-id:subject:to
         :cc;
        bh=eS7IJYarcYb9lOpcw99WK/uhX/b1sbzNjR3mcvzNLaM=;
        b=hwiR4bH1c1sgi8xFhbWHo7melUCCYkMLKNTULs35Fwpoy4tBW0B8B6HueDRAwbHGzu
         2jjC1CDW4Dwa13kZ6L6r4vHMf9U0pLJWp8LaWHqXjTw0niu5fslaGgxEbTtp7Uu70m76
         qFrwfvU1eKQ1pG1tlKsKfy8Uh49mD9z3EjzdqIeJmelOZ5wUYVTbbDtGJ1erw+KT/5KA
         HSveZONXKB3JKt++avVzwOmQ7nkz3jVwg8+HMCjFQt9jmR94lKB4x39K6DzrsPAXoYnK
         Lx0DQU4PUJ0ny+4Bn6ll6SNSaHJtsuJ8WlrEyDabzFVRdqyOUuAG3z/PjxX0Pv7al9rd
         v3pg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-gm-message-state:mime-version:references:in-reply-to:from:date
         :message-id:subject:to:cc;
        bh=eS7IJYarcYb9lOpcw99WK/uhX/b1sbzNjR3mcvzNLaM=;
        b=tvYaUNjpozdjuYtZTTZmPwZxWuHjJ9RdXZJWgUok6MbP/8X0zBXRp8XXbUf1AfQwTw
         C3rzJEJtHpKQPI3mKl36LANJreJ+IO+421DgTawKH0IPCw75aOIfOZXR84A9UjZ7HtNl
         6X/4a6Ju/jYC90P1MR0Jvzd3qehzoRwJZmej1vtYpiBpgggxv16IlAZia+ThoiqY+833
         ZsMzxGJWnEBC+CZaC4XBO9n3KVY4CnIz8UDst2HSqTkFVW9mN2/w+S1Ei7K7R622JMs9
         MyD+/ZGj+CxJZALjWHjLhwJnUsUdl1KfIpxU/9v4sFRMhf9Uh4+v/oPw+CW3o4aqmN/j
         Wy2Q==
X-Gm-Message-State: ANhLgQ3U0spVkKFuRbV6HxJDN5hjMVMktQ/SmqZs2KRP4XHgyYN+TQEO
        sYWhobO4i1fWbHQGowLq3U6WB33Y6V8rghPP5Ks=
X-Google-Smtp-Source: ADFU+vvpa668yj/k8wZ12sPdQ2T/7AhRpRR7rcfhjkia3UtG52LpjmQH9E6mr5YmaSXry7li+YGg/oy/QhlOdsSUmNk=
X-Received: by 2002:ac2:41d3:: with SMTP id d19mr6084914lfi.57.1585234309934;
 Thu, 26 Mar 2020 07:51:49 -0700 (PDT)
MIME-Version: 1.0
References: <CAEAjamv3wT4aqF0y1_PHG_=cbzH-ATsP6TiV5Zt5Qc+ACVnOPw@mail.gmail.com>
 <20200323064616.GB129571@kroah.com> <CAEAjamvv7LzaTBu-Xh5rg4r1-_NaDDGVoe9LZ7NmZv3gpLXkuw@mail.gmail.com>
 <20200324121236.GB2333340@kroah.com>
In-Reply-To: <20200324121236.GB2333340@kroah.com>
From:   Kyungtae Kim <kt0755@gmail.com>
Date:   Thu, 26 Mar 2020 10:51:38 -0400
Message-ID: <CAEAjams79+V8bxpcp3UAsU1AnJ+gx2y+ZqhDhjJCpZn2oeZA4Q@mail.gmail.com>
Subject: Re: UBSAN: Undefined behaviour in drivers/tty/vt/keyboard.c
To:     Greg KH <gregkh@linuxfoundation.org>
Cc:     jslaby@suse.com, slyfox@gentoo.org,
        Dmitry Torokhov <dmitry.torokhov@gmail.com>, rei4dan@gmail.com,
        Dave Tian <dave.jing.tian@gmail.com>,
        LKML <linux-kernel@vger.kernel.org>
Content-Type: multipart/mixed; boundary="000000000000eed2f105a1c31f07"
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

--000000000000eed2f105a1c31f07
Content-Type: text/plain; charset="UTF-8"

On Tue, Mar 24, 2020 at 01:12:36PM +0100, Greg KH wrote:
> On Mon, Mar 23, 2020 at 04:44:31PM -0400, Kyungtae Kim wrote:
> > On Mon, Mar 23, 2020 at 07:46:16AM +0100, Greg KH wrote:
> > > On Sun, Mar 22, 2020 at 11:34:01PM -0400, Kyungtae Kim wrote:
> > > > We report a bug (in linux-5.5.11) found by FuzzUSB (modified version
> > > > of syzkaller)
> > > >
> > > > Seems the variable "npadch" has a very large value (i.e., 333333333)
> > > > as a result of multiple executions of the function "k_ascii" (keyboard.c:888)
> > > > while the variable "base" has 10.
> > > > So their multiplication at line 888 in "k_ascii" will become
> > > > larger than the max of type int, causing such an integer overflow.
> > > >
> > > > I believe this can be solved by checking for overflow ahead of operations
> > > > e.g., using check_mul_overflow().
> > > >
> > > > kernel config: https://kt0755.github.io/etc/config_v5.5.11
> > >
> > > Great, can you send a patch for this?
> > >
> > > thanks,
> > >
> > > greg k-h
> >
> > I'm not sure the following works best.
> >
> > diff --git a/drivers/tty/vt/keyboard.c b/drivers/tty/vt/keyboard.c
> > index 15d33fa0c925..c1ae9d2e6970 100644
> > --- a/drivers/tty/vt/keyboard.c
> > +++ b/drivers/tty/vt/keyboard.c
> > @@ -869,6 +869,7 @@ static void k_meta(struct vc_data *vc, unsigned
> > char value, char up_flag)
> >  static void k_ascii(struct vc_data *vc, unsigned char value, char up_flag)
> >  {
> >         int base;
> > +       int bytes, res;
> >
> >         if (up_flag)
> >                 return;
> > @@ -884,6 +885,8 @@ static void k_ascii(struct vc_data *vc, unsigned
> > char value, char up_flag)
> >
> >         if (npadch == -1)
> >                 npadch = value;
> > +       else if (check_mul_overflow(npadch, base, &bytes) ||
> > check_add_overflow(bytes, value, &res))
> > +               return;
> >         else
> >                 npadch = npadch * base + value;
> >  }
>
> Does this solve the issue for you?  If so, can you fix it up and resend
> it in a format that I can apply it in?
>
> thanks,
>
> greg k-h

I tested the fixed code using a repro (attached), and observed no such
a crash occurred anymore.
Anyway I will send a patch in a separate email.

Thanks,
Kyungtae Kim

--000000000000eed2f105a1c31f07
Content-Type: text/x-c-code; charset="US-ASCII"; name="repro-82779.c"
Content-Disposition: attachment; filename="repro-82779.c"
Content-Transfer-Encoding: base64
Content-ID: <f_k887jxma0>
X-Attachment-Id: f_k887jxma0

Ly8gYXV0b2dlbmVyYXRlZCBieSBzeXprYWxsZXIgKGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUv
c3l6a2FsbGVyKQoKLy9nY2MgWy1vIC90bXAvc3l6LWV4ZWN1dG9yMTUzODc5ODk3IC1ER09PU19s
aW51eD0xIC1ER09BUkNIX2FtZDY0PTEgLURIT1NUR09PU19saW51eD0xIC14IGMgLSAtTzIgLXB0
aHJlYWQgLVdhbGwgLVdlcnJvciAtV3BhcmVudGhlc2VzIC1XdW51c2VkLWNvbnN0LXZhcmlhYmxl
IC1XZnJhbWUtbGFyZ2VyLXRoYW49ODE5MiAtbTY0IC1zdGF0aWMgLWZwZXJtaXNzaXZlIC13XQov
L2djYyAtTzIgLXB0aHJlYWQgLXN0YXRpYyAKCgojZGVmaW5lIF9HTlVfU09VUkNFIAoKI2luY2x1
ZGUgPGFycGEvaW5ldC5oPgojaW5jbHVkZSA8ZGlyZW50Lmg+CiNpbmNsdWRlIDxlbmRpYW4uaD4K
I2luY2x1ZGUgPGVycm5vLmg+CiNpbmNsdWRlIDxmY250bC5oPgojaW5jbHVkZSA8bmV0L2lmLmg+
CiNpbmNsdWRlIDxuZXQvaWZfYXJwLmg+CiNpbmNsdWRlIDxuZXRpbmV0L2luLmg+CiNpbmNsdWRl
IDxwdGhyZWFkLmg+CiNpbmNsdWRlIDxzY2hlZC5oPgojaW5jbHVkZSA8c2V0am1wLmg+CiNpbmNs
dWRlIDxzaWduYWwuaD4KI2luY2x1ZGUgPHN0ZGFyZy5oPgojaW5jbHVkZSA8c3RkYm9vbC5oPgoj
aW5jbHVkZSA8c3RkaW50Lmg+CiNpbmNsdWRlIDxzdGRpby5oPgojaW5jbHVkZSA8c3RkbGliLmg+
CiNpbmNsdWRlIDxzdHJpbmcuaD4KI2luY2x1ZGUgPHN5cy9pb2N0bC5oPgojaW5jbHVkZSA8c3lz
L21vdW50Lmg+CiNpbmNsdWRlIDxzeXMvcHJjdGwuaD4KI2luY2x1ZGUgPHN5cy9yZXNvdXJjZS5o
PgojaW5jbHVkZSA8c3lzL3NvY2tldC5oPgojaW5jbHVkZSA8c3lzL3N0YXQuaD4KI2luY2x1ZGUg
PHN5cy9zeXNjYWxsLmg+CiNpbmNsdWRlIDxzeXMvdGltZS5oPgojaW5jbHVkZSA8c3lzL3R5cGVz
Lmg+CiNpbmNsdWRlIDxzeXMvdWlvLmg+CiNpbmNsdWRlIDxzeXMvd2FpdC5oPgojaW5jbHVkZSA8
dGltZS5oPgojaW5jbHVkZSA8dW5pc3RkLmg+CgojaW5jbHVkZSA8bGludXgvY2FwYWJpbGl0eS5o
PgojaW5jbHVkZSA8bGludXgvZnV0ZXguaD4KI2luY2x1ZGUgPGxpbnV4L2dlbmV0bGluay5oPgoj
aW5jbHVkZSA8bGludXgvaWZfYWRkci5oPgojaW5jbHVkZSA8bGludXgvaWZfZXRoZXIuaD4KI2lu
Y2x1ZGUgPGxpbnV4L2lmX2xpbmsuaD4KI2luY2x1ZGUgPGxpbnV4L2lmX3R1bi5oPgojaW5jbHVk
ZSA8bGludXgvaW42Lmg+CiNpbmNsdWRlIDxsaW51eC9pcC5oPgojaW5jbHVkZSA8bGludXgvbmVp
Z2hib3VyLmg+CiNpbmNsdWRlIDxsaW51eC9uZXQuaD4KI2luY2x1ZGUgPGxpbnV4L25ldGxpbmsu
aD4KI2luY2x1ZGUgPGxpbnV4L3J0bmV0bGluay5oPgojaW5jbHVkZSA8bGludXgvdGNwLmg+CiNp
bmNsdWRlIDxsaW51eC92ZXRoLmg+Cgp1bnNpZ25lZCBsb25nIGxvbmcgcHJvY2lkOwoKc3RhdGlj
IF9fdGhyZWFkIGludCBza2lwX3NlZ3Y7CnN0YXRpYyBfX3RocmVhZCBqbXBfYnVmIHNlZ3ZfZW52
OwoKc3RhdGljIHZvaWQgc2Vndl9oYW5kbGVyKGludCBzaWcsIHNpZ2luZm9fdCogaW5mbywgdm9p
ZCogY3R4KQp7Cgl1aW50cHRyX3QgYWRkciA9ICh1aW50cHRyX3QpaW5mby0+c2lfYWRkcjsKCWNv
bnN0IHVpbnRwdHJfdCBwcm9nX3N0YXJ0ID0gMSA8PCAyMDsKCWNvbnN0IHVpbnRwdHJfdCBwcm9n
X2VuZCA9IDEwMCA8PCAyMDsKCWlmIChfX2F0b21pY19sb2FkX24oJnNraXBfc2VndiwgX19BVE9N
SUNfUkVMQVhFRCkgJiYgKGFkZHIgPCBwcm9nX3N0YXJ0IHx8IGFkZHIgPiBwcm9nX2VuZCkpIHsK
CQlfbG9uZ2ptcChzZWd2X2VudiwgMSk7Cgl9CglleGl0KHNpZyk7Cn0KCnN0YXRpYyB2b2lkIGlu
c3RhbGxfc2Vndl9oYW5kbGVyKHZvaWQpCnsKCXN0cnVjdCBzaWdhY3Rpb24gc2E7CgltZW1zZXQo
JnNhLCAwLCBzaXplb2Yoc2EpKTsKCXNhLnNhX2hhbmRsZXIgPSBTSUdfSUdOOwoJc3lzY2FsbChT
WVNfcnRfc2lnYWN0aW9uLCAweDIwLCAmc2EsIE5VTEwsIDgpOwoJc3lzY2FsbChTWVNfcnRfc2ln
YWN0aW9uLCAweDIxLCAmc2EsIE5VTEwsIDgpOwoJbWVtc2V0KCZzYSwgMCwgc2l6ZW9mKHNhKSk7
CglzYS5zYV9zaWdhY3Rpb24gPSBzZWd2X2hhbmRsZXI7CglzYS5zYV9mbGFncyA9IFNBX05PREVG
RVIgfCBTQV9TSUdJTkZPOwoJc2lnYWN0aW9uKFNJR1NFR1YsICZzYSwgTlVMTCk7CglzaWdhY3Rp
b24oU0lHQlVTLCAmc2EsIE5VTEwpOwp9CgojZGVmaW5lIE5PTkZBSUxJTkcoLi4uKSB7IF9fYXRv
bWljX2ZldGNoX2FkZCgmc2tpcF9zZWd2LCAxLCBfX0FUT01JQ19TRVFfQ1NUKTsgaWYgKF9zZXRq
bXAoc2Vndl9lbnYpID09IDApIHsgX19WQV9BUkdTX187IH0gX19hdG9taWNfZmV0Y2hfc3ViKCZz
a2lwX3NlZ3YsIDEsIF9fQVRPTUlDX1NFUV9DU1QpOyB9CgpzdGF0aWMgdm9pZCBzbGVlcF9tcyh1
aW50NjRfdCBtcykKewoJdXNsZWVwKG1zICogMTAwMCk7Cn0KCnN0YXRpYyB1aW50NjRfdCBjdXJy
ZW50X3RpbWVfbXModm9pZCkKewoJc3RydWN0IHRpbWVzcGVjIHRzOwoJaWYgKGNsb2NrX2dldHRp
bWUoQ0xPQ0tfTU9OT1RPTklDLCAmdHMpKQoJZXhpdCgxKTsKCXJldHVybiAodWludDY0X3QpdHMu
dHZfc2VjICogMTAwMCArICh1aW50NjRfdCl0cy50dl9uc2VjIC8gMTAwMDAwMDsKfQoKc3RhdGlj
IHZvaWQgdXNlX3RlbXBvcmFyeV9kaXIodm9pZCkKewoJY2hhciB0bXBkaXJfdGVtcGxhdGVbXSA9
ICIuL3N5emthbGxlci5YWFhYWFgiOwoJY2hhciogdG1wZGlyID0gbWtkdGVtcCh0bXBkaXJfdGVt
cGxhdGUpOwoJaWYgKCF0bXBkaXIpCglleGl0KDEpOwoJaWYgKGNobW9kKHRtcGRpciwgMDc3Nykp
CglleGl0KDEpOwoJaWYgKGNoZGlyKHRtcGRpcikpCglleGl0KDEpOwp9CgpzdGF0aWMgdm9pZCB0
aHJlYWRfc3RhcnQodm9pZCogKCpmbikodm9pZCopLCB2b2lkKiBhcmcpCnsKCXB0aHJlYWRfdCB0
aDsKCXB0aHJlYWRfYXR0cl90IGF0dHI7CglwdGhyZWFkX2F0dHJfaW5pdCgmYXR0cik7CglwdGhy
ZWFkX2F0dHJfc2V0c3RhY2tzaXplKCZhdHRyLCAxMjggPDwgMTApOwoJaW50IGk7Cglmb3IgKGkg
PSAwOyBpIDwgMTAwOyBpKyspIHsKCQlpZiAocHRocmVhZF9jcmVhdGUoJnRoLCAmYXR0ciwgZm4s
IGFyZykgPT0gMCkgewoJCQlwdGhyZWFkX2F0dHJfZGVzdHJveSgmYXR0cik7CgkJCXJldHVybjsK
CQl9CgkJaWYgKGVycm5vID09IEVBR0FJTikgewoJCQl1c2xlZXAoNTApOwoJCQljb250aW51ZTsK
CQl9CgkJYnJlYWs7Cgl9CglleGl0KDEpOwp9Cgp0eXBlZGVmIHN0cnVjdCB7CglpbnQgc3RhdGU7
Cn0gZXZlbnRfdDsKCnN0YXRpYyB2b2lkIGV2ZW50X2luaXQoZXZlbnRfdCogZXYpCnsKCWV2LT5z
dGF0ZSA9IDA7Cn0KCnN0YXRpYyB2b2lkIGV2ZW50X3Jlc2V0KGV2ZW50X3QqIGV2KQp7Cglldi0+
c3RhdGUgPSAwOwp9CgpzdGF0aWMgdm9pZCBldmVudF9zZXQoZXZlbnRfdCogZXYpCnsKCWlmIChl
di0+c3RhdGUpCglleGl0KDEpOwoJX19hdG9taWNfc3RvcmVfbigmZXYtPnN0YXRlLCAxLCBfX0FU
T01JQ19SRUxFQVNFKTsKCXN5c2NhbGwoU1lTX2Z1dGV4LCAmZXYtPnN0YXRlLCBGVVRFWF9XQUtF
IHwgRlVURVhfUFJJVkFURV9GTEFHKTsKfQoKc3RhdGljIHZvaWQgZXZlbnRfd2FpdChldmVudF90
KiBldikKewoJd2hpbGUgKCFfX2F0b21pY19sb2FkX24oJmV2LT5zdGF0ZSwgX19BVE9NSUNfQUNR
VUlSRSkpCgkJc3lzY2FsbChTWVNfZnV0ZXgsICZldi0+c3RhdGUsIEZVVEVYX1dBSVQgfCBGVVRF
WF9QUklWQVRFX0ZMQUcsIDAsIDApOwp9CgpzdGF0aWMgaW50IGV2ZW50X2lzc2V0KGV2ZW50X3Qq
IGV2KQp7CglyZXR1cm4gX19hdG9taWNfbG9hZF9uKCZldi0+c3RhdGUsIF9fQVRPTUlDX0FDUVVJ
UkUpOwp9CgpzdGF0aWMgaW50IGV2ZW50X3RpbWVkd2FpdChldmVudF90KiBldiwgdWludDY0X3Qg
dGltZW91dCkKewoJdWludDY0X3Qgc3RhcnQgPSBjdXJyZW50X3RpbWVfbXMoKTsKCXVpbnQ2NF90
IG5vdyA9IHN0YXJ0OwoJZm9yICg7OykgewoJCXVpbnQ2NF90IHJlbWFpbiA9IHRpbWVvdXQgLSAo
bm93IC0gc3RhcnQpOwoJCXN0cnVjdCB0aW1lc3BlYyB0czsKCQl0cy50dl9zZWMgPSByZW1haW4g
LyAxMDAwOwoJCXRzLnR2X25zZWMgPSAocmVtYWluICUgMTAwMCkgKiAxMDAwICogMTAwMDsKCQlz
eXNjYWxsKFNZU19mdXRleCwgJmV2LT5zdGF0ZSwgRlVURVhfV0FJVCB8IEZVVEVYX1BSSVZBVEVf
RkxBRywgMCwgJnRzKTsKCQlpZiAoX19hdG9taWNfbG9hZF9uKCZldi0+c3RhdGUsIF9fQVRPTUlD
X1JFTEFYRUQpKQoJCQlyZXR1cm4gMTsKCQlub3cgPSBjdXJyZW50X3RpbWVfbXMoKTsKCQlpZiAo
bm93IC0gc3RhcnQgPiB0aW1lb3V0KQoJCQlyZXR1cm4gMDsKCX0KfQoKc3RhdGljIGJvb2wgd3Jp
dGVfZmlsZShjb25zdCBjaGFyKiBmaWxlLCBjb25zdCBjaGFyKiB3aGF0LCAuLi4pCnsKCWNoYXIg
YnVmWzEwMjRdOwoJdmFfbGlzdCBhcmdzOwoJdmFfc3RhcnQoYXJncywgd2hhdCk7Cgl2c25wcmlu
dGYoYnVmLCBzaXplb2YoYnVmKSwgd2hhdCwgYXJncyk7Cgl2YV9lbmQoYXJncyk7CglidWZbc2l6
ZW9mKGJ1ZikgLSAxXSA9IDA7CglpbnQgbGVuID0gc3RybGVuKGJ1Zik7CglpbnQgZmQgPSBvcGVu
KGZpbGUsIE9fV1JPTkxZIHwgT19DTE9FWEVDKTsKCWlmIChmZCA9PSAtMSkKCQlyZXR1cm4gZmFs
c2U7CglpZiAod3JpdGUoZmQsIGJ1ZiwgbGVuKSAhPSBsZW4pIHsKCQlpbnQgZXJyID0gZXJybm87
CgkJY2xvc2UoZmQpOwoJCWVycm5vID0gZXJyOwoJCXJldHVybiBmYWxzZTsKCX0KCWNsb3NlKGZk
KTsKCXJldHVybiB0cnVlOwp9CgpzdHJ1Y3Qgbmxtc2cgewoJY2hhciogcG9zOwoJaW50IG5lc3Rp
bmc7CglzdHJ1Y3QgbmxhdHRyKiBuZXN0ZWRbOF07CgljaGFyIGJ1ZlsxMDI0XTsKfTsKCnN0YXRp
YyBzdHJ1Y3Qgbmxtc2cgbmxtc2c7CgpzdGF0aWMgdm9pZCBuZXRsaW5rX2luaXQoc3RydWN0IG5s
bXNnKiBubG1zZywgaW50IHR5cCwgaW50IGZsYWdzLAoJCQkgY29uc3Qgdm9pZCogZGF0YSwgaW50
IHNpemUpCnsKCW1lbXNldChubG1zZywgMCwgc2l6ZW9mKCpubG1zZykpOwoJc3RydWN0IG5sbXNn
aGRyKiBoZHIgPSAoc3RydWN0IG5sbXNnaGRyKilubG1zZy0+YnVmOwoJaGRyLT5ubG1zZ190eXBl
ID0gdHlwOwoJaGRyLT5ubG1zZ19mbGFncyA9IE5MTV9GX1JFUVVFU1QgfCBOTE1fRl9BQ0sgfCBm
bGFnczsKCW1lbWNweShoZHIgKyAxLCBkYXRhLCBzaXplKTsKCW5sbXNnLT5wb3MgPSAoY2hhciop
KGhkciArIDEpICsgTkxNU0dfQUxJR04oc2l6ZSk7Cn0KCnN0YXRpYyB2b2lkIG5ldGxpbmtfYXR0
cihzdHJ1Y3Qgbmxtc2cqIG5sbXNnLCBpbnQgdHlwLAoJCQkgY29uc3Qgdm9pZCogZGF0YSwgaW50
IHNpemUpCnsKCXN0cnVjdCBubGF0dHIqIGF0dHIgPSAoc3RydWN0IG5sYXR0ciopbmxtc2ctPnBv
czsKCWF0dHItPm5sYV9sZW4gPSBzaXplb2YoKmF0dHIpICsgc2l6ZTsKCWF0dHItPm5sYV90eXBl
ID0gdHlwOwoJbWVtY3B5KGF0dHIgKyAxLCBkYXRhLCBzaXplKTsKCW5sbXNnLT5wb3MgKz0gTkxN
U0dfQUxJR04oYXR0ci0+bmxhX2xlbik7Cn0KCnN0YXRpYyB2b2lkIG5ldGxpbmtfbmVzdChzdHJ1
Y3Qgbmxtc2cqIG5sbXNnLCBpbnQgdHlwKQp7CglzdHJ1Y3QgbmxhdHRyKiBhdHRyID0gKHN0cnVj
dCBubGF0dHIqKW5sbXNnLT5wb3M7CglhdHRyLT5ubGFfdHlwZSA9IHR5cDsKCW5sbXNnLT5wb3Mg
Kz0gc2l6ZW9mKCphdHRyKTsKCW5sbXNnLT5uZXN0ZWRbbmxtc2ctPm5lc3RpbmcrK10gPSBhdHRy
Owp9CgpzdGF0aWMgdm9pZCBuZXRsaW5rX2RvbmUoc3RydWN0IG5sbXNnKiBubG1zZykKewoJc3Ry
dWN0IG5sYXR0ciogYXR0ciA9IG5sbXNnLT5uZXN0ZWRbLS1ubG1zZy0+bmVzdGluZ107CglhdHRy
LT5ubGFfbGVuID0gbmxtc2ctPnBvcyAtIChjaGFyKilhdHRyOwp9CgpzdGF0aWMgaW50IG5ldGxp
bmtfc2VuZF9leHQoc3RydWN0IG5sbXNnKiBubG1zZywgaW50IHNvY2ssCgkJCSAgICB1aW50MTZf
dCByZXBseV90eXBlLCBpbnQqIHJlcGx5X2xlbikKewoJaWYgKG5sbXNnLT5wb3MgPiBubG1zZy0+
YnVmICsgc2l6ZW9mKG5sbXNnLT5idWYpIHx8IG5sbXNnLT5uZXN0aW5nKQoJZXhpdCgxKTsKCXN0
cnVjdCBubG1zZ2hkciogaGRyID0gKHN0cnVjdCBubG1zZ2hkciopbmxtc2ctPmJ1ZjsKCWhkci0+
bmxtc2dfbGVuID0gbmxtc2ctPnBvcyAtIG5sbXNnLT5idWY7CglzdHJ1Y3Qgc29ja2FkZHJfbmwg
YWRkcjsKCW1lbXNldCgmYWRkciwgMCwgc2l6ZW9mKGFkZHIpKTsKCWFkZHIubmxfZmFtaWx5ID0g
QUZfTkVUTElOSzsKCXVuc2lnbmVkIG4gPSBzZW5kdG8oc29jaywgbmxtc2ctPmJ1ZiwgaGRyLT5u
bG1zZ19sZW4sIDAsIChzdHJ1Y3Qgc29ja2FkZHIqKSZhZGRyLCBzaXplb2YoYWRkcikpOwoJaWYg
KG4gIT0gaGRyLT5ubG1zZ19sZW4pCglleGl0KDEpOwoJbiA9IHJlY3Yoc29jaywgbmxtc2ctPmJ1
Ziwgc2l6ZW9mKG5sbXNnLT5idWYpLCAwKTsKCWlmIChoZHItPm5sbXNnX3R5cGUgPT0gTkxNU0df
RE9ORSkgewoJCSpyZXBseV9sZW4gPSAwOwoJCXJldHVybiAwOwoJfQoJaWYgKG4gPCBzaXplb2Yo
c3RydWN0IG5sbXNnaGRyKSkKCWV4aXQoMSk7CglpZiAocmVwbHlfbGVuICYmIGhkci0+bmxtc2df
dHlwZSA9PSByZXBseV90eXBlKSB7CgkJKnJlcGx5X2xlbiA9IG47CgkJcmV0dXJuIDA7Cgl9Cglp
ZiAobiA8IHNpemVvZihzdHJ1Y3Qgbmxtc2doZHIpICsgc2l6ZW9mKHN0cnVjdCBubG1zZ2Vycikp
CglleGl0KDEpOwoJaWYgKGhkci0+bmxtc2dfdHlwZSAhPSBOTE1TR19FUlJPUikKCWV4aXQoMSk7
CglyZXR1cm4gLSgoc3RydWN0IG5sbXNnZXJyKikoaGRyICsgMSkpLT5lcnJvcjsKfQoKc3RhdGlj
IGludCBuZXRsaW5rX3NlbmQoc3RydWN0IG5sbXNnKiBubG1zZywgaW50IHNvY2spCnsKCXJldHVy
biBuZXRsaW5rX3NlbmRfZXh0KG5sbXNnLCBzb2NrLCAwLCBOVUxMKTsKfQoKc3RhdGljIGludCBu
ZXRsaW5rX25leHRfbXNnKHN0cnVjdCBubG1zZyogbmxtc2csIHVuc2lnbmVkIGludCBvZmZzZXQs
CgkJCSAgICB1bnNpZ25lZCBpbnQgdG90YWxfbGVuKQp7CglzdHJ1Y3Qgbmxtc2doZHIqIGhkciA9
IChzdHJ1Y3Qgbmxtc2doZHIqKShubG1zZy0+YnVmICsgb2Zmc2V0KTsKCWlmIChvZmZzZXQgPT0g
dG90YWxfbGVuIHx8IG9mZnNldCArIGhkci0+bmxtc2dfbGVuID4gdG90YWxfbGVuKQoJCXJldHVy
biAtMTsKCXJldHVybiBoZHItPm5sbXNnX2xlbjsKfQoKc3RhdGljIHZvaWQgbmV0bGlua19hZGRf
ZGV2aWNlX2ltcGwoc3RydWN0IG5sbXNnKiBubG1zZywgY29uc3QgY2hhciogdHlwZSwKCQkJCSAg
ICBjb25zdCBjaGFyKiBuYW1lKQp7CglzdHJ1Y3QgaWZpbmZvbXNnIGhkcjsKCW1lbXNldCgmaGRy
LCAwLCBzaXplb2YoaGRyKSk7CgluZXRsaW5rX2luaXQobmxtc2csIFJUTV9ORVdMSU5LLCBOTE1f
Rl9FWENMIHwgTkxNX0ZfQ1JFQVRFLCAmaGRyLCBzaXplb2YoaGRyKSk7CglpZiAobmFtZSkKCQlu
ZXRsaW5rX2F0dHIobmxtc2csIElGTEFfSUZOQU1FLCBuYW1lLCBzdHJsZW4obmFtZSkpOwoJbmV0
bGlua19uZXN0KG5sbXNnLCBJRkxBX0xJTktJTkZPKTsKCW5ldGxpbmtfYXR0cihubG1zZywgSUZM
QV9JTkZPX0tJTkQsIHR5cGUsIHN0cmxlbih0eXBlKSk7Cn0KCnN0YXRpYyB2b2lkIG5ldGxpbmtf
YWRkX2RldmljZShzdHJ1Y3Qgbmxtc2cqIG5sbXNnLCBpbnQgc29jaywgY29uc3QgY2hhciogdHlw
ZSwKCQkJICAgICAgIGNvbnN0IGNoYXIqIG5hbWUpCnsKCW5ldGxpbmtfYWRkX2RldmljZV9pbXBs
KG5sbXNnLCB0eXBlLCBuYW1lKTsKCW5ldGxpbmtfZG9uZShubG1zZyk7CglpbnQgZXJyID0gbmV0
bGlua19zZW5kKG5sbXNnLCBzb2NrKTsKCSh2b2lkKWVycjsKfQoKc3RhdGljIHZvaWQgbmV0bGlu
a19hZGRfdmV0aChzdHJ1Y3Qgbmxtc2cqIG5sbXNnLCBpbnQgc29jaywgY29uc3QgY2hhciogbmFt
ZSwKCQkJICAgICBjb25zdCBjaGFyKiBwZWVyKQp7CgluZXRsaW5rX2FkZF9kZXZpY2VfaW1wbChu
bG1zZywgInZldGgiLCBuYW1lKTsKCW5ldGxpbmtfbmVzdChubG1zZywgSUZMQV9JTkZPX0RBVEEp
OwoJbmV0bGlua19uZXN0KG5sbXNnLCBWRVRIX0lORk9fUEVFUik7CglubG1zZy0+cG9zICs9IHNp
emVvZihzdHJ1Y3QgaWZpbmZvbXNnKTsKCW5ldGxpbmtfYXR0cihubG1zZywgSUZMQV9JRk5BTUUs
IHBlZXIsIHN0cmxlbihwZWVyKSk7CgluZXRsaW5rX2RvbmUobmxtc2cpOwoJbmV0bGlua19kb25l
KG5sbXNnKTsKCW5ldGxpbmtfZG9uZShubG1zZyk7CglpbnQgZXJyID0gbmV0bGlua19zZW5kKG5s
bXNnLCBzb2NrKTsKCSh2b2lkKWVycjsKfQoKc3RhdGljIHZvaWQgbmV0bGlua19hZGRfaHNyKHN0
cnVjdCBubG1zZyogbmxtc2csIGludCBzb2NrLCBjb25zdCBjaGFyKiBuYW1lLAoJCQkgICAgY29u
c3QgY2hhciogc2xhdmUxLCBjb25zdCBjaGFyKiBzbGF2ZTIpCnsKCW5ldGxpbmtfYWRkX2Rldmlj
ZV9pbXBsKG5sbXNnLCAiaHNyIiwgbmFtZSk7CgluZXRsaW5rX25lc3Qobmxtc2csIElGTEFfSU5G
T19EQVRBKTsKCWludCBpZmluZGV4MSA9IGlmX25hbWV0b2luZGV4KHNsYXZlMSk7CgluZXRsaW5r
X2F0dHIobmxtc2csIElGTEFfSFNSX1NMQVZFMSwgJmlmaW5kZXgxLCBzaXplb2YoaWZpbmRleDEp
KTsKCWludCBpZmluZGV4MiA9IGlmX25hbWV0b2luZGV4KHNsYXZlMik7CgluZXRsaW5rX2F0dHIo
bmxtc2csIElGTEFfSFNSX1NMQVZFMiwgJmlmaW5kZXgyLCBzaXplb2YoaWZpbmRleDIpKTsKCW5l
dGxpbmtfZG9uZShubG1zZyk7CgluZXRsaW5rX2RvbmUobmxtc2cpOwoJaW50IGVyciA9IG5ldGxp
bmtfc2VuZChubG1zZywgc29jayk7Cgkodm9pZCllcnI7Cn0KCnN0YXRpYyB2b2lkIG5ldGxpbmtf
ZGV2aWNlX2NoYW5nZShzdHJ1Y3Qgbmxtc2cqIG5sbXNnLCBpbnQgc29jaywgY29uc3QgY2hhciog
bmFtZSwgYm9vbCB1cCwKCQkJCSAgY29uc3QgY2hhciogbWFzdGVyLCBjb25zdCB2b2lkKiBtYWMs
IGludCBtYWNzaXplLAoJCQkJICBjb25zdCBjaGFyKiBuZXdfbmFtZSkKewoJc3RydWN0IGlmaW5m
b21zZyBoZHI7CgltZW1zZXQoJmhkciwgMCwgc2l6ZW9mKGhkcikpOwoJaWYgKHVwKQoJCWhkci5p
ZmlfZmxhZ3MgPSBoZHIuaWZpX2NoYW5nZSA9IElGRl9VUDsKCWhkci5pZmlfaW5kZXggPSBpZl9u
YW1ldG9pbmRleChuYW1lKTsKCW5ldGxpbmtfaW5pdChubG1zZywgUlRNX05FV0xJTkssIDAsICZo
ZHIsIHNpemVvZihoZHIpKTsKCWlmIChuZXdfbmFtZSkKCQluZXRsaW5rX2F0dHIobmxtc2csIElG
TEFfSUZOQU1FLCBuZXdfbmFtZSwgc3RybGVuKG5ld19uYW1lKSk7CglpZiAobWFzdGVyKSB7CgkJ
aW50IGlmaW5kZXggPSBpZl9uYW1ldG9pbmRleChtYXN0ZXIpOwoJCW5ldGxpbmtfYXR0cihubG1z
ZywgSUZMQV9NQVNURVIsICZpZmluZGV4LCBzaXplb2YoaWZpbmRleCkpOwoJfQoJaWYgKG1hY3Np
emUpCgkJbmV0bGlua19hdHRyKG5sbXNnLCBJRkxBX0FERFJFU1MsIG1hYywgbWFjc2l6ZSk7Cglp
bnQgZXJyID0gbmV0bGlua19zZW5kKG5sbXNnLCBzb2NrKTsKCSh2b2lkKWVycjsKfQoKc3RhdGlj
IGludCBuZXRsaW5rX2FkZF9hZGRyKHN0cnVjdCBubG1zZyogbmxtc2csIGludCBzb2NrLCBjb25z
dCBjaGFyKiBkZXYsCgkJCSAgICBjb25zdCB2b2lkKiBhZGRyLCBpbnQgYWRkcnNpemUpCnsKCXN0
cnVjdCBpZmFkZHJtc2cgaGRyOwoJbWVtc2V0KCZoZHIsIDAsIHNpemVvZihoZHIpKTsKCWhkci5p
ZmFfZmFtaWx5ID0gYWRkcnNpemUgPT0gNCA/IEFGX0lORVQgOiBBRl9JTkVUNjsKCWhkci5pZmFf
cHJlZml4bGVuID0gYWRkcnNpemUgPT0gNCA/IDI0IDogMTIwOwoJaGRyLmlmYV9zY29wZSA9IFJU
X1NDT1BFX1VOSVZFUlNFOwoJaGRyLmlmYV9pbmRleCA9IGlmX25hbWV0b2luZGV4KGRldik7Cglu
ZXRsaW5rX2luaXQobmxtc2csIFJUTV9ORVdBRERSLCBOTE1fRl9DUkVBVEUgfCBOTE1fRl9SRVBM
QUNFLCAmaGRyLCBzaXplb2YoaGRyKSk7CgluZXRsaW5rX2F0dHIobmxtc2csIElGQV9MT0NBTCwg
YWRkciwgYWRkcnNpemUpOwoJbmV0bGlua19hdHRyKG5sbXNnLCBJRkFfQUREUkVTUywgYWRkciwg
YWRkcnNpemUpOwoJcmV0dXJuIG5ldGxpbmtfc2VuZChubG1zZywgc29jayk7Cn0KCnN0YXRpYyB2
b2lkIG5ldGxpbmtfYWRkX2FkZHI0KHN0cnVjdCBubG1zZyogbmxtc2csIGludCBzb2NrLAoJCQkg
ICAgICBjb25zdCBjaGFyKiBkZXYsIGNvbnN0IGNoYXIqIGFkZHIpCnsKCXN0cnVjdCBpbl9hZGRy
IGluX2FkZHI7CglpbmV0X3B0b24oQUZfSU5FVCwgYWRkciwgJmluX2FkZHIpOwoJaW50IGVyciA9
IG5ldGxpbmtfYWRkX2FkZHIobmxtc2csIHNvY2ssIGRldiwgJmluX2FkZHIsIHNpemVvZihpbl9h
ZGRyKSk7Cgkodm9pZCllcnI7Cn0KCnN0YXRpYyB2b2lkIG5ldGxpbmtfYWRkX2FkZHI2KHN0cnVj
dCBubG1zZyogbmxtc2csIGludCBzb2NrLAoJCQkgICAgICBjb25zdCBjaGFyKiBkZXYsIGNvbnN0
IGNoYXIqIGFkZHIpCnsKCXN0cnVjdCBpbjZfYWRkciBpbjZfYWRkcjsKCWluZXRfcHRvbihBRl9J
TkVUNiwgYWRkciwgJmluNl9hZGRyKTsKCWludCBlcnIgPSBuZXRsaW5rX2FkZF9hZGRyKG5sbXNn
LCBzb2NrLCBkZXYsICZpbjZfYWRkciwgc2l6ZW9mKGluNl9hZGRyKSk7Cgkodm9pZCllcnI7Cn0K
CnN0YXRpYyB2b2lkIG5ldGxpbmtfYWRkX25laWdoKHN0cnVjdCBubG1zZyogbmxtc2csIGludCBz
b2NrLCBjb25zdCBjaGFyKiBuYW1lLAoJCQkgICAgICBjb25zdCB2b2lkKiBhZGRyLCBpbnQgYWRk
cnNpemUsIGNvbnN0IHZvaWQqIG1hYywgaW50IG1hY3NpemUpCnsKCXN0cnVjdCBuZG1zZyBoZHI7
CgltZW1zZXQoJmhkciwgMCwgc2l6ZW9mKGhkcikpOwoJaGRyLm5kbV9mYW1pbHkgPSBhZGRyc2l6
ZSA9PSA0ID8gQUZfSU5FVCA6IEFGX0lORVQ2OwoJaGRyLm5kbV9pZmluZGV4ID0gaWZfbmFtZXRv
aW5kZXgobmFtZSk7CgloZHIubmRtX3N0YXRlID0gTlVEX1BFUk1BTkVOVDsKCW5ldGxpbmtfaW5p
dChubG1zZywgUlRNX05FV05FSUdILCBOTE1fRl9FWENMIHwgTkxNX0ZfQ1JFQVRFLCAmaGRyLCBz
aXplb2YoaGRyKSk7CgluZXRsaW5rX2F0dHIobmxtc2csIE5EQV9EU1QsIGFkZHIsIGFkZHJzaXpl
KTsKCW5ldGxpbmtfYXR0cihubG1zZywgTkRBX0xMQUREUiwgbWFjLCBtYWNzaXplKTsKCWludCBl
cnIgPSBuZXRsaW5rX3NlbmQobmxtc2csIHNvY2spOwoJKHZvaWQpZXJyOwp9CgpzdGF0aWMgaW50
IHR1bmZkID0gLTE7CnN0YXRpYyBpbnQgdHVuX2ZyYWdzX2VuYWJsZWQ7CgojZGVmaW5lIFRVTl9J
RkFDRSAic3l6X3R1biIKCiNkZWZpbmUgTE9DQUxfTUFDIDB4YWFhYWFhYWFhYWFhCiNkZWZpbmUg
UkVNT1RFX01BQyAweGFhYWFhYWFhYWFiYgoKI2RlZmluZSBMT0NBTF9JUFY0ICIxNzIuMjAuMjAu
MTcwIgojZGVmaW5lIFJFTU9URV9JUFY0ICIxNzIuMjAuMjAuMTg3IgoKI2RlZmluZSBMT0NBTF9J
UFY2ICJmZTgwOjphYSIKI2RlZmluZSBSRU1PVEVfSVBWNiAiZmU4MDo6YmIiCgojZGVmaW5lIElG
Rl9OQVBJIDB4MDAxMAojZGVmaW5lIElGRl9OQVBJX0ZSQUdTIDB4MDAyMAoKc3RhdGljIHZvaWQg
aW5pdGlhbGl6ZV90dW4odm9pZCkKewoJdHVuZmQgPSBvcGVuKCIvZGV2L25ldC90dW4iLCBPX1JE
V1IgfCBPX05PTkJMT0NLKTsKCWlmICh0dW5mZCA9PSAtMSkgewoJCXByaW50ZigidHVuOiBjYW4n
dCBvcGVuIC9kZXYvbmV0L3R1bjogcGxlYXNlIGVuYWJsZSBDT05GSUdfVFVOPXlcbiIpOwoJCXBy
aW50Zigib3RoZXJ3aXNlIGZ1enppbmcgb3IgcmVwcm9kdWNpbmcgbWlnaHQgbm90IHdvcmsgYXMg
aW50ZW5kZWRcbiIpOwoJCXJldHVybjsKCX0KCWNvbnN0IGludCBrVHVuRmQgPSAyNDA7CglpZiAo
ZHVwMih0dW5mZCwga1R1bkZkKSA8IDApCglleGl0KDEpOwoJY2xvc2UodHVuZmQpOwoJdHVuZmQg
PSBrVHVuRmQ7CglzdHJ1Y3QgaWZyZXEgaWZyOwoJbWVtc2V0KCZpZnIsIDAsIHNpemVvZihpZnIp
KTsKCXN0cm5jcHkoaWZyLmlmcl9uYW1lLCBUVU5fSUZBQ0UsIElGTkFNU0laKTsKCWlmci5pZnJf
ZmxhZ3MgPSBJRkZfVEFQIHwgSUZGX05PX1BJIHwgSUZGX05BUEkgfCBJRkZfTkFQSV9GUkFHUzsK
CWlmIChpb2N0bCh0dW5mZCwgVFVOU0VUSUZGLCAodm9pZCopJmlmcikgPCAwKSB7CgkJaWZyLmlm
cl9mbGFncyA9IElGRl9UQVAgfCBJRkZfTk9fUEk7CgkJaWYgKGlvY3RsKHR1bmZkLCBUVU5TRVRJ
RkYsICh2b2lkKikmaWZyKSA8IDApCglleGl0KDEpOwoJfQoJaWYgKGlvY3RsKHR1bmZkLCBUVU5H
RVRJRkYsICh2b2lkKikmaWZyKSA8IDApCglleGl0KDEpOwoJdHVuX2ZyYWdzX2VuYWJsZWQgPSAo
aWZyLmlmcl9mbGFncyAmIElGRl9OQVBJX0ZSQUdTKSAhPSAwOwoJY2hhciBzeXNjdGxbNjRdOwoJ
c3ByaW50ZihzeXNjdGwsICIvcHJvYy9zeXMvbmV0L2lwdjYvY29uZi8lcy9hY2NlcHRfZGFkIiwg
VFVOX0lGQUNFKTsKCXdyaXRlX2ZpbGUoc3lzY3RsLCAiMCIpOwoJc3ByaW50ZihzeXNjdGwsICIv
cHJvYy9zeXMvbmV0L2lwdjYvY29uZi8lcy9yb3V0ZXJfc29saWNpdGF0aW9ucyIsIFRVTl9JRkFD
RSk7Cgl3cml0ZV9maWxlKHN5c2N0bCwgIjAiKTsKCWludCBzb2NrID0gc29ja2V0KEFGX05FVExJ
TkssIFNPQ0tfUkFXLCBORVRMSU5LX1JPVVRFKTsKCWlmIChzb2NrID09IC0xKQoJZXhpdCgxKTsK
CW5ldGxpbmtfYWRkX2FkZHI0KCZubG1zZywgc29jaywgVFVOX0lGQUNFLCBMT0NBTF9JUFY0KTsK
CW5ldGxpbmtfYWRkX2FkZHI2KCZubG1zZywgc29jaywgVFVOX0lGQUNFLCBMT0NBTF9JUFY2KTsK
CXVpbnQ2NF90IG1hY2FkZHIgPSBSRU1PVEVfTUFDOwoJc3RydWN0IGluX2FkZHIgaW5fYWRkcjsK
CWluZXRfcHRvbihBRl9JTkVULCBSRU1PVEVfSVBWNCwgJmluX2FkZHIpOwoJbmV0bGlua19hZGRf
bmVpZ2goJm5sbXNnLCBzb2NrLCBUVU5fSUZBQ0UsICZpbl9hZGRyLCBzaXplb2YoaW5fYWRkciks
ICZtYWNhZGRyLCBFVEhfQUxFTik7CglzdHJ1Y3QgaW42X2FkZHIgaW42X2FkZHI7CglpbmV0X3B0
b24oQUZfSU5FVDYsIFJFTU9URV9JUFY2LCAmaW42X2FkZHIpOwoJbmV0bGlua19hZGRfbmVpZ2go
Jm5sbXNnLCBzb2NrLCBUVU5fSUZBQ0UsICZpbjZfYWRkciwgc2l6ZW9mKGluNl9hZGRyKSwgJm1h
Y2FkZHIsIEVUSF9BTEVOKTsKCW1hY2FkZHIgPSBMT0NBTF9NQUM7CgluZXRsaW5rX2RldmljZV9j
aGFuZ2UoJm5sbXNnLCBzb2NrLCBUVU5fSUZBQ0UsIHRydWUsIDAsICZtYWNhZGRyLCBFVEhfQUxF
TiwgTlVMTCk7CgljbG9zZShzb2NrKTsKfQoKY29uc3QgaW50IGtJbml0TmV0TnNGZCA9IDIzOTsK
CiNkZWZpbmUgREVWTElOS19GQU1JTFlfTkFNRSAiZGV2bGluayIKCiNkZWZpbmUgREVWTElOS19D
TURfUE9SVF9HRVQgNQojZGVmaW5lIERFVkxJTktfQ01EX1JFTE9BRCAzNwojZGVmaW5lIERFVkxJ
TktfQVRUUl9CVVNfTkFNRSAxCiNkZWZpbmUgREVWTElOS19BVFRSX0RFVl9OQU1FIDIKI2RlZmlu
ZSBERVZMSU5LX0FUVFJfTkVUREVWX05BTUUgNwojZGVmaW5lIERFVkxJTktfQVRUUl9ORVROU19G
RCAxMzcKCnN0YXRpYyBpbnQgbmV0bGlua19kZXZsaW5rX2lkX2dldChzdHJ1Y3Qgbmxtc2cqIG5s
bXNnLCBpbnQgc29jaykKewoJc3RydWN0IGdlbmxtc2doZHIgZ2VubGhkcjsKCXN0cnVjdCBubGF0
dHIqIGF0dHI7CglpbnQgZXJyLCBuOwoJdWludDE2X3QgaWQgPSAwOwoJbWVtc2V0KCZnZW5saGRy
LCAwLCBzaXplb2YoZ2VubGhkcikpOwoJZ2VubGhkci5jbWQgPSBDVFJMX0NNRF9HRVRGQU1JTFk7
CgluZXRsaW5rX2luaXQobmxtc2csIEdFTkxfSURfQ1RSTCwgMCwgJmdlbmxoZHIsIHNpemVvZihn
ZW5saGRyKSk7CgluZXRsaW5rX2F0dHIobmxtc2csIENUUkxfQVRUUl9GQU1JTFlfTkFNRSwgREVW
TElOS19GQU1JTFlfTkFNRSwgc3RybGVuKERFVkxJTktfRkFNSUxZX05BTUUpICsgMSk7CgllcnIg
PSBuZXRsaW5rX3NlbmRfZXh0KG5sbXNnLCBzb2NrLCBHRU5MX0lEX0NUUkwsICZuKTsKCWlmIChl
cnIpIHsKCQlyZXR1cm4gLTE7Cgl9CglhdHRyID0gKHN0cnVjdCBubGF0dHIqKShubG1zZy0+YnVm
ICsgTkxNU0dfSERSTEVOICsgTkxNU0dfQUxJR04oc2l6ZW9mKGdlbmxoZHIpKSk7Cglmb3IgKDsg
KGNoYXIqKWF0dHIgPCBubG1zZy0+YnVmICsgbjsgYXR0ciA9IChzdHJ1Y3QgbmxhdHRyKikoKGNo
YXIqKWF0dHIgKyBOTE1TR19BTElHTihhdHRyLT5ubGFfbGVuKSkpIHsKCQlpZiAoYXR0ci0+bmxh
X3R5cGUgPT0gQ1RSTF9BVFRSX0ZBTUlMWV9JRCkgewoJCQlpZCA9ICoodWludDE2X3QqKShhdHRy
ICsgMSk7CgkJCWJyZWFrOwoJCX0KCX0KCWlmICghaWQpIHsKCQlyZXR1cm4gLTE7Cgl9CglyZWN2
KHNvY2ssIG5sbXNnLT5idWYsIHNpemVvZihubG1zZy0+YnVmKSwgMCk7IC8qIHJlY3YgYWNrICov
CglyZXR1cm4gaWQ7Cn0KCnN0YXRpYyB2b2lkIG5ldGxpbmtfZGV2bGlua19uZXRuc19tb3ZlKGNv
bnN0IGNoYXIqIGJ1c19uYW1lLCBjb25zdCBjaGFyKiBkZXZfbmFtZSwgaW50IG5ldG5zX2ZkKQp7
CglzdHJ1Y3QgZ2VubG1zZ2hkciBnZW5saGRyOwoJaW50IHNvY2s7CglpbnQgaWQ7Cglzb2NrID0g
c29ja2V0KEFGX05FVExJTkssIFNPQ0tfUkFXLCBORVRMSU5LX0dFTkVSSUMpOwoJaWYgKHNvY2sg
PT0gLTEpCglleGl0KDEpOwoJaWQgPSBuZXRsaW5rX2RldmxpbmtfaWRfZ2V0KCZubG1zZywgc29j
ayk7CglpZiAoaWQgPT0gLTEpCgkJZ290byBlcnJvcjsKCW1lbXNldCgmZ2VubGhkciwgMCwgc2l6
ZW9mKGdlbmxoZHIpKTsKCWdlbmxoZHIuY21kID0gREVWTElOS19DTURfUkVMT0FEOwoJbmV0bGlu
a19pbml0KCZubG1zZywgaWQsIDAsICZnZW5saGRyLCBzaXplb2YoZ2VubGhkcikpOwoJbmV0bGlu
a19hdHRyKCZubG1zZywgREVWTElOS19BVFRSX0JVU19OQU1FLCBidXNfbmFtZSwgc3RybGVuKGJ1
c19uYW1lKSArIDEpOwoJbmV0bGlua19hdHRyKCZubG1zZywgREVWTElOS19BVFRSX0RFVl9OQU1F
LCBkZXZfbmFtZSwgc3RybGVuKGRldl9uYW1lKSArIDEpOwoJbmV0bGlua19hdHRyKCZubG1zZywg
REVWTElOS19BVFRSX05FVE5TX0ZELCAmbmV0bnNfZmQsIHNpemVvZihuZXRuc19mZCkpOwoJbmV0
bGlua19zZW5kKCZubG1zZywgc29jayk7CmVycm9yOgoJY2xvc2Uoc29jayk7Cn0KCnN0YXRpYyBz
dHJ1Y3Qgbmxtc2cgbmxtc2cyOwoKc3RhdGljIHZvaWQgaW5pdGlhbGl6ZV9kZXZsaW5rX3BvcnRz
KGNvbnN0IGNoYXIqIGJ1c19uYW1lLCBjb25zdCBjaGFyKiBkZXZfbmFtZSwKCQkJCSAgICAgY29u
c3QgY2hhciogbmV0ZGV2X3ByZWZpeCkKewoJc3RydWN0IGdlbmxtc2doZHIgZ2VubGhkcjsKCWlu
dCBsZW4sIHRvdGFsX2xlbiwgaWQsIGVyciwgb2Zmc2V0OwoJdWludDE2X3QgbmV0ZGV2X2luZGV4
OwoJaW50IHNvY2sgPSBzb2NrZXQoQUZfTkVUTElOSywgU09DS19SQVcsIE5FVExJTktfR0VORVJJ
Qyk7CglpZiAoc29jayA9PSAtMSkKCWV4aXQoMSk7CglpbnQgcnRzb2NrID0gc29ja2V0KEFGX05F
VExJTkssIFNPQ0tfUkFXLCBORVRMSU5LX1JPVVRFKTsKCWlmIChydHNvY2sgPT0gLTEpCglleGl0
KDEpOwoJaWQgPSBuZXRsaW5rX2RldmxpbmtfaWRfZ2V0KCZubG1zZywgc29jayk7CglpZiAoaWQg
PT0gLTEpCgkJZ290byBlcnJvcjsKCW1lbXNldCgmZ2VubGhkciwgMCwgc2l6ZW9mKGdlbmxoZHIp
KTsKCWdlbmxoZHIuY21kID0gREVWTElOS19DTURfUE9SVF9HRVQ7CgluZXRsaW5rX2luaXQoJm5s
bXNnLCBpZCwgTkxNX0ZfRFVNUCwgJmdlbmxoZHIsIHNpemVvZihnZW5saGRyKSk7CgluZXRsaW5r
X2F0dHIoJm5sbXNnLCBERVZMSU5LX0FUVFJfQlVTX05BTUUsIGJ1c19uYW1lLCBzdHJsZW4oYnVz
X25hbWUpICsgMSk7CgluZXRsaW5rX2F0dHIoJm5sbXNnLCBERVZMSU5LX0FUVFJfREVWX05BTUUs
IGRldl9uYW1lLCBzdHJsZW4oZGV2X25hbWUpICsgMSk7CgllcnIgPSBuZXRsaW5rX3NlbmRfZXh0
KCZubG1zZywgc29jaywgaWQsICZ0b3RhbF9sZW4pOwoJaWYgKGVycikgewoJCWdvdG8gZXJyb3I7
Cgl9CglvZmZzZXQgPSAwOwoJbmV0ZGV2X2luZGV4ID0gMDsKCXdoaWxlICgobGVuID0gbmV0bGlu
a19uZXh0X21zZygmbmxtc2csIG9mZnNldCwgdG90YWxfbGVuKSkgIT0gLTEpIHsKCQlzdHJ1Y3Qg
bmxhdHRyKiBhdHRyID0gKHN0cnVjdCBubGF0dHIqKShubG1zZy5idWYgKyBvZmZzZXQgKyBOTE1T
R19IRFJMRU4gKyBOTE1TR19BTElHTihzaXplb2YoZ2VubGhkcikpKTsKCQlmb3IgKDsgKGNoYXIq
KWF0dHIgPCBubG1zZy5idWYgKyBvZmZzZXQgKyBsZW47IGF0dHIgPSAoc3RydWN0IG5sYXR0ciop
KChjaGFyKilhdHRyICsgTkxNU0dfQUxJR04oYXR0ci0+bmxhX2xlbikpKSB7CgkJCWlmIChhdHRy
LT5ubGFfdHlwZSA9PSBERVZMSU5LX0FUVFJfTkVUREVWX05BTUUpIHsKCQkJCWNoYXIqIHBvcnRf
bmFtZTsKCQkJCWNoYXIgbmV0ZGV2X25hbWVbSUZOQU1TSVpdOwoJCQkJcG9ydF9uYW1lID0gKGNo
YXIqKShhdHRyICsgMSk7CgkJCQlzbnByaW50ZihuZXRkZXZfbmFtZSwgc2l6ZW9mKG5ldGRldl9u
YW1lKSwgIiVzJWQiLCBuZXRkZXZfcHJlZml4LCBuZXRkZXZfaW5kZXgpOwoJCQkJbmV0bGlua19k
ZXZpY2VfY2hhbmdlKCZubG1zZzIsIHJ0c29jaywgcG9ydF9uYW1lLCB0cnVlLCAwLCAwLCAwLCBu
ZXRkZXZfbmFtZSk7CgkJCQlicmVhazsKCQkJfQoJCX0KCQlvZmZzZXQgKz0gbGVuOwoJCW5ldGRl
dl9pbmRleCsrOwoJfQplcnJvcjoKCWNsb3NlKHJ0c29jayk7CgljbG9zZShzb2NrKTsKfQoKc3Rh
dGljIHZvaWQgaW5pdGlhbGl6ZV9kZXZsaW5rX3BjaSh2b2lkKQp7CglpbnQgbmV0bnMgPSBvcGVu
KCIvcHJvYy9zZWxmL25zL25ldCIsIE9fUkRPTkxZKTsKCWlmIChuZXRucyA9PSAtMSkKCWV4aXQo
MSk7CglpbnQgcmV0ID0gc2V0bnMoa0luaXROZXROc0ZkLCAwKTsKCWlmIChyZXQgPT0gLTEpCgll
eGl0KDEpOwoJbmV0bGlua19kZXZsaW5rX25ldG5zX21vdmUoInBjaSIsICIwMDAwOjAwOjEwLjAi
LCBuZXRucyk7CglyZXQgPSBzZXRucyhuZXRucywgMCk7CglpZiAocmV0ID09IC0xKQoJZXhpdCgx
KTsKCWNsb3NlKG5ldG5zKTsKCWluaXRpYWxpemVfZGV2bGlua19wb3J0cygicGNpIiwgIjAwMDA6
MDA6MTAuMCIsICJuZXRwY2kiKTsKfQoKI2RlZmluZSBERVZfSVBWNCAiMTcyLjIwLjIwLiVkIgoj
ZGVmaW5lIERFVl9JUFY2ICJmZTgwOjolMDJ4IgojZGVmaW5lIERFVl9NQUMgMHgwMGFhYWFhYWFh
YWEKCnN0YXRpYyB2b2lkIG5ldGRldnNpbV9hZGQodW5zaWduZWQgaW50IGFkZHIsIHVuc2lnbmVk
IGludCBwb3J0X2NvdW50KQp7CgljaGFyIGJ1ZlsxNl07CglzcHJpbnRmKGJ1ZiwgIiV1ICV1Iiwg
YWRkciwgcG9ydF9jb3VudCk7Cgl3cml0ZV9maWxlKCIvc3lzL2J1cy9uZXRkZXZzaW0vbmV3X2Rl
dmljZSIsIGJ1Zik7CglzbnByaW50ZihidWYsIHNpemVvZihidWYpLCAibmV0ZGV2c2ltJWQiLCBh
ZGRyKTsKCWluaXRpYWxpemVfZGV2bGlua19wb3J0cygibmV0ZGV2c2ltIiwgYnVmLCAibmV0ZGV2
c2ltIik7Cn0Kc3RhdGljIHZvaWQgaW5pdGlhbGl6ZV9uZXRkZXZpY2VzKHZvaWQpCnsKCWNoYXIg
bmV0ZGV2c2ltWzE2XTsKCXNwcmludGYobmV0ZGV2c2ltLCAibmV0ZGV2c2ltJWQiLCAoaW50KXBy
b2NpZCk7CglzdHJ1Y3QgewoJCWNvbnN0IGNoYXIqIHR5cGU7CgkJY29uc3QgY2hhciogZGV2OwoJ
fSBkZXZ0eXBlc1tdID0gewoJICAgIHsiaXA2Z3JldGFwIiwgImlwNmdyZXRhcDAifSwKCSAgICB7
ImJyaWRnZSIsICJicmlkZ2UwIn0sCgkgICAgeyJ2Y2FuIiwgInZjYW4wIn0sCgkgICAgeyJib25k
IiwgImJvbmQwIn0sCgkgICAgeyJ0ZWFtIiwgInRlYW0wIn0sCgkgICAgeyJkdW1teSIsICJkdW1t
eTAifSwKCSAgICB7Im5sbW9uIiwgIm5sbW9uMCJ9LAoJICAgIHsiY2FpZiIsICJjYWlmMCJ9LAoJ
ICAgIHsiYmF0YWR2IiwgImJhdGFkdjAifSwKCSAgICB7InZ4Y2FuIiwgInZ4Y2FuMSJ9LAoJICAg
IHsibmV0ZGV2c2ltIiwgbmV0ZGV2c2ltfSwKCSAgICB7InZldGgiLCAwfSwKCX07Cgljb25zdCBj
aGFyKiBkZXZtYXN0ZXJzW10gPSB7ImJyaWRnZSIsICJib25kIiwgInRlYW0ifTsKCXN0cnVjdCB7
CgkJY29uc3QgY2hhciogbmFtZTsKCQlpbnQgbWFjc2l6ZTsKCQlib29sIG5vaXB2NjsKCX0gZGV2
aWNlc1tdID0gewoJICAgIHsibG8iLCBFVEhfQUxFTn0sCgkgICAgeyJzaXQwIiwgMH0sCgkgICAg
eyJicmlkZ2UwIiwgRVRIX0FMRU59LAoJICAgIHsidmNhbjAiLCAwLCB0cnVlfSwKCSAgICB7InR1
bmwwIiwgMH0sCgkgICAgeyJncmUwIiwgMH0sCgkgICAgeyJncmV0YXAwIiwgRVRIX0FMRU59LAoJ
ICAgIHsiaXBfdnRpMCIsIDB9LAoJICAgIHsiaXA2X3Z0aTAiLCAwfSwKCSAgICB7ImlwNnRubDAi
LCAwfSwKCSAgICB7ImlwNmdyZTAiLCAwfSwKCSAgICB7ImlwNmdyZXRhcDAiLCBFVEhfQUxFTn0s
CgkgICAgeyJlcnNwYW4wIiwgRVRIX0FMRU59LAoJICAgIHsiYm9uZDAiLCBFVEhfQUxFTn0sCgkg
ICAgeyJ2ZXRoMCIsIEVUSF9BTEVOfSwKCSAgICB7InZldGgxIiwgRVRIX0FMRU59LAoJICAgIHsi
dGVhbTAiLCBFVEhfQUxFTn0sCgkgICAgeyJ2ZXRoMF90b19icmlkZ2UiLCBFVEhfQUxFTn0sCgkg
ICAgeyJ2ZXRoMV90b19icmlkZ2UiLCBFVEhfQUxFTn0sCgkgICAgeyJ2ZXRoMF90b19ib25kIiwg
RVRIX0FMRU59LAoJICAgIHsidmV0aDFfdG9fYm9uZCIsIEVUSF9BTEVOfSwKCSAgICB7InZldGgw
X3RvX3RlYW0iLCBFVEhfQUxFTn0sCgkgICAgeyJ2ZXRoMV90b190ZWFtIiwgRVRIX0FMRU59LAoJ
ICAgIHsidmV0aDBfdG9faHNyIiwgRVRIX0FMRU59LAoJICAgIHsidmV0aDFfdG9faHNyIiwgRVRI
X0FMRU59LAoJICAgIHsiaHNyMCIsIDB9LAoJICAgIHsiZHVtbXkwIiwgRVRIX0FMRU59LAoJICAg
IHsibmxtb24wIiwgMH0sCgkgICAgeyJ2eGNhbjAiLCAwLCB0cnVlfSwKCSAgICB7InZ4Y2FuMSIs
IDAsIHRydWV9LAoJICAgIHsiY2FpZjAiLCBFVEhfQUxFTn0sCgkgICAgeyJiYXRhZHYwIiwgRVRI
X0FMRU59LAoJICAgIHtuZXRkZXZzaW0sIEVUSF9BTEVOfSwKCX07CglpbnQgc29jayA9IHNvY2tl
dChBRl9ORVRMSU5LLCBTT0NLX1JBVywgTkVUTElOS19ST1VURSk7CglpZiAoc29jayA9PSAtMSkK
CWV4aXQoMSk7Cgl1bnNpZ25lZCBpOwoJZm9yIChpID0gMDsgaSA8IHNpemVvZihkZXZ0eXBlcykg
LyBzaXplb2YoZGV2dHlwZXNbMF0pOyBpKyspCgkJbmV0bGlua19hZGRfZGV2aWNlKCZubG1zZywg
c29jaywgZGV2dHlwZXNbaV0udHlwZSwgZGV2dHlwZXNbaV0uZGV2KTsKCWZvciAoaSA9IDA7IGkg
PCBzaXplb2YoZGV2bWFzdGVycykgLyAoc2l6ZW9mKGRldm1hc3RlcnNbMF0pKTsgaSsrKSB7CgkJ
Y2hhciBtYXN0ZXJbMzJdLCBzbGF2ZTBbMzJdLCB2ZXRoMFszMl0sIHNsYXZlMVszMl0sIHZldGgx
WzMyXTsKCQlzcHJpbnRmKHNsYXZlMCwgIiVzX3NsYXZlXzAiLCBkZXZtYXN0ZXJzW2ldKTsKCQlz
cHJpbnRmKHZldGgwLCAidmV0aDBfdG9fJXMiLCBkZXZtYXN0ZXJzW2ldKTsKCQluZXRsaW5rX2Fk
ZF92ZXRoKCZubG1zZywgc29jaywgc2xhdmUwLCB2ZXRoMCk7CgkJc3ByaW50ZihzbGF2ZTEsICIl
c19zbGF2ZV8xIiwgZGV2bWFzdGVyc1tpXSk7CgkJc3ByaW50Zih2ZXRoMSwgInZldGgxX3RvXyVz
IiwgZGV2bWFzdGVyc1tpXSk7CgkJbmV0bGlua19hZGRfdmV0aCgmbmxtc2csIHNvY2ssIHNsYXZl
MSwgdmV0aDEpOwoJCXNwcmludGYobWFzdGVyLCAiJXMwIiwgZGV2bWFzdGVyc1tpXSk7CgkJbmV0
bGlua19kZXZpY2VfY2hhbmdlKCZubG1zZywgc29jaywgc2xhdmUwLCBmYWxzZSwgbWFzdGVyLCAw
LCAwLCBOVUxMKTsKCQluZXRsaW5rX2RldmljZV9jaGFuZ2UoJm5sbXNnLCBzb2NrLCBzbGF2ZTEs
IGZhbHNlLCBtYXN0ZXIsIDAsIDAsIE5VTEwpOwoJfQoJbmV0bGlua19kZXZpY2VfY2hhbmdlKCZu
bG1zZywgc29jaywgImJyaWRnZV9zbGF2ZV8wIiwgdHJ1ZSwgMCwgMCwgMCwgTlVMTCk7CgluZXRs
aW5rX2RldmljZV9jaGFuZ2UoJm5sbXNnLCBzb2NrLCAiYnJpZGdlX3NsYXZlXzEiLCB0cnVlLCAw
LCAwLCAwLCBOVUxMKTsKCW5ldGxpbmtfYWRkX3ZldGgoJm5sbXNnLCBzb2NrLCAiaHNyX3NsYXZl
XzAiLCAidmV0aDBfdG9faHNyIik7CgluZXRsaW5rX2FkZF92ZXRoKCZubG1zZywgc29jaywgImhz
cl9zbGF2ZV8xIiwgInZldGgxX3RvX2hzciIpOwoJbmV0bGlua19hZGRfaHNyKCZubG1zZywgc29j
aywgImhzcjAiLCAiaHNyX3NsYXZlXzAiLCAiaHNyX3NsYXZlXzEiKTsKCW5ldGxpbmtfZGV2aWNl
X2NoYW5nZSgmbmxtc2csIHNvY2ssICJoc3Jfc2xhdmVfMCIsIHRydWUsIDAsIDAsIDAsIE5VTEwp
OwoJbmV0bGlua19kZXZpY2VfY2hhbmdlKCZubG1zZywgc29jaywgImhzcl9zbGF2ZV8xIiwgdHJ1
ZSwgMCwgMCwgMCwgTlVMTCk7CgluZXRkZXZzaW1fYWRkKChpbnQpcHJvY2lkLCA0KTsKCWZvciAo
aSA9IDA7IGkgPCBzaXplb2YoZGV2aWNlcykgLyAoc2l6ZW9mKGRldmljZXNbMF0pKTsgaSsrKSB7
CgkJY2hhciBhZGRyWzMyXTsKCQlzcHJpbnRmKGFkZHIsIERFVl9JUFY0LCBpICsgMTApOwoJCW5l
dGxpbmtfYWRkX2FkZHI0KCZubG1zZywgc29jaywgZGV2aWNlc1tpXS5uYW1lLCBhZGRyKTsKCQlp
ZiAoIWRldmljZXNbaV0ubm9pcHY2KSB7CgkJCXNwcmludGYoYWRkciwgREVWX0lQVjYsIGkgKyAx
MCk7CgkJCW5ldGxpbmtfYWRkX2FkZHI2KCZubG1zZywgc29jaywgZGV2aWNlc1tpXS5uYW1lLCBh
ZGRyKTsKCQl9CgkJdWludDY0X3QgbWFjYWRkciA9IERFVl9NQUMgKyAoKGkgKyAxMHVsbCkgPDwg
NDApOwoJCW5ldGxpbmtfZGV2aWNlX2NoYW5nZSgmbmxtc2csIHNvY2ssIGRldmljZXNbaV0ubmFt
ZSwgdHJ1ZSwgMCwgJm1hY2FkZHIsIGRldmljZXNbaV0ubWFjc2l6ZSwgTlVMTCk7Cgl9CgljbG9z
ZShzb2NrKTsKfQpzdGF0aWMgdm9pZCBpbml0aWFsaXplX25ldGRldmljZXNfaW5pdCh2b2lkKQp7
CglpbnQgc29jayA9IHNvY2tldChBRl9ORVRMSU5LLCBTT0NLX1JBVywgTkVUTElOS19ST1VURSk7
CglpZiAoc29jayA9PSAtMSkKCWV4aXQoMSk7CglzdHJ1Y3QgewoJCWNvbnN0IGNoYXIqIHR5cGU7
CgkJaW50IG1hY3NpemU7CgkJYm9vbCBub2lwdjY7CgkJYm9vbCBub3VwOwoJfSBkZXZ0eXBlc1td
ID0gewoJICAgIHsibnIiLCA3LCB0cnVlfSwKCSAgICB7InJvc2UiLCA1LCB0cnVlLCB0cnVlfSwK
CX07Cgl1bnNpZ25lZCBpOwoJZm9yIChpID0gMDsgaSA8IHNpemVvZihkZXZ0eXBlcykgLyBzaXpl
b2YoZGV2dHlwZXNbMF0pOyBpKyspIHsKCQljaGFyIGRldlszMl0sIGFkZHJbMzJdOwoJCXNwcmlu
dGYoZGV2LCAiJXMlZCIsIGRldnR5cGVzW2ldLnR5cGUsIChpbnQpcHJvY2lkKTsKCQlzcHJpbnRm
KGFkZHIsICIxNzIuMzAuJWQuJWQiLCBpLCAoaW50KXByb2NpZCArIDEpOwoJCW5ldGxpbmtfYWRk
X2FkZHI0KCZubG1zZywgc29jaywgZGV2LCBhZGRyKTsKCQlpZiAoIWRldnR5cGVzW2ldLm5vaXB2
NikgewoJCQlzcHJpbnRmKGFkZHIsICJmZTg4OjolMDJ4OiUwMngiLCBpLCAoaW50KXByb2NpZCAr
IDEpOwoJCQluZXRsaW5rX2FkZF9hZGRyNigmbmxtc2csIHNvY2ssIGRldiwgYWRkcik7CgkJfQoJ
CWludCBtYWNzaXplID0gZGV2dHlwZXNbaV0ubWFjc2l6ZTsKCQl1aW50NjRfdCBtYWNhZGRyID0g
MHhiYmJiYmIgKyAoKHVuc2lnbmVkIGxvbmcgbG9uZylpIDw8ICg4ICogKG1hY3NpemUgLSAyKSkp
ICsKCQkJCSAocHJvY2lkIDw8ICg4ICogKG1hY3NpemUgLSAxKSkpOwoJCW5ldGxpbmtfZGV2aWNl
X2NoYW5nZSgmbmxtc2csIHNvY2ssIGRldiwgIWRldnR5cGVzW2ldLm5vdXAsIDAsICZtYWNhZGRy
LCBtYWNzaXplLCBOVUxMKTsKCX0KCWNsb3NlKHNvY2spOwp9CgpzdGF0aWMgaW50IHJlYWRfdHVu
KGNoYXIqIGRhdGEsIGludCBzaXplKQp7CglpZiAodHVuZmQgPCAwKQoJCXJldHVybiAtMTsKCWlu
dCBydiA9IHJlYWQodHVuZmQsIGRhdGEsIHNpemUpOwoJaWYgKHJ2IDwgMCkgewoJCWlmIChlcnJu
byA9PSBFQUdBSU4pCgkJCXJldHVybiAtMTsKCQlpZiAoZXJybm8gPT0gRUJBREZEKQoJCQlyZXR1
cm4gLTE7CglleGl0KDEpOwoJfQoJcmV0dXJuIHJ2Owp9CgpzdGF0aWMgdm9pZCBmbHVzaF90dW4o
KQp7CgljaGFyIGRhdGFbMTAwMF07Cgl3aGlsZSAocmVhZF90dW4oJmRhdGFbMF0sIHNpemVvZihk
YXRhKSkgIT0gLTEpIHsKCX0KfQoKI2RlZmluZSBNQVhfRkRTIDMwCgojZGVmaW5lIFhUX1RBQkxF
X1NJWkUgMTUzNgojZGVmaW5lIFhUX01BWF9FTlRSSUVTIDEwCgpzdHJ1Y3QgeHRfY291bnRlcnMg
ewoJdWludDY0X3QgcGNudCwgYmNudDsKfTsKCnN0cnVjdCBpcHRfZ2V0aW5mbyB7CgljaGFyIG5h
bWVbMzJdOwoJdW5zaWduZWQgaW50IHZhbGlkX2hvb2tzOwoJdW5zaWduZWQgaW50IGhvb2tfZW50
cnlbNV07Cgl1bnNpZ25lZCBpbnQgdW5kZXJmbG93WzVdOwoJdW5zaWduZWQgaW50IG51bV9lbnRy
aWVzOwoJdW5zaWduZWQgaW50IHNpemU7Cn07CgpzdHJ1Y3QgaXB0X2dldF9lbnRyaWVzIHsKCWNo
YXIgbmFtZVszMl07Cgl1bnNpZ25lZCBpbnQgc2l6ZTsKCXZvaWQqIGVudHJ5dGFibGVbWFRfVEFC
TEVfU0laRSAvIHNpemVvZih2b2lkKildOwp9OwoKc3RydWN0IGlwdF9yZXBsYWNlIHsKCWNoYXIg
bmFtZVszMl07Cgl1bnNpZ25lZCBpbnQgdmFsaWRfaG9va3M7Cgl1bnNpZ25lZCBpbnQgbnVtX2Vu
dHJpZXM7Cgl1bnNpZ25lZCBpbnQgc2l6ZTsKCXVuc2lnbmVkIGludCBob29rX2VudHJ5WzVdOwoJ
dW5zaWduZWQgaW50IHVuZGVyZmxvd1s1XTsKCXVuc2lnbmVkIGludCBudW1fY291bnRlcnM7Cglz
dHJ1Y3QgeHRfY291bnRlcnMqIGNvdW50ZXJzOwoJY2hhciBlbnRyeXRhYmxlW1hUX1RBQkxFX1NJ
WkVdOwp9OwoKc3RydWN0IGlwdF90YWJsZV9kZXNjIHsKCWNvbnN0IGNoYXIqIG5hbWU7CglzdHJ1
Y3QgaXB0X2dldGluZm8gaW5mbzsKCXN0cnVjdCBpcHRfcmVwbGFjZSByZXBsYWNlOwp9OwoKc3Rh
dGljIHN0cnVjdCBpcHRfdGFibGVfZGVzYyBpcHY0X3RhYmxlc1tdID0gewogICAgey5uYW1lID0g
ImZpbHRlciJ9LAogICAgey5uYW1lID0gIm5hdCJ9LAogICAgey5uYW1lID0gIm1hbmdsZSJ9LAog
ICAgey5uYW1lID0gInJhdyJ9LAogICAgey5uYW1lID0gInNlY3VyaXR5In0sCn07CgpzdGF0aWMg
c3RydWN0IGlwdF90YWJsZV9kZXNjIGlwdjZfdGFibGVzW10gPSB7CiAgICB7Lm5hbWUgPSAiZmls
dGVyIn0sCiAgICB7Lm5hbWUgPSAibmF0In0sCiAgICB7Lm5hbWUgPSAibWFuZ2xlIn0sCiAgICB7
Lm5hbWUgPSAicmF3In0sCiAgICB7Lm5hbWUgPSAic2VjdXJpdHkifSwKfTsKCiNkZWZpbmUgSVBU
X0JBU0VfQ1RMIDY0CiNkZWZpbmUgSVBUX1NPX1NFVF9SRVBMQUNFIChJUFRfQkFTRV9DVEwpCiNk
ZWZpbmUgSVBUX1NPX0dFVF9JTkZPIChJUFRfQkFTRV9DVEwpCiNkZWZpbmUgSVBUX1NPX0dFVF9F
TlRSSUVTIChJUFRfQkFTRV9DVEwgKyAxKQoKc3RydWN0IGFycHRfZ2V0aW5mbyB7CgljaGFyIG5h
bWVbMzJdOwoJdW5zaWduZWQgaW50IHZhbGlkX2hvb2tzOwoJdW5zaWduZWQgaW50IGhvb2tfZW50
cnlbM107Cgl1bnNpZ25lZCBpbnQgdW5kZXJmbG93WzNdOwoJdW5zaWduZWQgaW50IG51bV9lbnRy
aWVzOwoJdW5zaWduZWQgaW50IHNpemU7Cn07CgpzdHJ1Y3QgYXJwdF9nZXRfZW50cmllcyB7Cglj
aGFyIG5hbWVbMzJdOwoJdW5zaWduZWQgaW50IHNpemU7Cgl2b2lkKiBlbnRyeXRhYmxlW1hUX1RB
QkxFX1NJWkUgLyBzaXplb2Yodm9pZCopXTsKfTsKCnN0cnVjdCBhcnB0X3JlcGxhY2UgewoJY2hh
ciBuYW1lWzMyXTsKCXVuc2lnbmVkIGludCB2YWxpZF9ob29rczsKCXVuc2lnbmVkIGludCBudW1f
ZW50cmllczsKCXVuc2lnbmVkIGludCBzaXplOwoJdW5zaWduZWQgaW50IGhvb2tfZW50cnlbM107
Cgl1bnNpZ25lZCBpbnQgdW5kZXJmbG93WzNdOwoJdW5zaWduZWQgaW50IG51bV9jb3VudGVyczsK
CXN0cnVjdCB4dF9jb3VudGVycyogY291bnRlcnM7CgljaGFyIGVudHJ5dGFibGVbWFRfVEFCTEVf
U0laRV07Cn07CgpzdHJ1Y3QgYXJwdF90YWJsZV9kZXNjIHsKCWNvbnN0IGNoYXIqIG5hbWU7Cglz
dHJ1Y3QgYXJwdF9nZXRpbmZvIGluZm87CglzdHJ1Y3QgYXJwdF9yZXBsYWNlIHJlcGxhY2U7Cn07
CgpzdGF0aWMgc3RydWN0IGFycHRfdGFibGVfZGVzYyBhcnB0X3RhYmxlc1tdID0gewogICAgey5u
YW1lID0gImZpbHRlciJ9LAp9OwoKI2RlZmluZSBBUlBUX0JBU0VfQ1RMIDk2CiNkZWZpbmUgQVJQ
VF9TT19TRVRfUkVQTEFDRSAoQVJQVF9CQVNFX0NUTCkKI2RlZmluZSBBUlBUX1NPX0dFVF9JTkZP
IChBUlBUX0JBU0VfQ1RMKQojZGVmaW5lIEFSUFRfU09fR0VUX0VOVFJJRVMgKEFSUFRfQkFTRV9D
VEwgKyAxKQoKc3RhdGljIHZvaWQgY2hlY2twb2ludF9pcHRhYmxlcyhzdHJ1Y3QgaXB0X3RhYmxl
X2Rlc2MqIHRhYmxlcywgaW50IG51bV90YWJsZXMsIGludCBmYW1pbHksIGludCBsZXZlbCkKewoJ
c3RydWN0IGlwdF9nZXRfZW50cmllcyBlbnRyaWVzOwoJc29ja2xlbl90IG9wdGxlbjsKCWludCBm
ZCwgaTsKCWZkID0gc29ja2V0KGZhbWlseSwgU09DS19TVFJFQU0sIElQUFJPVE9fVENQKTsKCWlm
IChmZCA9PSAtMSkgewoJCXN3aXRjaCAoZXJybm8pIHsKCQljYXNlIEVBRk5PU1VQUE9SVDoKCQlj
YXNlIEVOT1BST1RPT1BUOgoJCQlyZXR1cm47CgkJfQoJZXhpdCgxKTsKCX0KCWZvciAoaSA9IDA7
IGkgPCBudW1fdGFibGVzOyBpKyspIHsKCQlzdHJ1Y3QgaXB0X3RhYmxlX2Rlc2MqIHRhYmxlID0g
JnRhYmxlc1tpXTsKCQlzdHJjcHkodGFibGUtPmluZm8ubmFtZSwgdGFibGUtPm5hbWUpOwoJCXN0
cmNweSh0YWJsZS0+cmVwbGFjZS5uYW1lLCB0YWJsZS0+bmFtZSk7CgkJb3B0bGVuID0gc2l6ZW9m
KHRhYmxlLT5pbmZvKTsKCQlpZiAoZ2V0c29ja29wdChmZCwgbGV2ZWwsIElQVF9TT19HRVRfSU5G
TywgJnRhYmxlLT5pbmZvLCAmb3B0bGVuKSkgewoJCQlzd2l0Y2ggKGVycm5vKSB7CgkJCWNhc2Ug
RVBFUk06CgkJCWNhc2UgRU5PRU5UOgoJCQljYXNlIEVOT1BST1RPT1BUOgoJCQkJY29udGludWU7
CgkJCX0KCWV4aXQoMSk7CgkJfQoJCWlmICh0YWJsZS0+aW5mby5zaXplID4gc2l6ZW9mKHRhYmxl
LT5yZXBsYWNlLmVudHJ5dGFibGUpKQoJZXhpdCgxKTsKCQlpZiAodGFibGUtPmluZm8ubnVtX2Vu
dHJpZXMgPiBYVF9NQVhfRU5UUklFUykKCWV4aXQoMSk7CgkJbWVtc2V0KCZlbnRyaWVzLCAwLCBz
aXplb2YoZW50cmllcykpOwoJCXN0cmNweShlbnRyaWVzLm5hbWUsIHRhYmxlLT5uYW1lKTsKCQll
bnRyaWVzLnNpemUgPSB0YWJsZS0+aW5mby5zaXplOwoJCW9wdGxlbiA9IHNpemVvZihlbnRyaWVz
KSAtIHNpemVvZihlbnRyaWVzLmVudHJ5dGFibGUpICsgdGFibGUtPmluZm8uc2l6ZTsKCQlpZiAo
Z2V0c29ja29wdChmZCwgbGV2ZWwsIElQVF9TT19HRVRfRU5UUklFUywgJmVudHJpZXMsICZvcHRs
ZW4pKQoJZXhpdCgxKTsKCQl0YWJsZS0+cmVwbGFjZS52YWxpZF9ob29rcyA9IHRhYmxlLT5pbmZv
LnZhbGlkX2hvb2tzOwoJCXRhYmxlLT5yZXBsYWNlLm51bV9lbnRyaWVzID0gdGFibGUtPmluZm8u
bnVtX2VudHJpZXM7CgkJdGFibGUtPnJlcGxhY2Uuc2l6ZSA9IHRhYmxlLT5pbmZvLnNpemU7CgkJ
bWVtY3B5KHRhYmxlLT5yZXBsYWNlLmhvb2tfZW50cnksIHRhYmxlLT5pbmZvLmhvb2tfZW50cnks
IHNpemVvZih0YWJsZS0+cmVwbGFjZS5ob29rX2VudHJ5KSk7CgkJbWVtY3B5KHRhYmxlLT5yZXBs
YWNlLnVuZGVyZmxvdywgdGFibGUtPmluZm8udW5kZXJmbG93LCBzaXplb2YodGFibGUtPnJlcGxh
Y2UudW5kZXJmbG93KSk7CgkJbWVtY3B5KHRhYmxlLT5yZXBsYWNlLmVudHJ5dGFibGUsIGVudHJp
ZXMuZW50cnl0YWJsZSwgdGFibGUtPmluZm8uc2l6ZSk7Cgl9CgljbG9zZShmZCk7Cn0KCnN0YXRp
YyB2b2lkIHJlc2V0X2lwdGFibGVzKHN0cnVjdCBpcHRfdGFibGVfZGVzYyogdGFibGVzLCBpbnQg
bnVtX3RhYmxlcywgaW50IGZhbWlseSwgaW50IGxldmVsKQp7CglzdHJ1Y3QgeHRfY291bnRlcnMg
Y291bnRlcnNbWFRfTUFYX0VOVFJJRVNdOwoJc3RydWN0IGlwdF9nZXRfZW50cmllcyBlbnRyaWVz
OwoJc3RydWN0IGlwdF9nZXRpbmZvIGluZm87Cglzb2NrbGVuX3Qgb3B0bGVuOwoJaW50IGZkLCBp
OwoJZmQgPSBzb2NrZXQoZmFtaWx5LCBTT0NLX1NUUkVBTSwgSVBQUk9UT19UQ1ApOwoJaWYgKGZk
ID09IC0xKSB7CgkJc3dpdGNoIChlcnJubykgewoJCWNhc2UgRUFGTk9TVVBQT1JUOgoJCWNhc2Ug
RU5PUFJPVE9PUFQ6CgkJCXJldHVybjsKCQl9CglleGl0KDEpOwoJfQoJZm9yIChpID0gMDsgaSA8
IG51bV90YWJsZXM7IGkrKykgewoJCXN0cnVjdCBpcHRfdGFibGVfZGVzYyogdGFibGUgPSAmdGFi
bGVzW2ldOwoJCWlmICh0YWJsZS0+aW5mby52YWxpZF9ob29rcyA9PSAwKQoJCQljb250aW51ZTsK
CQltZW1zZXQoJmluZm8sIDAsIHNpemVvZihpbmZvKSk7CgkJc3RyY3B5KGluZm8ubmFtZSwgdGFi
bGUtPm5hbWUpOwoJCW9wdGxlbiA9IHNpemVvZihpbmZvKTsKCQlpZiAoZ2V0c29ja29wdChmZCwg
bGV2ZWwsIElQVF9TT19HRVRfSU5GTywgJmluZm8sICZvcHRsZW4pKQoJZXhpdCgxKTsKCQlpZiAo
bWVtY21wKCZ0YWJsZS0+aW5mbywgJmluZm8sIHNpemVvZih0YWJsZS0+aW5mbykpID09IDApIHsK
CQkJbWVtc2V0KCZlbnRyaWVzLCAwLCBzaXplb2YoZW50cmllcykpOwoJCQlzdHJjcHkoZW50cmll
cy5uYW1lLCB0YWJsZS0+bmFtZSk7CgkJCWVudHJpZXMuc2l6ZSA9IHRhYmxlLT5pbmZvLnNpemU7
CgkJCW9wdGxlbiA9IHNpemVvZihlbnRyaWVzKSAtIHNpemVvZihlbnRyaWVzLmVudHJ5dGFibGUp
ICsgZW50cmllcy5zaXplOwoJCQlpZiAoZ2V0c29ja29wdChmZCwgbGV2ZWwsIElQVF9TT19HRVRf
RU5UUklFUywgJmVudHJpZXMsICZvcHRsZW4pKQoJZXhpdCgxKTsKCQkJaWYgKG1lbWNtcCh0YWJs
ZS0+cmVwbGFjZS5lbnRyeXRhYmxlLCBlbnRyaWVzLmVudHJ5dGFibGUsIHRhYmxlLT5pbmZvLnNp
emUpID09IDApCgkJCQljb250aW51ZTsKCQl9CgkJdGFibGUtPnJlcGxhY2UubnVtX2NvdW50ZXJz
ID0gaW5mby5udW1fZW50cmllczsKCQl0YWJsZS0+cmVwbGFjZS5jb3VudGVycyA9IGNvdW50ZXJz
OwoJCW9wdGxlbiA9IHNpemVvZih0YWJsZS0+cmVwbGFjZSkgLSBzaXplb2YodGFibGUtPnJlcGxh
Y2UuZW50cnl0YWJsZSkgKyB0YWJsZS0+cmVwbGFjZS5zaXplOwoJCWlmIChzZXRzb2Nrb3B0KGZk
LCBsZXZlbCwgSVBUX1NPX1NFVF9SRVBMQUNFLCAmdGFibGUtPnJlcGxhY2UsIG9wdGxlbikpCgll
eGl0KDEpOwoJfQoJY2xvc2UoZmQpOwp9CgpzdGF0aWMgdm9pZCBjaGVja3BvaW50X2FycHRhYmxl
cyh2b2lkKQp7CglzdHJ1Y3QgYXJwdF9nZXRfZW50cmllcyBlbnRyaWVzOwoJc29ja2xlbl90IG9w
dGxlbjsKCXVuc2lnbmVkIGk7CglpbnQgZmQ7CglmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NU
UkVBTSwgSVBQUk9UT19UQ1ApOwoJaWYgKGZkID09IC0xKSB7CgkJc3dpdGNoIChlcnJubykgewoJ
CWNhc2UgRUFGTk9TVVBQT1JUOgoJCWNhc2UgRU5PUFJPVE9PUFQ6CgkJCXJldHVybjsKCQl9Cgll
eGl0KDEpOwoJfQoJZm9yIChpID0gMDsgaSA8IHNpemVvZihhcnB0X3RhYmxlcykgLyBzaXplb2Yo
YXJwdF90YWJsZXNbMF0pOyBpKyspIHsKCQlzdHJ1Y3QgYXJwdF90YWJsZV9kZXNjKiB0YWJsZSA9
ICZhcnB0X3RhYmxlc1tpXTsKCQlzdHJjcHkodGFibGUtPmluZm8ubmFtZSwgdGFibGUtPm5hbWUp
OwoJCXN0cmNweSh0YWJsZS0+cmVwbGFjZS5uYW1lLCB0YWJsZS0+bmFtZSk7CgkJb3B0bGVuID0g
c2l6ZW9mKHRhYmxlLT5pbmZvKTsKCQlpZiAoZ2V0c29ja29wdChmZCwgU09MX0lQLCBBUlBUX1NP
X0dFVF9JTkZPLCAmdGFibGUtPmluZm8sICZvcHRsZW4pKSB7CgkJCXN3aXRjaCAoZXJybm8pIHsK
CQkJY2FzZSBFUEVSTToKCQkJY2FzZSBFTk9FTlQ6CgkJCWNhc2UgRU5PUFJPVE9PUFQ6CgkJCQlj
b250aW51ZTsKCQkJfQoJZXhpdCgxKTsKCQl9CgkJaWYgKHRhYmxlLT5pbmZvLnNpemUgPiBzaXpl
b2YodGFibGUtPnJlcGxhY2UuZW50cnl0YWJsZSkpCglleGl0KDEpOwoJCWlmICh0YWJsZS0+aW5m
by5udW1fZW50cmllcyA+IFhUX01BWF9FTlRSSUVTKQoJZXhpdCgxKTsKCQltZW1zZXQoJmVudHJp
ZXMsIDAsIHNpemVvZihlbnRyaWVzKSk7CgkJc3RyY3B5KGVudHJpZXMubmFtZSwgdGFibGUtPm5h
bWUpOwoJCWVudHJpZXMuc2l6ZSA9IHRhYmxlLT5pbmZvLnNpemU7CgkJb3B0bGVuID0gc2l6ZW9m
KGVudHJpZXMpIC0gc2l6ZW9mKGVudHJpZXMuZW50cnl0YWJsZSkgKyB0YWJsZS0+aW5mby5zaXpl
OwoJCWlmIChnZXRzb2Nrb3B0KGZkLCBTT0xfSVAsIEFSUFRfU09fR0VUX0VOVFJJRVMsICZlbnRy
aWVzLCAmb3B0bGVuKSkKCWV4aXQoMSk7CgkJdGFibGUtPnJlcGxhY2UudmFsaWRfaG9va3MgPSB0
YWJsZS0+aW5mby52YWxpZF9ob29rczsKCQl0YWJsZS0+cmVwbGFjZS5udW1fZW50cmllcyA9IHRh
YmxlLT5pbmZvLm51bV9lbnRyaWVzOwoJCXRhYmxlLT5yZXBsYWNlLnNpemUgPSB0YWJsZS0+aW5m
by5zaXplOwoJCW1lbWNweSh0YWJsZS0+cmVwbGFjZS5ob29rX2VudHJ5LCB0YWJsZS0+aW5mby5o
b29rX2VudHJ5LCBzaXplb2YodGFibGUtPnJlcGxhY2UuaG9va19lbnRyeSkpOwoJCW1lbWNweSh0
YWJsZS0+cmVwbGFjZS51bmRlcmZsb3csIHRhYmxlLT5pbmZvLnVuZGVyZmxvdywgc2l6ZW9mKHRh
YmxlLT5yZXBsYWNlLnVuZGVyZmxvdykpOwoJCW1lbWNweSh0YWJsZS0+cmVwbGFjZS5lbnRyeXRh
YmxlLCBlbnRyaWVzLmVudHJ5dGFibGUsIHRhYmxlLT5pbmZvLnNpemUpOwoJfQoJY2xvc2UoZmQp
Owp9CgpzdGF0aWMgdm9pZCByZXNldF9hcnB0YWJsZXMoKQp7CglzdHJ1Y3QgeHRfY291bnRlcnMg
Y291bnRlcnNbWFRfTUFYX0VOVFJJRVNdOwoJc3RydWN0IGFycHRfZ2V0X2VudHJpZXMgZW50cmll
czsKCXN0cnVjdCBhcnB0X2dldGluZm8gaW5mbzsKCXNvY2tsZW5fdCBvcHRsZW47Cgl1bnNpZ25l
ZCBpOwoJaW50IGZkOwoJZmQgPSBzb2NrZXQoQUZfSU5FVCwgU09DS19TVFJFQU0sIElQUFJPVE9f
VENQKTsKCWlmIChmZCA9PSAtMSkgewoJCXN3aXRjaCAoZXJybm8pIHsKCQljYXNlIEVBRk5PU1VQ
UE9SVDoKCQljYXNlIEVOT1BST1RPT1BUOgoJCQlyZXR1cm47CgkJfQoJZXhpdCgxKTsKCX0KCWZv
ciAoaSA9IDA7IGkgPCBzaXplb2YoYXJwdF90YWJsZXMpIC8gc2l6ZW9mKGFycHRfdGFibGVzWzBd
KTsgaSsrKSB7CgkJc3RydWN0IGFycHRfdGFibGVfZGVzYyogdGFibGUgPSAmYXJwdF90YWJsZXNb
aV07CgkJaWYgKHRhYmxlLT5pbmZvLnZhbGlkX2hvb2tzID09IDApCgkJCWNvbnRpbnVlOwoJCW1l
bXNldCgmaW5mbywgMCwgc2l6ZW9mKGluZm8pKTsKCQlzdHJjcHkoaW5mby5uYW1lLCB0YWJsZS0+
bmFtZSk7CgkJb3B0bGVuID0gc2l6ZW9mKGluZm8pOwoJCWlmIChnZXRzb2Nrb3B0KGZkLCBTT0xf
SVAsIEFSUFRfU09fR0VUX0lORk8sICZpbmZvLCAmb3B0bGVuKSkKCWV4aXQoMSk7CgkJaWYgKG1l
bWNtcCgmdGFibGUtPmluZm8sICZpbmZvLCBzaXplb2YodGFibGUtPmluZm8pKSA9PSAwKSB7CgkJ
CW1lbXNldCgmZW50cmllcywgMCwgc2l6ZW9mKGVudHJpZXMpKTsKCQkJc3RyY3B5KGVudHJpZXMu
bmFtZSwgdGFibGUtPm5hbWUpOwoJCQllbnRyaWVzLnNpemUgPSB0YWJsZS0+aW5mby5zaXplOwoJ
CQlvcHRsZW4gPSBzaXplb2YoZW50cmllcykgLSBzaXplb2YoZW50cmllcy5lbnRyeXRhYmxlKSAr
IGVudHJpZXMuc2l6ZTsKCQkJaWYgKGdldHNvY2tvcHQoZmQsIFNPTF9JUCwgQVJQVF9TT19HRVRf
RU5UUklFUywgJmVudHJpZXMsICZvcHRsZW4pKQoJZXhpdCgxKTsKCQkJaWYgKG1lbWNtcCh0YWJs
ZS0+cmVwbGFjZS5lbnRyeXRhYmxlLCBlbnRyaWVzLmVudHJ5dGFibGUsIHRhYmxlLT5pbmZvLnNp
emUpID09IDApCgkJCQljb250aW51ZTsKCQl9IGVsc2UgewoJCX0KCQl0YWJsZS0+cmVwbGFjZS5u
dW1fY291bnRlcnMgPSBpbmZvLm51bV9lbnRyaWVzOwoJCXRhYmxlLT5yZXBsYWNlLmNvdW50ZXJz
ID0gY291bnRlcnM7CgkJb3B0bGVuID0gc2l6ZW9mKHRhYmxlLT5yZXBsYWNlKSAtIHNpemVvZih0
YWJsZS0+cmVwbGFjZS5lbnRyeXRhYmxlKSArIHRhYmxlLT5yZXBsYWNlLnNpemU7CgkJaWYgKHNl
dHNvY2tvcHQoZmQsIFNPTF9JUCwgQVJQVF9TT19TRVRfUkVQTEFDRSwgJnRhYmxlLT5yZXBsYWNl
LCBvcHRsZW4pKQoJZXhpdCgxKTsKCX0KCWNsb3NlKGZkKTsKfQoKI2RlZmluZSBORl9CUl9OVU1I
T09LUyA2CiNkZWZpbmUgRUJUX1RBQkxFX01BWE5BTUVMRU4gMzIKI2RlZmluZSBFQlRfQ0hBSU5f
TUFYTkFNRUxFTiAzMgojZGVmaW5lIEVCVF9CQVNFX0NUTCAxMjgKI2RlZmluZSBFQlRfU09fU0VU
X0VOVFJJRVMgKEVCVF9CQVNFX0NUTCkKI2RlZmluZSBFQlRfU09fR0VUX0lORk8gKEVCVF9CQVNF
X0NUTCkKI2RlZmluZSBFQlRfU09fR0VUX0VOVFJJRVMgKEVCVF9TT19HRVRfSU5GTyArIDEpCiNk
ZWZpbmUgRUJUX1NPX0dFVF9JTklUX0lORk8gKEVCVF9TT19HRVRfRU5UUklFUyArIDEpCiNkZWZp
bmUgRUJUX1NPX0dFVF9JTklUX0VOVFJJRVMgKEVCVF9TT19HRVRfSU5JVF9JTkZPICsgMSkKCnN0
cnVjdCBlYnRfcmVwbGFjZSB7CgljaGFyIG5hbWVbRUJUX1RBQkxFX01BWE5BTUVMRU5dOwoJdW5z
aWduZWQgaW50IHZhbGlkX2hvb2tzOwoJdW5zaWduZWQgaW50IG5lbnRyaWVzOwoJdW5zaWduZWQg
aW50IGVudHJpZXNfc2l6ZTsKCXN0cnVjdCBlYnRfZW50cmllcyogaG9va19lbnRyeVtORl9CUl9O
VU1IT09LU107Cgl1bnNpZ25lZCBpbnQgbnVtX2NvdW50ZXJzOwoJc3RydWN0IGVidF9jb3VudGVy
KiBjb3VudGVyczsKCWNoYXIqIGVudHJpZXM7Cn07CgpzdHJ1Y3QgZWJ0X2VudHJpZXMgewoJdW5z
aWduZWQgaW50IGRpc3Rpbmd1aXNoZXI7CgljaGFyIG5hbWVbRUJUX0NIQUlOX01BWE5BTUVMRU5d
OwoJdW5zaWduZWQgaW50IGNvdW50ZXJfb2Zmc2V0OwoJaW50IHBvbGljeTsKCXVuc2lnbmVkIGlu
dCBuZW50cmllczsKCWNoYXIgZGF0YVswXSBfX2F0dHJpYnV0ZV9fKChhbGlnbmVkKF9fYWxpZ25v
Zl9fKHN0cnVjdCBlYnRfcmVwbGFjZSkpKSk7Cn07CgpzdHJ1Y3QgZWJ0X3RhYmxlX2Rlc2MgewoJ
Y29uc3QgY2hhciogbmFtZTsKCXN0cnVjdCBlYnRfcmVwbGFjZSByZXBsYWNlOwoJY2hhciBlbnRy
eXRhYmxlW1hUX1RBQkxFX1NJWkVdOwp9OwoKc3RhdGljIHN0cnVjdCBlYnRfdGFibGVfZGVzYyBl
YnRfdGFibGVzW10gPSB7CiAgICB7Lm5hbWUgPSAiZmlsdGVyIn0sCiAgICB7Lm5hbWUgPSAibmF0
In0sCiAgICB7Lm5hbWUgPSAiYnJvdXRlIn0sCn07CgpzdGF0aWMgdm9pZCBjaGVja3BvaW50X2Vi
dGFibGVzKHZvaWQpCnsKCXNvY2tsZW5fdCBvcHRsZW47Cgl1bnNpZ25lZCBpOwoJaW50IGZkOwoJ
ZmQgPSBzb2NrZXQoQUZfSU5FVCwgU09DS19TVFJFQU0sIElQUFJPVE9fVENQKTsKCWlmIChmZCA9
PSAtMSkgewoJCXN3aXRjaCAoZXJybm8pIHsKCQljYXNlIEVBRk5PU1VQUE9SVDoKCQljYXNlIEVO
T1BST1RPT1BUOgoJCQlyZXR1cm47CgkJfQoJZXhpdCgxKTsKCX0KCWZvciAoaSA9IDA7IGkgPCBz
aXplb2YoZWJ0X3RhYmxlcykgLyBzaXplb2YoZWJ0X3RhYmxlc1swXSk7IGkrKykgewoJCXN0cnVj
dCBlYnRfdGFibGVfZGVzYyogdGFibGUgPSAmZWJ0X3RhYmxlc1tpXTsKCQlzdHJjcHkodGFibGUt
PnJlcGxhY2UubmFtZSwgdGFibGUtPm5hbWUpOwoJCW9wdGxlbiA9IHNpemVvZih0YWJsZS0+cmVw
bGFjZSk7CgkJaWYgKGdldHNvY2tvcHQoZmQsIFNPTF9JUCwgRUJUX1NPX0dFVF9JTklUX0lORk8s
ICZ0YWJsZS0+cmVwbGFjZSwgJm9wdGxlbikpIHsKCQkJc3dpdGNoIChlcnJubykgewoJCQljYXNl
IEVQRVJNOgoJCQljYXNlIEVOT0VOVDoKCQkJY2FzZSBFTk9QUk9UT09QVDoKCQkJCWNvbnRpbnVl
OwoJCQl9CglleGl0KDEpOwoJCX0KCQlpZiAodGFibGUtPnJlcGxhY2UuZW50cmllc19zaXplID4g
c2l6ZW9mKHRhYmxlLT5lbnRyeXRhYmxlKSkKCWV4aXQoMSk7CgkJdGFibGUtPnJlcGxhY2UubnVt
X2NvdW50ZXJzID0gMDsKCQl0YWJsZS0+cmVwbGFjZS5lbnRyaWVzID0gdGFibGUtPmVudHJ5dGFi
bGU7CgkJb3B0bGVuID0gc2l6ZW9mKHRhYmxlLT5yZXBsYWNlKSArIHRhYmxlLT5yZXBsYWNlLmVu
dHJpZXNfc2l6ZTsKCQlpZiAoZ2V0c29ja29wdChmZCwgU09MX0lQLCBFQlRfU09fR0VUX0lOSVRf
RU5UUklFUywgJnRhYmxlLT5yZXBsYWNlLCAmb3B0bGVuKSkKCWV4aXQoMSk7Cgl9CgljbG9zZShm
ZCk7Cn0KCnN0YXRpYyB2b2lkIHJlc2V0X2VidGFibGVzKCkKewoJc3RydWN0IGVidF9yZXBsYWNl
IHJlcGxhY2U7CgljaGFyIGVudHJ5dGFibGVbWFRfVEFCTEVfU0laRV07Cglzb2NrbGVuX3Qgb3B0
bGVuOwoJdW5zaWduZWQgaSwgaiwgaDsKCWludCBmZDsKCWZkID0gc29ja2V0KEFGX0lORVQsIFNP
Q0tfU1RSRUFNLCBJUFBST1RPX1RDUCk7CglpZiAoZmQgPT0gLTEpIHsKCQlzd2l0Y2ggKGVycm5v
KSB7CgkJY2FzZSBFQUZOT1NVUFBPUlQ6CgkJY2FzZSBFTk9QUk9UT09QVDoKCQkJcmV0dXJuOwoJ
CX0KCWV4aXQoMSk7Cgl9Cglmb3IgKGkgPSAwOyBpIDwgc2l6ZW9mKGVidF90YWJsZXMpIC8gc2l6
ZW9mKGVidF90YWJsZXNbMF0pOyBpKyspIHsKCQlzdHJ1Y3QgZWJ0X3RhYmxlX2Rlc2MqIHRhYmxl
ID0gJmVidF90YWJsZXNbaV07CgkJaWYgKHRhYmxlLT5yZXBsYWNlLnZhbGlkX2hvb2tzID09IDAp
CgkJCWNvbnRpbnVlOwoJCW1lbXNldCgmcmVwbGFjZSwgMCwgc2l6ZW9mKHJlcGxhY2UpKTsKCQlz
dHJjcHkocmVwbGFjZS5uYW1lLCB0YWJsZS0+bmFtZSk7CgkJb3B0bGVuID0gc2l6ZW9mKHJlcGxh
Y2UpOwoJCWlmIChnZXRzb2Nrb3B0KGZkLCBTT0xfSVAsIEVCVF9TT19HRVRfSU5GTywgJnJlcGxh
Y2UsICZvcHRsZW4pKQoJZXhpdCgxKTsKCQlyZXBsYWNlLm51bV9jb3VudGVycyA9IDA7CgkJdGFi
bGUtPnJlcGxhY2UuZW50cmllcyA9IDA7CgkJZm9yIChoID0gMDsgaCA8IE5GX0JSX05VTUhPT0tT
OyBoKyspCgkJCXRhYmxlLT5yZXBsYWNlLmhvb2tfZW50cnlbaF0gPSAwOwoJCWlmIChtZW1jbXAo
JnRhYmxlLT5yZXBsYWNlLCAmcmVwbGFjZSwgc2l6ZW9mKHRhYmxlLT5yZXBsYWNlKSkgPT0gMCkg
ewoJCQltZW1zZXQoJmVudHJ5dGFibGUsIDAsIHNpemVvZihlbnRyeXRhYmxlKSk7CgkJCXJlcGxh
Y2UuZW50cmllcyA9IGVudHJ5dGFibGU7CgkJCW9wdGxlbiA9IHNpemVvZihyZXBsYWNlKSArIHJl
cGxhY2UuZW50cmllc19zaXplOwoJCQlpZiAoZ2V0c29ja29wdChmZCwgU09MX0lQLCBFQlRfU09f
R0VUX0VOVFJJRVMsICZyZXBsYWNlLCAmb3B0bGVuKSkKCWV4aXQoMSk7CgkJCWlmIChtZW1jbXAo
dGFibGUtPmVudHJ5dGFibGUsIGVudHJ5dGFibGUsIHJlcGxhY2UuZW50cmllc19zaXplKSA9PSAw
KQoJCQkJY29udGludWU7CgkJfQoJCWZvciAoaiA9IDAsIGggPSAwOyBoIDwgTkZfQlJfTlVNSE9P
S1M7IGgrKykgewoJCQlpZiAodGFibGUtPnJlcGxhY2UudmFsaWRfaG9va3MgJiAoMSA8PCBoKSkg
ewoJCQkJdGFibGUtPnJlcGxhY2UuaG9va19lbnRyeVtoXSA9IChzdHJ1Y3QgZWJ0X2VudHJpZXMq
KXRhYmxlLT5lbnRyeXRhYmxlICsgajsKCQkJCWorKzsKCQkJfQoJCX0KCQl0YWJsZS0+cmVwbGFj
ZS5lbnRyaWVzID0gdGFibGUtPmVudHJ5dGFibGU7CgkJb3B0bGVuID0gc2l6ZW9mKHRhYmxlLT5y
ZXBsYWNlKSArIHRhYmxlLT5yZXBsYWNlLmVudHJpZXNfc2l6ZTsKCQlpZiAoc2V0c29ja29wdChm
ZCwgU09MX0lQLCBFQlRfU09fU0VUX0VOVFJJRVMsICZ0YWJsZS0+cmVwbGFjZSwgb3B0bGVuKSkK
CWV4aXQoMSk7Cgl9CgljbG9zZShmZCk7Cn0KCnN0YXRpYyB2b2lkIGNoZWNrcG9pbnRfbmV0X25h
bWVzcGFjZSh2b2lkKQp7CgljaGVja3BvaW50X2VidGFibGVzKCk7CgljaGVja3BvaW50X2FycHRh
YmxlcygpOwoJY2hlY2twb2ludF9pcHRhYmxlcyhpcHY0X3RhYmxlcywgc2l6ZW9mKGlwdjRfdGFi
bGVzKSAvIHNpemVvZihpcHY0X3RhYmxlc1swXSksIEFGX0lORVQsIFNPTF9JUCk7CgljaGVja3Bv
aW50X2lwdGFibGVzKGlwdjZfdGFibGVzLCBzaXplb2YoaXB2Nl90YWJsZXMpIC8gc2l6ZW9mKGlw
djZfdGFibGVzWzBdKSwgQUZfSU5FVDYsIFNPTF9JUFY2KTsKfQoKc3RhdGljIHZvaWQgcmVzZXRf
bmV0X25hbWVzcGFjZSh2b2lkKQp7CglyZXNldF9lYnRhYmxlcygpOwoJcmVzZXRfYXJwdGFibGVz
KCk7CglyZXNldF9pcHRhYmxlcyhpcHY0X3RhYmxlcywgc2l6ZW9mKGlwdjRfdGFibGVzKSAvIHNp
emVvZihpcHY0X3RhYmxlc1swXSksIEFGX0lORVQsIFNPTF9JUCk7CglyZXNldF9pcHRhYmxlcyhp
cHY2X3RhYmxlcywgc2l6ZW9mKGlwdjZfdGFibGVzKSAvIHNpemVvZihpcHY2X3RhYmxlc1swXSks
IEFGX0lORVQ2LCBTT0xfSVBWNik7Cn0KCnN0YXRpYyB2b2lkIHNldHVwX2Nncm91cHMoKQp7Cglp
ZiAobWtkaXIoIi9zeXpjZ3JvdXAiLCAwNzc3KSkgewoJfQoJaWYgKG1rZGlyKCIvc3l6Y2dyb3Vw
L3VuaWZpZWQiLCAwNzc3KSkgewoJfQoJaWYgKG1vdW50KCJub25lIiwgIi9zeXpjZ3JvdXAvdW5p
ZmllZCIsICJjZ3JvdXAyIiwgMCwgTlVMTCkpIHsKCX0KCWlmIChjaG1vZCgiL3N5emNncm91cC91
bmlmaWVkIiwgMDc3NykpIHsKCX0KCXdyaXRlX2ZpbGUoIi9zeXpjZ3JvdXAvdW5pZmllZC9jZ3Jv
dXAuc3VidHJlZV9jb250cm9sIiwgIitjcHUgK21lbW9yeSAraW8gK3BpZHMgK3JkbWEiKTsKCWlm
IChta2RpcigiL3N5emNncm91cC9jcHUiLCAwNzc3KSkgewoJfQoJaWYgKG1vdW50KCJub25lIiwg
Ii9zeXpjZ3JvdXAvY3B1IiwgImNncm91cCIsIDAsICJjcHVzZXQsY3B1YWNjdCxwZXJmX2V2ZW50
LGh1Z2V0bGIiKSkgewoJfQoJd3JpdGVfZmlsZSgiL3N5emNncm91cC9jcHUvY2dyb3VwLmNsb25l
X2NoaWxkcmVuIiwgIjEiKTsKCWlmIChjaG1vZCgiL3N5emNncm91cC9jcHUiLCAwNzc3KSkgewoJ
fQoJaWYgKG1rZGlyKCIvc3l6Y2dyb3VwL25ldCIsIDA3NzcpKSB7Cgl9CglpZiAobW91bnQoIm5v
bmUiLCAiL3N5emNncm91cC9uZXQiLCAiY2dyb3VwIiwgMCwgIm5ldF9jbHMsbmV0X3ByaW8sZGV2
aWNlcyxmcmVlemVyIikpIHsKCX0KCWlmIChjaG1vZCgiL3N5emNncm91cC9uZXQiLCAwNzc3KSkg
ewoJfQp9CgpzdGF0aWMgdm9pZCBzZXR1cF9jZ3JvdXBzX2xvb3AoKQp7CglpbnQgcGlkID0gZ2V0
cGlkKCk7CgljaGFyIGZpbGVbMTI4XTsKCWNoYXIgY2dyb3VwZGlyWzY0XTsKCXNucHJpbnRmKGNn
cm91cGRpciwgc2l6ZW9mKGNncm91cGRpciksICIvc3l6Y2dyb3VwL3VuaWZpZWQvc3l6JWxsdSIs
IHByb2NpZCk7CglpZiAobWtkaXIoY2dyb3VwZGlyLCAwNzc3KSkgewoJfQoJc25wcmludGYoZmls
ZSwgc2l6ZW9mKGZpbGUpLCAiJXMvcGlkcy5tYXgiLCBjZ3JvdXBkaXIpOwoJd3JpdGVfZmlsZShm
aWxlLCAiMzIiKTsKCXNucHJpbnRmKGZpbGUsIHNpemVvZihmaWxlKSwgIiVzL21lbW9yeS5sb3ci
LCBjZ3JvdXBkaXIpOwoJd3JpdGVfZmlsZShmaWxlLCAiJWQiLCAyOTggPDwgMjApOwoJc25wcmlu
dGYoZmlsZSwgc2l6ZW9mKGZpbGUpLCAiJXMvbWVtb3J5LmhpZ2giLCBjZ3JvdXBkaXIpOwoJd3Jp
dGVfZmlsZShmaWxlLCAiJWQiLCAyOTkgPDwgMjApOwoJc25wcmludGYoZmlsZSwgc2l6ZW9mKGZp
bGUpLCAiJXMvbWVtb3J5Lm1heCIsIGNncm91cGRpcik7Cgl3cml0ZV9maWxlKGZpbGUsICIlZCIs
IDMwMCA8PCAyMCk7CglzbnByaW50ZihmaWxlLCBzaXplb2YoZmlsZSksICIlcy9jZ3JvdXAucHJv
Y3MiLCBjZ3JvdXBkaXIpOwoJd3JpdGVfZmlsZShmaWxlLCAiJWQiLCBwaWQpOwoJc25wcmludGYo
Y2dyb3VwZGlyLCBzaXplb2YoY2dyb3VwZGlyKSwgIi9zeXpjZ3JvdXAvY3B1L3N5eiVsbHUiLCBw
cm9jaWQpOwoJaWYgKG1rZGlyKGNncm91cGRpciwgMDc3NykpIHsKCX0KCXNucHJpbnRmKGZpbGUs
IHNpemVvZihmaWxlKSwgIiVzL2Nncm91cC5wcm9jcyIsIGNncm91cGRpcik7Cgl3cml0ZV9maWxl
KGZpbGUsICIlZCIsIHBpZCk7CglzbnByaW50ZihjZ3JvdXBkaXIsIHNpemVvZihjZ3JvdXBkaXIp
LCAiL3N5emNncm91cC9uZXQvc3l6JWxsdSIsIHByb2NpZCk7CglpZiAobWtkaXIoY2dyb3VwZGly
LCAwNzc3KSkgewoJfQoJc25wcmludGYoZmlsZSwgc2l6ZW9mKGZpbGUpLCAiJXMvY2dyb3VwLnBy
b2NzIiwgY2dyb3VwZGlyKTsKCXdyaXRlX2ZpbGUoZmlsZSwgIiVkIiwgcGlkKTsKfQoKc3RhdGlj
IHZvaWQgc2V0dXBfY2dyb3Vwc190ZXN0KCkKewoJY2hhciBjZ3JvdXBkaXJbNjRdOwoJc25wcmlu
dGYoY2dyb3VwZGlyLCBzaXplb2YoY2dyb3VwZGlyKSwgIi9zeXpjZ3JvdXAvdW5pZmllZC9zeXol
bGx1IiwgcHJvY2lkKTsKCWlmIChzeW1saW5rKGNncm91cGRpciwgIi4vY2dyb3VwIikpIHsKCX0K
CXNucHJpbnRmKGNncm91cGRpciwgc2l6ZW9mKGNncm91cGRpciksICIvc3l6Y2dyb3VwL2NwdS9z
eXolbGx1IiwgcHJvY2lkKTsKCWlmIChzeW1saW5rKGNncm91cGRpciwgIi4vY2dyb3VwLmNwdSIp
KSB7Cgl9CglzbnByaW50ZihjZ3JvdXBkaXIsIHNpemVvZihjZ3JvdXBkaXIpLCAiL3N5emNncm91
cC9uZXQvc3l6JWxsdSIsIHByb2NpZCk7CglpZiAoc3ltbGluayhjZ3JvdXBkaXIsICIuL2Nncm91
cC5uZXQiKSkgewoJfQp9CgpzdGF0aWMgdm9pZCBzZXR1cF9jb21tb24oKQp7CglpZiAobW91bnQo
MCwgIi9zeXMvZnMvZnVzZS9jb25uZWN0aW9ucyIsICJmdXNlY3RsIiwgMCwgMCkpIHsKCX0KCXNl
dHVwX2Nncm91cHMoKTsKfQoKc3RhdGljIHZvaWQgbG9vcCgpOwoKc3RhdGljIHZvaWQgc2FuZGJv
eF9jb21tb24oKQp7CglwcmN0bChQUl9TRVRfUERFQVRIU0lHLCBTSUdLSUxMLCAwLCAwLCAwKTsK
CXNldHBncnAoKTsKCXNldHNpZCgpOwoJaW50IG5ldG5zID0gb3BlbigiL3Byb2Mvc2VsZi9ucy9u
ZXQiLCBPX1JET05MWSk7CglpZiAobmV0bnMgPT0gLTEpCglleGl0KDEpOwoJaWYgKGR1cDIobmV0
bnMsIGtJbml0TmV0TnNGZCkgPCAwKQoJZXhpdCgxKTsKCWNsb3NlKG5ldG5zKTsKCXN0cnVjdCBy
bGltaXQgcmxpbTsKCXJsaW0ucmxpbV9jdXIgPSBybGltLnJsaW1fbWF4ID0gKDIwMCA8PCAyMCk7
CglzZXRybGltaXQoUkxJTUlUX0FTLCAmcmxpbSk7CglybGltLnJsaW1fY3VyID0gcmxpbS5ybGlt
X21heCA9IDMyIDw8IDIwOwoJc2V0cmxpbWl0KFJMSU1JVF9NRU1MT0NLLCAmcmxpbSk7CglybGlt
LnJsaW1fY3VyID0gcmxpbS5ybGltX21heCA9IDEzNiA8PCAyMDsKCXNldHJsaW1pdChSTElNSVRf
RlNJWkUsICZybGltKTsKCXJsaW0ucmxpbV9jdXIgPSBybGltLnJsaW1fbWF4ID0gMSA8PCAyMDsK
CXNldHJsaW1pdChSTElNSVRfU1RBQ0ssICZybGltKTsKCXJsaW0ucmxpbV9jdXIgPSBybGltLnJs
aW1fbWF4ID0gMDsKCXNldHJsaW1pdChSTElNSVRfQ09SRSwgJnJsaW0pOwoJcmxpbS5ybGltX2N1
ciA9IHJsaW0ucmxpbV9tYXggPSAyNTY7CglzZXRybGltaXQoUkxJTUlUX05PRklMRSwgJnJsaW0p
OwoJaWYgKHVuc2hhcmUoQ0xPTkVfTkVXTlMpKSB7Cgl9CglpZiAodW5zaGFyZShDTE9ORV9ORVdJ
UEMpKSB7Cgl9CglpZiAodW5zaGFyZSgweDAyMDAwMDAwKSkgewoJfQoJaWYgKHVuc2hhcmUoQ0xP
TkVfTkVXVVRTKSkgewoJfQoJaWYgKHVuc2hhcmUoQ0xPTkVfU1lTVlNFTSkpIHsKCX0KCXR5cGVk
ZWYgc3RydWN0IHsKCQljb25zdCBjaGFyKiBuYW1lOwoJCWNvbnN0IGNoYXIqIHZhbHVlOwoJfSBz
eXNjdGxfdDsKCXN0YXRpYyBjb25zdCBzeXNjdGxfdCBzeXNjdGxzW10gPSB7CgkgICAgeyIvcHJv
Yy9zeXMva2VybmVsL3NobW1heCIsICIxNjc3NzIxNiJ9LAoJICAgIHsiL3Byb2Mvc3lzL2tlcm5l
bC9zaG1hbGwiLCAiNTM2ODcwOTEyIn0sCgkgICAgeyIvcHJvYy9zeXMva2VybmVsL3NobW1uaSIs
ICIxMDI0In0sCgkgICAgeyIvcHJvYy9zeXMva2VybmVsL21zZ21heCIsICI4MTkyIn0sCgkgICAg
eyIvcHJvYy9zeXMva2VybmVsL21zZ21uaSIsICIxMDI0In0sCgkgICAgeyIvcHJvYy9zeXMva2Vy
bmVsL21zZ21uYiIsICIxMDI0In0sCgkgICAgeyIvcHJvYy9zeXMva2VybmVsL3NlbSIsICIxMDI0
IDEwNDg1NzYgNTAwIDEwMjQifSwKCX07Cgl1bnNpZ25lZCBpOwoJZm9yIChpID0gMDsgaSA8IHNp
emVvZihzeXNjdGxzKSAvIHNpemVvZihzeXNjdGxzWzBdKTsgaSsrKQoJCXdyaXRlX2ZpbGUoc3lz
Y3Rsc1tpXS5uYW1lLCBzeXNjdGxzW2ldLnZhbHVlKTsKfQoKaW50IHdhaXRfZm9yX2xvb3AoaW50
IHBpZCkKewoJaWYgKHBpZCA8IDApCglleGl0KDEpOwoJaW50IHN0YXR1cyA9IDA7Cgl3aGlsZSAo
d2FpdHBpZCgtMSwgJnN0YXR1cywgX19XQUxMKSAhPSBwaWQpIHsKCX0KCXJldHVybiBXRVhJVFNU
QVRVUyhzdGF0dXMpOwp9CgpzdGF0aWMgdm9pZCBkcm9wX2NhcHModm9pZCkKewoJc3RydWN0IF9f
dXNlcl9jYXBfaGVhZGVyX3N0cnVjdCBjYXBfaGRyID0ge307CglzdHJ1Y3QgX191c2VyX2NhcF9k
YXRhX3N0cnVjdCBjYXBfZGF0YVsyXSA9IHt9OwoJY2FwX2hkci52ZXJzaW9uID0gX0xJTlVYX0NB
UEFCSUxJVFlfVkVSU0lPTl8zOwoJY2FwX2hkci5waWQgPSBnZXRwaWQoKTsKCWlmIChzeXNjYWxs
KFNZU19jYXBnZXQsICZjYXBfaGRyLCAmY2FwX2RhdGEpKQoJZXhpdCgxKTsKCWNvbnN0IGludCBk
cm9wID0gKDEgPDwgQ0FQX1NZU19QVFJBQ0UpIHwgKDEgPDwgQ0FQX1NZU19OSUNFKTsKCWNhcF9k
YXRhWzBdLmVmZmVjdGl2ZSAmPSB+ZHJvcDsKCWNhcF9kYXRhWzBdLnBlcm1pdHRlZCAmPSB+ZHJv
cDsKCWNhcF9kYXRhWzBdLmluaGVyaXRhYmxlICY9IH5kcm9wOwoJaWYgKHN5c2NhbGwoU1lTX2Nh
cHNldCwgJmNhcF9oZHIsICZjYXBfZGF0YSkpCglleGl0KDEpOwp9CgpzdGF0aWMgaW50IGRvX3Nh
bmRib3hfbm9uZSh2b2lkKQp7CglpZiAodW5zaGFyZShDTE9ORV9ORVdQSUQpKSB7Cgl9CglpbnQg
cGlkID0gZm9yaygpOwoJaWYgKHBpZCAhPSAwKQoJCXJldHVybiB3YWl0X2Zvcl9sb29wKHBpZCk7
CglzZXR1cF9jb21tb24oKTsKCXNhbmRib3hfY29tbW9uKCk7Cglkcm9wX2NhcHMoKTsKCWluaXRp
YWxpemVfbmV0ZGV2aWNlc19pbml0KCk7CglpZiAodW5zaGFyZShDTE9ORV9ORVdORVQpKSB7Cgl9
Cglpbml0aWFsaXplX2RldmxpbmtfcGNpKCk7Cglpbml0aWFsaXplX3R1bigpOwoJaW5pdGlhbGl6
ZV9uZXRkZXZpY2VzKCk7Cglsb29wKCk7CglleGl0KDEpOwp9CgojZGVmaW5lIEZTX0lPQ19TRVRG
TEFHUyBfSU9XKCdmJywgMiwgbG9uZykKc3RhdGljIHZvaWQgcmVtb3ZlX2Rpcihjb25zdCBjaGFy
KiBkaXIpCnsKCURJUiogZHA7CglzdHJ1Y3QgZGlyZW50KiBlcDsKCWludCBpdGVyID0gMDsKcmV0
cnk6Cgl3aGlsZSAodW1vdW50MihkaXIsIE1OVF9ERVRBQ0gpID09IDApIHsKCX0KCWRwID0gb3Bl
bmRpcihkaXIpOwoJaWYgKGRwID09IE5VTEwpIHsKCQlpZiAoZXJybm8gPT0gRU1GSUxFKSB7Cgll
eGl0KDEpOwoJCX0KCWV4aXQoMSk7Cgl9Cgl3aGlsZSAoKGVwID0gcmVhZGRpcihkcCkpKSB7CgkJ
aWYgKHN0cmNtcChlcC0+ZF9uYW1lLCAiLiIpID09IDAgfHwgc3RyY21wKGVwLT5kX25hbWUsICIu
LiIpID09IDApCgkJCWNvbnRpbnVlOwoJCWNoYXIgZmlsZW5hbWVbRklMRU5BTUVfTUFYXTsKCQlz
bnByaW50ZihmaWxlbmFtZSwgc2l6ZW9mKGZpbGVuYW1lKSwgIiVzLyVzIiwgZGlyLCBlcC0+ZF9u
YW1lKTsKCQl3aGlsZSAodW1vdW50MihmaWxlbmFtZSwgTU5UX0RFVEFDSCkgPT0gMCkgewoJCX0K
CQlzdHJ1Y3Qgc3RhdCBzdDsKCQlpZiAobHN0YXQoZmlsZW5hbWUsICZzdCkpCglleGl0KDEpOwoJ
CWlmIChTX0lTRElSKHN0LnN0X21vZGUpKSB7CgkJCXJlbW92ZV9kaXIoZmlsZW5hbWUpOwoJCQlj
b250aW51ZTsKCQl9CgkJaW50IGk7CgkJZm9yIChpID0gMDs7IGkrKykgewoJCQlpZiAodW5saW5r
KGZpbGVuYW1lKSA9PSAwKQoJCQkJYnJlYWs7CgkJCWlmIChlcnJubyA9PSBFUEVSTSkgewoJCQkJ
aW50IGZkID0gb3BlbihmaWxlbmFtZSwgT19SRE9OTFkpOwoJCQkJaWYgKGZkICE9IC0xKSB7CgkJ
CQkJbG9uZyBmbGFncyA9IDA7CgkJCQkJaWYgKGlvY3RsKGZkLCBGU19JT0NfU0VURkxBR1MsICZm
bGFncykgPT0gMCkKCQkJCQljbG9zZShmZCk7CgkJCQkJY29udGludWU7CgkJCQl9CgkJCX0KCQkJ
aWYgKGVycm5vID09IEVST0ZTKSB7CgkJCQlicmVhazsKCQkJfQoJCQlpZiAoZXJybm8gIT0gRUJV
U1kgfHwgaSA+IDEwMCkKCWV4aXQoMSk7CgkJCWlmICh1bW91bnQyKGZpbGVuYW1lLCBNTlRfREVU
QUNIKSkKCWV4aXQoMSk7CgkJfQoJfQoJY2xvc2VkaXIoZHApOwoJaW50IGk7Cglmb3IgKGkgPSAw
OzsgaSsrKSB7CgkJaWYgKHJtZGlyKGRpcikgPT0gMCkKCQkJYnJlYWs7CgkJaWYgKGkgPCAxMDAp
IHsKCQkJaWYgKGVycm5vID09IEVQRVJNKSB7CgkJCQlpbnQgZmQgPSBvcGVuKGRpciwgT19SRE9O
TFkpOwoJCQkJaWYgKGZkICE9IC0xKSB7CgkJCQkJbG9uZyBmbGFncyA9IDA7CgkJCQkJaWYgKGlv
Y3RsKGZkLCBGU19JT0NfU0VURkxBR1MsICZmbGFncykgPT0gMCkKCQkJCQljbG9zZShmZCk7CgkJ
CQkJY29udGludWU7CgkJCQl9CgkJCX0KCQkJaWYgKGVycm5vID09IEVST0ZTKSB7CgkJCQlicmVh
azsKCQkJfQoJCQlpZiAoZXJybm8gPT0gRUJVU1kpIHsKCQkJCWlmICh1bW91bnQyKGRpciwgTU5U
X0RFVEFDSCkpCglleGl0KDEpOwoJCQkJY29udGludWU7CgkJCX0KCQkJaWYgKGVycm5vID09IEVO
T1RFTVBUWSkgewoJCQkJaWYgKGl0ZXIgPCAxMDApIHsKCQkJCQlpdGVyKys7CgkJCQkJZ290byBy
ZXRyeTsKCQkJCX0KCQkJfQoJCX0KCWV4aXQoMSk7Cgl9Cn0KCnN0YXRpYyB2b2lkIGtpbGxfYW5k
X3dhaXQoaW50IHBpZCwgaW50KiBzdGF0dXMpCnsKCWtpbGwoLXBpZCwgU0lHS0lMTCk7CglraWxs
KHBpZCwgU0lHS0lMTCk7CglpbnQgaTsKCWZvciAoaSA9IDA7IGkgPCAxMDA7IGkrKykgewoJCWlm
ICh3YWl0cGlkKC0xLCBzdGF0dXMsIFdOT0hBTkcgfCBfX1dBTEwpID09IHBpZCkKCQkJcmV0dXJu
OwoJCXVzbGVlcCgxMDAwKTsKCX0KCURJUiogZGlyID0gb3BlbmRpcigiL3N5cy9mcy9mdXNlL2Nv
bm5lY3Rpb25zIik7CglpZiAoZGlyKSB7CgkJZm9yICg7OykgewoJCQlzdHJ1Y3QgZGlyZW50KiBl
bnQgPSByZWFkZGlyKGRpcik7CgkJCWlmICghZW50KQoJCQkJYnJlYWs7CgkJCWlmIChzdHJjbXAo
ZW50LT5kX25hbWUsICIuIikgPT0gMCB8fCBzdHJjbXAoZW50LT5kX25hbWUsICIuLiIpID09IDAp
CgkJCQljb250aW51ZTsKCQkJY2hhciBhYm9ydFszMDBdOwoJCQlzbnByaW50ZihhYm9ydCwgc2l6
ZW9mKGFib3J0KSwgIi9zeXMvZnMvZnVzZS9jb25uZWN0aW9ucy8lcy9hYm9ydCIsIGVudC0+ZF9u
YW1lKTsKCQkJaW50IGZkID0gb3BlbihhYm9ydCwgT19XUk9OTFkpOwoJCQlpZiAoZmQgPT0gLTEp
IHsKCQkJCWNvbnRpbnVlOwoJCQl9CgkJCWlmICh3cml0ZShmZCwgYWJvcnQsIDEpIDwgMCkgewoJ
CQl9CgkJCWNsb3NlKGZkKTsKCQl9CgkJY2xvc2VkaXIoZGlyKTsKCX0gZWxzZSB7Cgl9Cgl3aGls
ZSAod2FpdHBpZCgtMSwgc3RhdHVzLCBfX1dBTEwpICE9IHBpZCkgewoJfQp9CgpzdGF0aWMgdm9p
ZCBzZXR1cF9sb29wKCkKewoJc2V0dXBfY2dyb3Vwc19sb29wKCk7CgljaGVja3BvaW50X25ldF9u
YW1lc3BhY2UoKTsKfQoKc3RhdGljIHZvaWQgcmVzZXRfbG9vcCgpCnsKCXJlc2V0X25ldF9uYW1l
c3BhY2UoKTsKfQoKc3RhdGljIHZvaWQgc2V0dXBfdGVzdCgpCnsKCXByY3RsKFBSX1NFVF9QREVB
VEhTSUcsIFNJR0tJTEwsIDAsIDAsIDApOwoJc2V0cGdycCgpOwoJc2V0dXBfY2dyb3Vwc190ZXN0
KCk7Cgl3cml0ZV9maWxlKCIvcHJvYy9zZWxmL29vbV9zY29yZV9hZGoiLCAiMTAwMCIpOwoJZmx1
c2hfdHVuKCk7Cn0KCnN0YXRpYyB2b2lkIGNsb3NlX2ZkcygpCnsKCWludCBmZDsKCWZvciAoZmQg
PSAzOyBmZCA8IE1BWF9GRFM7IGZkKyspCgkJY2xvc2UoZmQpOwp9CgpzdGF0aWMgdm9pZCBzZXR1
cF9iaW5mbXRfbWlzYygpCnsKCWlmIChtb3VudCgwLCAiL3Byb2Mvc3lzL2ZzL2JpbmZtdF9taXNj
IiwgImJpbmZtdF9taXNjIiwgMCwgMCkpIHsKCX0KCXdyaXRlX2ZpbGUoIi9wcm9jL3N5cy9mcy9i
aW5mbXRfbWlzYy9yZWdpc3RlciIsICI6c3l6MDpNOjA6XHgwMTo6Li9maWxlMDoiKTsKCXdyaXRl
X2ZpbGUoIi9wcm9jL3N5cy9mcy9iaW5mbXRfbWlzYy9yZWdpc3RlciIsICI6c3l6MTpNOjE6XHgw
Mjo6Li9maWxlMDpQT0MiKTsKfQoKc3RydWN0IHRocmVhZF90IHsKCWludCBjcmVhdGVkLCBjYWxs
OwoJZXZlbnRfdCByZWFkeSwgZG9uZTsKfTsKCnN0YXRpYyBzdHJ1Y3QgdGhyZWFkX3QgdGhyZWFk
c1sxNl07CnN0YXRpYyB2b2lkIGV4ZWN1dGVfY2FsbChpbnQgY2FsbCk7CnN0YXRpYyBpbnQgcnVu
bmluZzsKCnN0YXRpYyB2b2lkKiB0aHIodm9pZCogYXJnKQp7CglzdHJ1Y3QgdGhyZWFkX3QqIHRo
ID0gKHN0cnVjdCB0aHJlYWRfdCopYXJnOwoJZm9yICg7OykgewoJCWV2ZW50X3dhaXQoJnRoLT5y
ZWFkeSk7CgkJZXZlbnRfcmVzZXQoJnRoLT5yZWFkeSk7CgkJZXhlY3V0ZV9jYWxsKHRoLT5jYWxs
KTsKCQlfX2F0b21pY19mZXRjaF9zdWIoJnJ1bm5pbmcsIDEsIF9fQVRPTUlDX1JFTEFYRUQpOwoJ
CWV2ZW50X3NldCgmdGgtPmRvbmUpOwoJfQoJcmV0dXJuIDA7Cn0KCnN0YXRpYyB2b2lkIGV4ZWN1
dGVfb25lKHZvaWQpCnsKCWlmICh3cml0ZSgxLCAiZXhlY3V0aW5nIHByb2dyYW1cbiIsIHNpemVv
ZigiZXhlY3V0aW5nIHByb2dyYW1cbiIpIC0gMSkpIHsKCX0KCWludCBpLCBjYWxsLCB0aHJlYWQ7
CglpbnQgY29sbGlkZSA9IDA7CmFnYWluOgoJZm9yIChjYWxsID0gMDsgY2FsbCA8IDM7IGNhbGwr
KykgewoJCWZvciAodGhyZWFkID0gMDsgdGhyZWFkIDwgKGludCkoc2l6ZW9mKHRocmVhZHMpIC8g
c2l6ZW9mKHRocmVhZHNbMF0pKTsgdGhyZWFkKyspIHsKCQkJc3RydWN0IHRocmVhZF90KiB0aCA9
ICZ0aHJlYWRzW3RocmVhZF07CgkJCWlmICghdGgtPmNyZWF0ZWQpIHsKCQkJCXRoLT5jcmVhdGVk
ID0gMTsKCQkJCWV2ZW50X2luaXQoJnRoLT5yZWFkeSk7CgkJCQlldmVudF9pbml0KCZ0aC0+ZG9u
ZSk7CgkJCQlldmVudF9zZXQoJnRoLT5kb25lKTsKCQkJCXRocmVhZF9zdGFydCh0aHIsIHRoKTsK
CQkJfQoJCQlpZiAoIWV2ZW50X2lzc2V0KCZ0aC0+ZG9uZSkpCgkJCQljb250aW51ZTsKCQkJZXZl
bnRfcmVzZXQoJnRoLT5kb25lKTsKCQkJdGgtPmNhbGwgPSBjYWxsOwoJCQlfX2F0b21pY19mZXRj
aF9hZGQoJnJ1bm5pbmcsIDEsIF9fQVRPTUlDX1JFTEFYRUQpOwoJCQlldmVudF9zZXQoJnRoLT5y
ZWFkeSk7CgkJCWlmIChjb2xsaWRlICYmIChjYWxsICUgMikgPT0gMCkKCQkJCWJyZWFrOwoJCQll
dmVudF90aW1lZHdhaXQoJnRoLT5kb25lLCA0NSk7CgkJCWJyZWFrOwoJCX0KCX0KCWZvciAoaSA9
IDA7IGkgPCAxMDAgJiYgX19hdG9taWNfbG9hZF9uKCZydW5uaW5nLCBfX0FUT01JQ19SRUxBWEVE
KTsgaSsrKQoJCXNsZWVwX21zKDEpOwoJY2xvc2VfZmRzKCk7CglpZiAoIWNvbGxpZGUpIHsKCQlj
b2xsaWRlID0gMTsKCQlnb3RvIGFnYWluOwoJfQp9CgpzdGF0aWMgdm9pZCBleGVjdXRlX29uZSh2
b2lkKTsKCiNkZWZpbmUgV0FJVF9GTEFHUyBfX1dBTEwKCnN0YXRpYyB2b2lkIGxvb3Aodm9pZCkK
ewoJc2V0dXBfbG9vcCgpOwoJaW50IGl0ZXI7Cglmb3IgKGl0ZXIgPSAwOzsgaXRlcisrKSB7CgkJ
Y2hhciBjd2RidWZbMzJdOwoJCXNwcmludGYoY3dkYnVmLCAiLi8lZCIsIGl0ZXIpOwoJCWlmICht
a2Rpcihjd2RidWYsIDA3NzcpKQoJZXhpdCgxKTsKCQlyZXNldF9sb29wKCk7CgkJaW50IHBpZCA9
IGZvcmsoKTsKCQlpZiAocGlkIDwgMCkKCWV4aXQoMSk7CgkJaWYgKHBpZCA9PSAwKSB7CgkJCWlm
IChjaGRpcihjd2RidWYpKQoJZXhpdCgxKTsKCQkJc2V0dXBfdGVzdCgpOwoJCQlleGVjdXRlX29u
ZSgpOwoJCQlleGl0KDApOwoJCX0KCQlpbnQgc3RhdHVzID0gMDsKCQl1aW50NjRfdCBzdGFydCA9
IGN1cnJlbnRfdGltZV9tcygpOwoJCWZvciAoOzspIHsKCQkJaWYgKHdhaXRwaWQoLTEsICZzdGF0
dXMsIFdOT0hBTkcgfCBXQUlUX0ZMQUdTKSA9PSBwaWQpCgkJCQlicmVhazsKCQkJc2xlZXBfbXMo
MSk7CgkJCWlmIChjdXJyZW50X3RpbWVfbXMoKSAtIHN0YXJ0IDwgNSAqIDEwMDApCgkJCQljb250
aW51ZTsKCQkJa2lsbF9hbmRfd2FpdChwaWQsICZzdGF0dXMpOwoJCQlicmVhazsKCQl9CgkJcmVt
b3ZlX2Rpcihjd2RidWYpOwoJfQp9Cgp1aW50NjRfdCByWzFdID0gezB4ZmZmZmZmZmZmZmZmZmZm
Zn07Cgp1bnNpZ25lZCBjaGFyIHJlcG9ydF9kZXNjW10gPSB7CiAgICAweDA1LCAweDAxLCAvKiBV
U0FHRV9QQUdFIChHZW5lcmljIERlc2t0b3ApCSAgICAgICAgICAqLwogICAgMHgwOSwgMHgwNiwg
LyogVVNBR0UgKEtleWJvYXJkKSAgICAgICAgICAgICAgICAgICAgICAgKi8KICAgIDB4YTEsIDB4
MDEsIC8qIENPTExFQ1RJT04gKEFwcGxpY2F0aW9uKSAgICAgICAgICAgICAgICovCiAgICAweDA1
LCAweDA3LCAvKiAgIFVTQUdFX1BBR0UgKEtleWJvYXJkKSAgICAgICAgICAgICAgICAqLwogICAg
MHgxOSwgMHhlMCwgLyogICBVU0FHRV9NSU5JTVVNIChLZXlib2FyZCBMZWZ0Q29udHJvbCkgKi8K
ICAgIDB4MjksIDB4ZTcsIC8qICAgVVNBR0VfTUFYSU1VTSAoS2V5Ym9hcmQgUmlnaHQgR1VJKSAg
ICovCiAgICAweDE1LCAweDAwLCAvKiAgIExPR0lDQUxfTUlOSU1VTSAoMCkgICAgICAgICAgICAg
ICAgICAqLwogICAgMHgyNSwgMHgwMSwgLyogICBMT0dJQ0FMX01BWElNVU0gKDEpICAgICAgICAg
ICAgICAgICAgKi8KICAgIDB4NzUsIDB4MDEsIC8qICAgUkVQT1JUX1NJWkUgKDEpICAgICAgICAg
ICAgICAgICAgICAgICovCiAgICAweDk1LCAweDA4LCAvKiAgIFJFUE9SVF9DT1VOVCAoOCkgICAg
ICAgICAgICAgICAgICAgICAqLwogICAgMHg4MSwgMHgwMiwgLyogICBJTlBVVCAoRGF0YSxWYXIs
QWJzKSAgICAgICAgICAgICAgICAgKi8KICAgIDB4OTUsIDB4MDEsIC8qICAgUkVQT1JUX0NPVU5U
ICgxKSAgICAgICAgICAgICAgICAgICAgICovCiAgICAweDc1LCAweDA4LCAvKiAgIFJFUE9SVF9T
SVpFICg4KSAgICAgICAgICAgICAgICAgICAgICAqLwogICAgMHg4MSwgMHgwMywgLyogICBJTlBV
VCAoQ25zdCxWYXIsQWJzKSAgICAgICAgICAgICAgICAgKi8KICAgIDB4OTUsIDB4MDUsIC8qICAg
UkVQT1JUX0NPVU5UICg1KSAgICAgICAgICAgICAgICAgICAgICovCiAgICAweDc1LCAweDAxLCAv
KiAgIFJFUE9SVF9TSVpFICgxKSAgICAgICAgICAgICAgICAgICAgICAqLwogICAgMHgwNSwgMHgw
OCwgLyogICBVU0FHRV9QQUdFIChMRURzKSAgICAgICAgICAgICAgICAgICAgKi8KICAgIDB4MTks
IDB4MDEsIC8qICAgVVNBR0VfTUlOSU1VTSAoTnVtIExvY2spICAgICAgICAgICAgICovCiAgICAw
eDI5LCAweDA1LCAvKiAgIFVTQUdFX01BWElNVU0gKEthbmEpICAgICAgICAgICAgICAgICAqLwog
ICAgMHg5MSwgMHgwMiwgLyogICBPVVRQVVQgKERhdGEsVmFyLEFicykgICAgICAgICAgICAgICAg
Ki8KICAgIDB4OTUsIDB4MDEsIC8qICAgUkVQT1JUX0NPVU5UICgxKSAgICAgICAgICAgICAgICAg
ICAgICovCiAgICAweDc1LCAweDAzLCAvKiAgIFJFUE9SVF9TSVpFICgzKSAgICAgICAgICAgICAg
ICAgICAgICAqLwogICAgMHg5MSwgMHgwMywgLyogICBPVVRQVVQgKENuc3QsVmFyLEFicykgICAg
ICAgICAgICAgICAgKi8KICAgIDB4OTUsIDB4MDYsIC8qICAgUkVQT1JUX0NPVU5UICg2KSAgICAg
ICAgICAgICAgICAgICAgICovCiAgICAweDc1LCAweDA4LCAvKiAgIFJFUE9SVF9TSVpFICg4KSAg
ICAgICAgICAgICAgICAgICAgICAqLwogICAgMHgxNSwgMHgwMCwgLyogICBMT0dJQ0FMX01JTklN
VU0gKDApICAgICAgICAgICAgICAgICAgKi8KICAgIDB4MjUsIDB4NjUsIC8qICAgTE9HSUNBTF9N
QVhJTVVNICgxMDEpICAgICAgICAgICAgICAgICovCiAgICAweDA1LCAweDA3LCAvKiAgIFVTQUdF
X1BBR0UgKEtleWJvYXJkKSAgICAgICAgICAgICAgICAqLwogICAgMHgxOSwgMHgwMCwgLyogICBV
U0FHRV9NSU5JTVVNIChSZXNlcnZlZCkgICAgICAgICAgICAgKi8KICAgIDB4MjksIDB4NjUsIC8q
ICAgVVNBR0VfTUFYSU1VTSAoS2V5Ym9hcmQgQXBwbGljYXRpb24pICovCiAgICAweDgxLCAweDAw
LCAvKiAgIElOUFVUIChEYXRhLEFyeSxBYnMpICAgICAgICAgICAgICAgICAqLwogICAgMHhjMCAv
KiBFTkRfQ09MTEVDVElPTiAgICAgICAgICAgICAgICAgICAgICAgICAqLwp9OwoKc3RhdGljIHZv
aWQgc3l6X3VzYl9jb25maWdmc19oaWQoKQp7CglpbnQgZmRfZ2FkZ2V0LCByZXQ7CgoJc3RydWN0
IHN0YXQgc3Q7CglzdGF0KCIvc3lzL2tlcm5lbC9jb25maWcvdXNiX2dhZGdldC9nMSIsICZzdCk7
CglpZiAoU19JU0RJUihzdC5zdF9tb2RlKSkgewoJCXJldHVybjsKCX0KCglyZXQgPSBta2Rpcigi
L3N5cy9rZXJuZWwvY29uZmlnL3VzYl9nYWRnZXQvZzEiLCBPX1JEV1IpOwoJZmRfZ2FkZ2V0ID0g
b3BlbigiL3N5cy9rZXJuZWwvY29uZmlnL3VzYl9nYWRnZXQvZzEvaWRWZW5kb3IiLCBPX1JEV1Ip
OwoJcmV0ID0gd3JpdGUoZmRfZ2FkZ2V0LCAiMHg0MWUiLCA2KTsKCWNsb3NlKGZkX2dhZGdldCk7
CglmZF9nYWRnZXQgPSBvcGVuKCIvc3lzL2tlcm5lbC9jb25maWcvdXNiX2dhZGdldC9nMS9pZFBy
b2R1Y3QiLCBPX1JEV1IpOwoJcmV0ID0gd3JpdGUoZmRfZ2FkZ2V0LCAiMHgyODAxIiwgNyk7Cglj
bG9zZShmZF9nYWRnZXQpOwoKCXJldCA9IG1rZGlyKCIvc3lzL2tlcm5lbC9jb25maWcvdXNiX2dh
ZGdldC9nMS9jb25maWdzL2MuMSIsIE9fUkRXUik7CglyZXQgPSBta2RpcigiL3N5cy9rZXJuZWwv
Y29uZmlnL3VzYl9nYWRnZXQvZzEvZnVuY3Rpb25zL2hpZC51c2IwIiwgT19SRFdSKTsKCWZkX2dh
ZGdldCA9IG9wZW4oIi9zeXMva2VybmVsL2NvbmZpZy91c2JfZ2FkZ2V0L2cxL2Z1bmN0aW9ucy9o
aWQudXNiMC9zdWJjbGFzcyIsIE9fUkRXUik7CglyZXQgPSB3cml0ZShmZF9nYWRnZXQsICIxIiwg
Mik7CgljbG9zZShmZF9nYWRnZXQpOwoJZmRfZ2FkZ2V0ID0gb3BlbigiL3N5cy9rZXJuZWwvY29u
ZmlnL3VzYl9nYWRnZXQvZzEvZnVuY3Rpb25zL2hpZC51c2IwL3Byb3RvY29sIiwgT19SRFdSKTsK
CXJldCA9IHdyaXRlKGZkX2dhZGdldCwgIjEiLCAyKTsKCWNsb3NlKGZkX2dhZGdldCk7CglmZF9n
YWRnZXQgPSBvcGVuKCIvc3lzL2tlcm5lbC9jb25maWcvdXNiX2dhZGdldC9nMS9mdW5jdGlvbnMv
aGlkLnVzYjAvcmVwb3J0X2xlbmd0aCIsIE9fUkRXUik7CglyZXQgPSB3cml0ZShmZF9nYWRnZXQs
ICI4IiwgMik7CgljbG9zZShmZF9nYWRnZXQpOwoJZmRfZ2FkZ2V0ID0gb3BlbigiL3N5cy9rZXJu
ZWwvY29uZmlnL3VzYl9nYWRnZXQvZzEvZnVuY3Rpb25zL2hpZC51c2IwL3JlcG9ydF9kZXNjIiwg
T19SRFdSKTsKCXJldCA9IHdyaXRlKGZkX2dhZGdldCwgcmVwb3J0X2Rlc2MsIHNpemVvZihyZXBv
cnRfZGVzYykpOwoJY2xvc2UoZmRfZ2FkZ2V0KTsKCglmZF9nYWRnZXQgPSBvcGVuKCIvc3lzL2tl
cm5lbC9jb25maWcvdXNiX2dhZGdldC9nMS8iLCBPX1JET05MWSB8IE9fRElSRUNUT1JZKTsKCXJl
dCA9IHN5bWxpbmthdCgiL3N5cy9rZXJuZWwvY29uZmlnL3VzYl9nYWRnZXQvZzEvZnVuY3Rpb25z
L2hpZC51c2IwIiwgZmRfZ2FkZ2V0LCAiY29uZmlncy9jLjEvaGlkLnVzYjAiKTsKCWlmIChyZXQg
PCAwKQoJCXByaW50Zigic3l6X3VzYl9jb25maWdmc19oaWQgZmFpbCBzeW1saW5rLi4lZFxuIiwg
cmV0KTsKCWNsb3NlKGZkX2dhZGdldCk7CgoJZmRfZ2FkZ2V0ID0gb3BlbigiL3N5cy9rZXJuZWwv
Y29uZmlnL3VzYl9nYWRnZXQvZzEvVURDIiwgT19SRFdSKTsKCXJldCA9IHdyaXRlKGZkX2dhZGdl
dCwgImR1bW15X3VkYy4wIiwgMTIpOwoJY2xvc2UoZmRfZ2FkZ2V0KTsKfQp2b2lkIGV4ZWN1dGVf
Y2FsbChpbnQgY2FsbCkKewoJCWludHB0cl90IHJlczsJc3dpdGNoIChjYWxsKSB7CgljYXNlIDA6
CgkJc3l6X3VzYl9jb25maWdmc19oaWQoKTsKCQlicmVhazsKCWNhc2UgMToKCQlOT05GQUlMSU5H
KG1lbWNweSgodm9pZCopMHgyMDAwMjU4MCwgIi9kZXYvaGlkZzBcMDAwIiwgMTEpKTsKCQlyZXMg
PSBzeXNjYWxsKF9fTlJfb3BlbiwgMHgyMDAwMjU4MHVsLCAydWwsIDB4MTUwdWwpOwoJCWlmIChy
ZXMgIT0gLTEpCgkJCQlyWzBdID0gcmVzOwoJCWJyZWFrOwoJY2FzZSAyOgoJCU5PTkZBSUxJTkco
bWVtY3B5KCh2b2lkKikweDIwMDAyNWMwLCAiXHg0MFx4Y2FceDFhXHgxYVx4MmJceDYxXHg1Ylx4
OGJceDUxXHg1ZVx4MzVceDUzXHhjNlx4MDJceDZkXHgxOVx4MzRceDUwXHgxN1x4ZjNceGE0XHhk
Ylx4MzBceDA5XHgwNVx4YmJceDMwXHgwM1x4MWRceGRhXHg5NFx4NjhceDkyXHgxYVx4NjVceDM3
XHgxYVx4MjVceDI0XHg2Y1x4N2ZceGFkXHg1Ylx4YTRceDY3XHg0NVx4YzFceDg0XHgzNFx4ZjVc
eGEwXHg3Zlx4YWJceGRiXHgyNFx4YTJceDlmXHhkYlx4ZTBceGU1XHhhZlx4OGVceGIxXHhhZFx4
NmFceDI1XHg4Y1x4ZDFceDQ3XHg1YVx4MjhceDA3XHgxZFx4NzJceDJmXHhlMFx4MmRceDMwXHhj
ZFx4NGNceGY5XHgwMlx4YzJceDU2XHhmZFx4MjlceGFlXHhkOFx4MTdceGQyXHhhOFx4MzNceGYx
XHgxNlx4ZWNceGI5XHg5OFx4NjNceDQ0XHhhYlx4ZTdceDY1XHg1Y1x4MjlceDNkXHhjOFx4YmRc
eGI1XHhhNVx4YzFceDVmXHhhYVx4YjlceGU4XHg0ZVx4NjBceDYzXHhkZlx4N2FceDQ3XHhjNVx4
Y2UiLCAxMjIpKTsKCQlzeXNjYWxsKF9fTlJfd3JpdGUsIHJbMF0sIDB4MjAwMDI1YzB1bCwgMHg3
YXVsKTsKCQlicmVhazsKCX0KCn0KaW50IG1haW4odm9pZCkKewoJCXN5c2NhbGwoX19OUl9tbWFw
LCAweDIwMDAwMDAwdWwsIDB4MTAwMDAwMHVsLCAzdWwsIDB4MzJ1bCwgLTEsIDApOwoJc2V0dXBf
YmluZm10X21pc2MoKTsKCWluc3RhbGxfc2Vndl9oYW5kbGVyKCk7Cglmb3IgKHByb2NpZCA9IDA7
IHByb2NpZCA8IDg7IHByb2NpZCsrKSB7CgkJaWYgKGZvcmsoKSA9PSAwKSB7CgkJCXVzZV90ZW1w
b3JhcnlfZGlyKCk7CgkJCWRvX3NhbmRib3hfbm9uZSgpOwoJCX0KCX0KCXNsZWVwKDEwMDAwMDAp
OwoJcmV0dXJuIDA7Cn0K
--000000000000eed2f105a1c31f07--
