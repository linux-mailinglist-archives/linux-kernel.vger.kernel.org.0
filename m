Return-Path: <linux-kernel-owner@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 6007430528
	for <lists+linux-kernel@lfdr.de>; Fri, 31 May 2019 01:06:27 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1726738AbfE3XGP (ORCPT <rfc822;lists+linux-kernel@lfdr.de>);
        Thu, 30 May 2019 19:06:15 -0400
Received: from mail3-relais-sop.national.inria.fr ([192.134.164.104]:55926
        "EHLO mail3-relais-sop.national.inria.fr" rhost-flags-OK-OK-OK-OK)
        by vger.kernel.org with ESMTP id S1726100AbfE3XGP (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Thu, 30 May 2019 19:06:15 -0400
X-IronPort-AV: E=Sophos;i="5.60,532,1549926000"; 
   d="scan'208";a="307713717"
Received: from unknown (HELO hadrien) ([207.96.196.254])
  by mail3-relais-sop.national.inria.fr with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 31 May 2019 01:06:12 +0200
Date:   Thu, 30 May 2019 19:06:11 -0400 (EDT)
From:   Julia Lawall <julia.lawall@lip6.fr>
X-X-Sender: jll@hadrien
To:     Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
cc:     Liam Girdwood <lgirdwood@gmail.com>,
        Mark Brown <broonie@kernel.org>,
        Jaroslav Kysela <perex@perex.cz>,
        Takashi Iwai <tiwai@suse.com>, alsa-devel@alsa-project.org,
        linux-kernel@vger.kernel.org, kbuild-all@01.org
Subject: [PATCH] ASoC: soc-core: fix ifnullfree.cocci warnings
Message-ID: <alpine.DEB.2.21.1905301904530.2500@hadrien>
User-Agent: Alpine 2.21 (DEB 202 2017-01-01)
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

From: kbuild test robot <lkp@intel.com>

sound/soc/soc-core.c:391:2-7: WARNING: NULL check before some freeing functions is not needed.

 NULL check before some freeing functions is not needed.

 Based on checkpatch warning
 "kfree(NULL) is safe this check is probably not required"
 and kfreeaddr.cocci by Julia Lawall.

Generated by: scripts/coccinelle/free/ifnullfree.cocci

Fixes: 8e144273005d ("ASoC: soc-core: merge soc_new_pcm_runtime() and soc_rtd_init()")
Signed-off-by: kbuild test robot <lkp@intel.com>
Signed-off-by: Julia Lawall <julia.lawall@lip6.fr>
---

tree:   https://github.com/morimoto/linux fw-cleanup-2019-05-30-v3
head:   7f2c61a9097fcf25dac44865db31e7eab5c8fc9d
commit: 8e144273005d3caf8b9978e407e3d00b6180dd49 [96/103] ASoC: soc-core: merge soc_new_pcm_runtime() and soc_rtd_init()
:::::: branch date: 12 hours ago
:::::: commit date: 12 hours ago

Please take the patch only if it's a positive warning. Thanks!

 soc-core.c |    3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

--- a/sound/soc/soc-core.c
+++ b/sound/soc/soc-core.c
@@ -387,8 +387,7 @@ static void soc_free_pcm_runtime(struct

 	snd_soc_rtdcom_del_all(rtd);

-	if (rtd->codec_dais)
-		kfree(rtd->codec_dais);
+	kfree(rtd->codec_dais);

 	list_del(&rtd->list);
 	kfree(rtd);
