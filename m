Return-Path: <linux-kernel-owner@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 3D83ADBD6B
	for <lists+linux-kernel@lfdr.de>; Fri, 18 Oct 2019 08:01:16 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S2503897AbfJRGBH (ORCPT <rfc822;lists+linux-kernel@lfdr.de>);
        Fri, 18 Oct 2019 02:01:07 -0400
Received: from mx2.suse.de ([195.135.220.15]:39974 "EHLO mx1.suse.de"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S1731843AbfJRGBG (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
        Fri, 18 Oct 2019 02:01:06 -0400
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
        by mx1.suse.de (Postfix) with ESMTP id 0621AB557;
        Fri, 18 Oct 2019 06:01:04 +0000 (UTC)
Date:   Fri, 18 Oct 2019 08:01:00 +0200
Message-ID: <s5heezah9sz.wl-tiwai@suse.de>
From:   Takashi Iwai <tiwai@suse.de>
To:     Matt <jackdachef@gmail.com>
Cc:     Linux Kernel <linux-kernel@vger.kernel.org>
Subject: Re: possible audio regression for usb-audio with 5.3 kernel (5.3.1), sounds like variants of 8-bit audio
In-Reply-To: <CAG-aW04m8oRiOA5bEhWzEX6J9hSWXHSQJJTZaG0cp7Fgpwy7Aw@mail.gmail.com>
References: <CAG-aW04m8oRiOA5bEhWzEX6J9hSWXHSQJJTZaG0cp7Fgpwy7Aw@mail.gmail.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI/1.14.6 (Maruoka)
 FLIM/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL/10.8 Emacs/25.3
 (x86_64-suse-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=US-ASCII
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

On Wed, 02 Oct 2019 17:01:29 +0200,
Matt wrote:
> 
> Hi Takashi,
> 
> there appears to be a sound regression for plug-n-play usb-audio DACs
> with 5.3 kernel.
> 
> I'm using the following one:
> 
> https://www.aliexpress.com/item/33012416525.html?spm=a2g0s.9042311.0.0.4f314c4dv3EF0p
> 
> which includes SA9023A + ES9018K2M on the chip.
> 
> When listening to parts of the Unreal Tournament 3 soundtrack the
> output resembles a bit like:
> 
> https://www.youtube.com/watch?v=9gq4R6acnBQ Rush - Tom Sawyer (8-bit
> NES audio render)
> 
> it immediately made me think of 8-bit audio and the NES.
> 
> First thought of misconfiguration in the kernel config but then went
> back to 5.2.17-rt9 (copying the config and only enabling full
> preemption) and there the output is correct and crystal clear.
> 
> For each kernel build I need to jump through a few hoops (nvidia
> driver, zfsonlinux modules, luks, genkernel, etc.) so it'll take a
> while to build and get it up and running.

I don't know of a similar regression, and have currently no idea of
possible cause.  The git bisection would be the best option to spot
out the cause, I suppose.

For that, it'd be maybe helpful to reduce the reproducible condition,
e.g. try to boot with the stock Linus kernel without Nvidia graphics
and reduced configuration.  Basically you don't need the graphics
environment for reproducing the audio problem.  This will make the git
bisection much easier.


thanks,

Takashi

> 
> System is:
> cat /etc/lsb-release
> DISTRIB_ID="Gentoo"
> 
> ~amd64
> 
> gcc version 9.2.0 (Gentoo Hardened 9.2.0-r1 p2)
> GNU ld (Gentoo 2.32 p2) 2.32.0
> 
> PCIe related sound doesn't seem to be affected (Xonar DX), it works
> fine both on 5.3.1 and 5.2.17-rt9
> 
> Kind Regards
> 
> Matthew
> 
